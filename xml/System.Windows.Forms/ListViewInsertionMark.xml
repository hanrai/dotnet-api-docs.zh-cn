<Type Name="ListViewInsertionMark" FullName="System.Windows.Forms.ListViewInsertionMark">
  <Metadata><Meta Name="ms.openlocfilehash" Value="e26fefcc7ede098a1e817c93b81c2853f323fbd4" /><Meta Name="ms.sourcegitcommit" Value="055a4a82a0b08bfbdc21bd1347fb71f7fe2c099e" /><Meta Name="ms.translationtype" Value="MT" /><Meta Name="ms.contentlocale" Value="zh-CN" /><Meta Name="ms.lasthandoff" Value="08/15/2019" /><Meta Name="ms.locfileid" Value="69185834" /></Metadata><TypeSignature Language="C#" Value="public sealed class ListViewInsertionMark" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi sealed beforefieldinit ListViewInsertionMark extends System.Object" />
  <TypeSignature Language="DocId" Value="T:System.Windows.Forms.ListViewInsertionMark" />
  <TypeSignature Language="VB.NET" Value="Public NotInheritable Class ListViewInsertionMark" />
  <TypeSignature Language="C++ CLI" Value="public ref class ListViewInsertionMark sealed" />
  <TypeSignature Language="F#" Value="type ListViewInsertionMark = class" />
  <AssemblyInfo>
    <AssemblyName>System.Windows.Forms</AssemblyName>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Object</BaseTypeName>
  </Base>
  <Interfaces />
  <Docs>
    <summary><span data-ttu-id="a550f-101">在 <see cref="T:System.Windows.Forms.ListView" /> 控件中将某项拖动到新位置时，用于指示期望的拖放位置。</span><span class="sxs-lookup"><span data-stu-id="a550f-101">Used to indicate the expected drop location when an item is dragged to a new position in a <see cref="T:System.Windows.Forms.ListView" /> control.</span></span> <span data-ttu-id="a550f-102">此功能仅适用于 Windows XP 和更高版本。</span><span class="sxs-lookup"><span data-stu-id="a550f-102">This functionality is available only on Windows XP and later.</span></span></summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a550f-103">可以<xref:System.Windows.Forms.ListViewInsertionMark> <xref:System.Windows.Forms.ListView>从控件的属性中检索, 并在将项拖动到新位置时, 使用它直观地指示拖放操作中的预期放置位置。 <xref:System.Windows.Forms.ListView.InsertionMark%2A></span><span class="sxs-lookup"><span data-stu-id="a550f-103">You can retrieve a <xref:System.Windows.Forms.ListViewInsertionMark> from the <xref:System.Windows.Forms.ListView.InsertionMark%2A> property of a <xref:System.Windows.Forms.ListView> control and use it to visually indicate the expected drop location in a drag-and-drop operation when an item is dragged to a new position.</span></span>  
  
 <span data-ttu-id="a550f-104">此功能仅在以下情况<xref:System.Windows.Forms.ListView.AutoArrange%2A?displayProperty=nameWithType>下有效: 当`true`属性设置为<xref:System.Windows.Forms.ListView>时, 如果控件未自动对项进行排序, 则为。</span><span class="sxs-lookup"><span data-stu-id="a550f-104">This feature works only when the <xref:System.Windows.Forms.ListView.AutoArrange%2A?displayProperty=nameWithType> property is set to `true` and when the <xref:System.Windows.Forms.ListView> control does not sort the items automatically.</span></span> <span data-ttu-id="a550f-105">若要防止自动排序, <xref:System.Windows.Forms.ListView.Sorting%2A?displayProperty=nameWithType>属性必须设置为<xref:System.Windows.Forms.SortOrder.None?displayProperty=nameWithType> , 并且<xref:System.Windows.Forms.ListView.View%2A?displayProperty=nameWithType>属性必须设置为<xref:System.Windows.Forms.View.LargeIcon?displayProperty=nameWithType>、 <xref:System.Windows.Forms.View.SmallIcon?displayProperty=nameWithType>或<xref:System.Windows.Forms.View.Tile?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="a550f-105">To prevent automatic sorting, the <xref:System.Windows.Forms.ListView.Sorting%2A?displayProperty=nameWithType> property must be set to <xref:System.Windows.Forms.SortOrder.None?displayProperty=nameWithType> and the <xref:System.Windows.Forms.ListView.View%2A?displayProperty=nameWithType> property must be set to <xref:System.Windows.Forms.View.LargeIcon?displayProperty=nameWithType>, <xref:System.Windows.Forms.View.SmallIcon?displayProperty=nameWithType>, or <xref:System.Windows.Forms.View.Tile?displayProperty=nameWithType>.</span></span> <span data-ttu-id="a550f-106">此外, 插入标记功能不能用于<xref:System.Windows.Forms.ListView>分组功能, 因为分组功能按组成员按顺序对项进行排序。</span><span class="sxs-lookup"><span data-stu-id="a550f-106">Additionally, the insertion mark feature cannot be used with the <xref:System.Windows.Forms.ListView> grouping feature because the grouping feature orders the items by group membership.</span></span>  
  
 <span data-ttu-id="a550f-107">类通常用于<xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType> 或<xref:System.Windows.Forms.Control.MouseMove?displayProperty=nameWithType>事件的处理程序中, 用于在拖动项时更新插入标记的位置。 <xref:System.Windows.Forms.ListViewInsertionMark></span><span class="sxs-lookup"><span data-stu-id="a550f-107">The <xref:System.Windows.Forms.ListViewInsertionMark> class is typically used in a handler for the <xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType> or <xref:System.Windows.Forms.Control.MouseMove?displayProperty=nameWithType> event to update the position of the insertion mark as an item is dragged.</span></span> <span data-ttu-id="a550f-108">它还在<xref:System.Windows.Forms.Control.DragDrop?displayProperty=nameWithType>或<xref:System.Windows.Forms.Control.MouseUp?displayProperty=nameWithType>事件的处理程序中用于将拖动的项插入到正确的位置。</span><span class="sxs-lookup"><span data-stu-id="a550f-108">It is also used in a handler for the <xref:System.Windows.Forms.Control.DragDrop?displayProperty=nameWithType> or <xref:System.Windows.Forms.Control.MouseUp?displayProperty=nameWithType> event to insert a dragged item at the correct location.</span></span>  
  
 <span data-ttu-id="a550f-109">若要更新插入标记的位置, 请执行以下步骤:</span><span class="sxs-lookup"><span data-stu-id="a550f-109">To update the position of the insertion mark, follow these steps:</span></span>  
  
1.  <span data-ttu-id="a550f-110">在<xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType> <xref:System.Windows.Forms.ListViewInsertionMark>或<xref:System.Windows.Forms.Control.MouseMove?displayProperty=nameWithType>事件的处理程序中, 使用<xref:System.Windows.Forms.ListView.InsertionMark%2A?displayProperty=nameWithType>属性访问与该<xref:System.Windows.Forms.ListView>控件关联的对象。</span><span class="sxs-lookup"><span data-stu-id="a550f-110">In a handler for the <xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType> or <xref:System.Windows.Forms.Control.MouseMove?displayProperty=nameWithType> event, use the <xref:System.Windows.Forms.ListView.InsertionMark%2A?displayProperty=nameWithType> property to access the <xref:System.Windows.Forms.ListViewInsertionMark> object associated with the <xref:System.Windows.Forms.ListView> control.</span></span>  
  
2.  <span data-ttu-id="a550f-111"><xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A>使用方法检索离鼠标指针最近的项的索引。</span><span class="sxs-lookup"><span data-stu-id="a550f-111">Use the <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method to retrieve the index of the item closest to the mouse pointer.</span></span>  
  
3.  <span data-ttu-id="a550f-112">将索引值传递给<xref:System.Windows.Forms.ListView.GetItemRect%2A?displayProperty=nameWithType>方法以检索项的边框。</span><span class="sxs-lookup"><span data-stu-id="a550f-112">Pass the index value to the <xref:System.Windows.Forms.ListView.GetItemRect%2A?displayProperty=nameWithType> method to retrieve the bounding rectangle of the item.</span></span>  
  
4.  <span data-ttu-id="a550f-113">如果鼠标指针位于边界矩形中点的左侧, 则将<xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A>属性设置为`false`; 否则, 请将其设置为`true`。</span><span class="sxs-lookup"><span data-stu-id="a550f-113">If the mouse pointer is located to the left of the midpoint of the bounding rectangle, set the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property to `false`; otherwise, set it to `true`.</span></span>  
  
5.  <span data-ttu-id="a550f-114">将属性设置为从方法检索到的索引值。 <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A></span><span class="sxs-lookup"><span data-stu-id="a550f-114">Set the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> property to the index value retrieved from the <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method.</span></span> <span data-ttu-id="a550f-115">插入标记将显示在具有指定索引的项的旁边, 具体取决<xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A>于属性值。</span><span class="sxs-lookup"><span data-stu-id="a550f-115">The insertion mark appears next to item with the specified index, either to the left or the right, depending on the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property value.</span></span> <span data-ttu-id="a550f-116">如果将某个项拖动到其自身上, 则索引为-1, 并且插入标记处于隐藏状态。</span><span class="sxs-lookup"><span data-stu-id="a550f-116">If an item is dragged over itself, the index is -1 and the insertion mark is hidden.</span></span>  
  
 <span data-ttu-id="a550f-117">若要将拖动的项插入到正确的位置, 请执行以下步骤:</span><span class="sxs-lookup"><span data-stu-id="a550f-117">To insert the dragged item at the correct location, follow these steps:</span></span>  
  
1.  <span data-ttu-id="a550f-118">在<xref:System.Windows.Forms.Control.DragDrop?displayProperty=nameWithType> <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A>或<xref:System.Windows.Forms.Control.MouseUp?displayProperty=nameWithType>事件的处理程序中, 使用属性来确定插入标记的当前位置。</span><span class="sxs-lookup"><span data-stu-id="a550f-118">In a handler for the <xref:System.Windows.Forms.Control.DragDrop?displayProperty=nameWithType> or <xref:System.Windows.Forms.Control.MouseUp?displayProperty=nameWithType> event, use the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> property to determine the current location of the insertion mark.</span></span> <span data-ttu-id="a550f-119">存储此值, 以备稍后用作插入索引。</span><span class="sxs-lookup"><span data-stu-id="a550f-119">Store this value to be used later as the insertion index.</span></span>  
  
2.  <span data-ttu-id="a550f-120">`true`如果将<xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A>属性设置为, 则递增存储的插入索引值。</span><span class="sxs-lookup"><span data-stu-id="a550f-120">If the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property is set to `true`, increment the stored insertion index value.</span></span>  
  
3.  <span data-ttu-id="a550f-121">使用方法将拖动的项的克隆插入<xref:System.Windows.Forms.ListView.Items%2A?displayProperty=nameWithType>到集合中存储的插入索引处。 <xref:System.Windows.Forms.ListView.ListViewItemCollection.Insert%2A?displayProperty=nameWithType></span><span class="sxs-lookup"><span data-stu-id="a550f-121">Use the <xref:System.Windows.Forms.ListView.ListViewItemCollection.Insert%2A?displayProperty=nameWithType> method to insert a clone of the dragged item into the <xref:System.Windows.Forms.ListView.Items%2A?displayProperty=nameWithType> collection at the stored insertion index.</span></span>  
  
4.  <span data-ttu-id="a550f-122"><xref:System.Windows.Forms.ListView.ListViewItemCollection.Remove%2A?displayProperty=nameWithType>使用方法可删除拖动项的原始副本。</span><span class="sxs-lookup"><span data-stu-id="a550f-122">Use the <xref:System.Windows.Forms.ListView.ListViewItemCollection.Remove%2A?displayProperty=nameWithType> method to remove the original copy of the dragged item.</span></span>  
  
 <span data-ttu-id="a550f-123">在删除原始副本之前, 必须先插入拖动项的复本, 以便在插入之前不更改<xref:System.Windows.Forms.ListView.Items%2A?displayProperty=nameWithType>集合中的索引值。</span><span class="sxs-lookup"><span data-stu-id="a550f-123">You must insert a clone of the dragged item before the original copy is removed so the index values in the <xref:System.Windows.Forms.ListView.Items%2A?displayProperty=nameWithType> collection are not altered before the insertion.</span></span>  
  
 <span data-ttu-id="a550f-124">若要确保项的显示顺序与其索引值相同, 必须将<xref:System.Windows.Forms.ListView.ListViewItemSorter%2A?displayProperty=nameWithType>属性设置为按索引值对项进行排序的<xref:System.Collections.IComparer>接口的实现。</span><span class="sxs-lookup"><span data-stu-id="a550f-124">To ensure that the items are displayed in the same order as their index values, you must set the <xref:System.Windows.Forms.ListView.ListViewItemSorter%2A?displayProperty=nameWithType> property to an implementation of the <xref:System.Collections.IComparer> interface that sorts items by index value.</span></span> <span data-ttu-id="a550f-125">有关详细信息, 请参阅 "示例" 部分。</span><span class="sxs-lookup"><span data-stu-id="a550f-125">For more information, see the Example section.</span></span>  
  
 <span data-ttu-id="a550f-126">您可以使用<xref:System.Windows.Forms.ListViewInsertionMark.Color%2A>属性修改插入标记的颜色。</span><span class="sxs-lookup"><span data-stu-id="a550f-126">You can modify the color of the insertion mark by using the <xref:System.Windows.Forms.ListViewInsertionMark.Color%2A> property.</span></span> <span data-ttu-id="a550f-127">如果需要插入标记的大小或位置, 可以通过<xref:System.Windows.Forms.ListViewInsertionMark.Bounds%2A>属性获取其边框。</span><span class="sxs-lookup"><span data-stu-id="a550f-127">If you need the size or position of the insertion mark, you can get its bounding rectangle through the <xref:System.Windows.Forms.ListViewInsertionMark.Bounds%2A> property.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="a550f-128">当应用程序调用<xref:System.Windows.Forms.Application.EnableVisualStyles%2A?displayProperty=nameWithType>方法时, 插入标记功能仅在 windows XP 和 windows Server 2003 家族上可用。</span><span class="sxs-lookup"><span data-stu-id="a550f-128">The insertion mark feature is available only on Windows XP and the Windows Server 2003 family when your application calls the <xref:System.Windows.Forms.Application.EnableVisualStyles%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="a550f-129">在早期的操作系统上, 将忽略与插入标记相关的任何代码, 并且不会显示插入标记。</span><span class="sxs-lookup"><span data-stu-id="a550f-129">On earlier operating systems, any code relating to the insertion mark will be ignored and the insertion mark will not appear.</span></span> <span data-ttu-id="a550f-130">因此, 依赖于插入标记功能的任何代码可能无法正常工作。</span><span class="sxs-lookup"><span data-stu-id="a550f-130">As a result, any code that depends on the insertion mark feature may not work correctly.</span></span> <span data-ttu-id="a550f-131">你可能想要包含一个测试来确定插入标记功能是否可用, 并在其不可用时提供其他功能。</span><span class="sxs-lookup"><span data-stu-id="a550f-131">You may want to include a test that determines whether the insertion mark feature is available, and provide alternate functionality when it is unavailable.</span></span> <span data-ttu-id="a550f-132">例如, 你可能想要在不支持插入标记的操作系统上运行时, 绕过实现拖放项重定位的所有代码。</span><span class="sxs-lookup"><span data-stu-id="a550f-132">For example, you may want to bypass all code that implements drag-and-drop item repositioning when running on operating systems that do not support insertion marks.</span></span>  
>   
>  <span data-ttu-id="a550f-133">插入标记功能由提供操作系统主题功能的相同库提供。</span><span class="sxs-lookup"><span data-stu-id="a550f-133">The insertion mark feature is provided by the same library that provides the operating system themes feature.</span></span> <span data-ttu-id="a550f-134">若要检查此库的可用性, 请调用<xref:System.Windows.Forms.FeatureSupport.IsPresent%28System.Object%29?displayProperty=nameWithType>方法重载, 并传入<xref:System.Windows.Forms.OSFeature.Themes?displayProperty=nameWithType>值。</span><span class="sxs-lookup"><span data-stu-id="a550f-134">To check for the availability of this library, call the <xref:System.Windows.Forms.FeatureSupport.IsPresent%28System.Object%29?displayProperty=nameWithType> method overload and pass in the <xref:System.Windows.Forms.OSFeature.Themes?displayProperty=nameWithType> value.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a550f-135">下面的代码示例演示如何使用<xref:System.Windows.Forms.ListView>插入标记功能并实现使用标准拖动事件的拖放项重新排序。</span><span class="sxs-lookup"><span data-stu-id="a550f-135">The following code example demonstrates how to use the <xref:System.Windows.Forms.ListView> insertion mark feature and implements drag-and-drop item reordering using the standard drag events.</span></span> <span data-ttu-id="a550f-136">在<xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType>事件的处理程序中更新插入标记的位置。</span><span class="sxs-lookup"><span data-stu-id="a550f-136">The position of the insertion mark is updated in a handler for the <xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType> event.</span></span> <span data-ttu-id="a550f-137">在此处理程序中, 将鼠标指针的位置与最近项的中点进行比较, 并使用结果来确定插入标记是显示在项的左侧还是右侧。</span><span class="sxs-lookup"><span data-stu-id="a550f-137">In this handler, the position of the mouse pointer is compared to the midpoint of the nearest item, and the result is used to determine whether the insertion mark appears to the left or the right of the item.</span></span>  
  
 [!code-cpp[System.Windows.Forms.ListView.InsertionMark#1](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CPP/listviewinsertionmarkexample.cpp#1)]
 [!code-csharp[System.Windows.Forms.ListView.InsertionMark#1](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CS/listviewinsertionmarkexample.cs#1)]
 [!code-vb[System.Windows.Forms.ListView.InsertionMark#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/VB/listviewinsertionmarkexample.vb#1)]  
  
 ]]></format>
    </remarks>
    <altmember cref="T:System.Windows.Forms.ListView" />
  </Docs>
  <Members>
    <Member MemberName="AppearsAfterItem">
      <MemberSignature Language="C#" Value="public bool AppearsAfterItem { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool AppearsAfterItem" />
      <MemberSignature Language="DocId" Value="P:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem" />
      <MemberSignature Language="VB.NET" Value="Public Property AppearsAfterItem As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool AppearsAfterItem { bool get(); void set(bool value); };" />
      <MemberSignature Language="F#" Value="member this.AppearsAfterItem : bool with get, set" Usage="System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>get: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="a550f-138">获取或设置一个值，该值指示是否在项的右侧显示插入标记，该项带有 <see cref="P:System.Windows.Forms.ListViewInsertionMark.Index" /> 属性指定的索引。</span><span class="sxs-lookup"><span data-stu-id="a550f-138">Gets or sets a value indicating whether the insertion mark appears to the right of the item with the index specified by the <see cref="P:System.Windows.Forms.ListViewInsertionMark.Index" /> property.</span></span></summary>
        <value><span data-ttu-id="a550f-139">如果在带有索引（由 <see cref="P:System.Windows.Forms.ListViewInsertionMark.Index" /> 属性指定）的项的右侧显示插入标记，则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="a550f-139"><see langword="true" /> if the insertion mark appears to the right of the item with the index specified by the <see cref="P:System.Windows.Forms.ListViewInsertionMark.Index" /> property; otherwise, <see langword="false" />.</span></span> <span data-ttu-id="a550f-140">默认值为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="a550f-140">The default is <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a550f-141"><xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A>方法可让你查找离鼠标指针最近的项, 但你必须进行自己的计算, 以确定插入标记应该出现在此项之前还是之后。</span><span class="sxs-lookup"><span data-stu-id="a550f-141">The <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method lets you find the item closest to the mouse pointer, but you must do your own calculations to determine whether the insertion mark should appear before or after this item.</span></span>  
  
 <span data-ttu-id="a550f-142">若要计算<xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A>属性所需的值, 请执行以下步骤:</span><span class="sxs-lookup"><span data-stu-id="a550f-142">To calculate the value needed for the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property, follow these steps:</span></span>  
  
1.  <span data-ttu-id="a550f-143"><xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A>使用方法检索离鼠标指针最近的项的索引。</span><span class="sxs-lookup"><span data-stu-id="a550f-143">Use the <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method to retrieve the index of the item closest to the mouse pointer.</span></span>  
  
2.  <span data-ttu-id="a550f-144">将索引值传递给<xref:System.Windows.Forms.ListView.GetItemRect%2A?displayProperty=nameWithType>方法以检索项的边框。</span><span class="sxs-lookup"><span data-stu-id="a550f-144">Pass the index value to the <xref:System.Windows.Forms.ListView.GetItemRect%2A?displayProperty=nameWithType> method to retrieve the bounding rectangle of the item.</span></span>  
  
3.  <span data-ttu-id="a550f-145">如果鼠标指针位于边界矩形中点的左侧, 则将<xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A>属性设置为`false`; 否则, 请将其设置为`true`。</span><span class="sxs-lookup"><span data-stu-id="a550f-145">If the mouse pointer is located to the left of the midpoint of the bounding rectangle, set the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property to `false`; otherwise, set it to `true`.</span></span>  
  
 <span data-ttu-id="a550f-146">有关详细信息, 请参阅<xref:System.Windows.Forms.ListViewInsertionMark>概述参考主题。</span><span class="sxs-lookup"><span data-stu-id="a550f-146">For more information, see the <xref:System.Windows.Forms.ListViewInsertionMark> overview reference topic.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a550f-147">下面的代码示例演示如何使用<xref:System.Windows.Forms.ListView>插入标记功能并实现使用标准拖动事件的拖放项重新排序。</span><span class="sxs-lookup"><span data-stu-id="a550f-147">The following code example demonstrates how to use the <xref:System.Windows.Forms.ListView> insertion mark feature and implements drag-and-drop item reordering using the standard drag events.</span></span> <span data-ttu-id="a550f-148">在<xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType>事件的处理程序中更新插入标记的位置。</span><span class="sxs-lookup"><span data-stu-id="a550f-148">The position of the insertion mark is updated in a handler for the <xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType> event.</span></span> <span data-ttu-id="a550f-149">在此处理程序中, 将鼠标指针的位置与最近项的中点进行比较, 并使用结果来确定插入标记是显示在项的左侧还是右侧。</span><span class="sxs-lookup"><span data-stu-id="a550f-149">In this handler, the position of the mouse pointer is compared to the midpoint of the nearest item, and the result is used to determine whether the insertion mark appears to the left or the right of the item.</span></span>  
  
 <span data-ttu-id="a550f-150">有关完整示例, 请参阅<xref:System.Windows.Forms.ListViewInsertionMark>概述参考主题。</span><span class="sxs-lookup"><span data-stu-id="a550f-150">For the complete example, see the <xref:System.Windows.Forms.ListViewInsertionMark> overview reference topic.</span></span>  
  
 [!code-cpp[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CPP/listviewinsertionmarkexample.cpp#3)]
 [!code-csharp[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CS/listviewinsertionmarkexample.cs#3)]
 [!code-vb[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/VB/listviewinsertionmarkexample.vb#3)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Windows.Forms.ListView" />
      </Docs>
    </Member>
    <Member MemberName="Bounds">
      <MemberSignature Language="C#" Value="public System.Drawing.Rectangle Bounds { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Drawing.Rectangle Bounds" />
      <MemberSignature Language="DocId" Value="P:System.Windows.Forms.ListViewInsertionMark.Bounds" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property Bounds As Rectangle" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Drawing::Rectangle Bounds { System::Drawing::Rectangle get(); };" />
      <MemberSignature Language="F#" Value="member this.Bounds : System.Drawing.Rectangle" Usage="System.Windows.Forms.ListViewInsertionMark.Bounds" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Drawing.Rectangle</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="a550f-151">获取插入标记的边框。</span><span class="sxs-lookup"><span data-stu-id="a550f-151">Gets the bounding rectangle of the insertion mark.</span></span></summary>
        <value><span data-ttu-id="a550f-152"><see cref="T:System.Drawing.Rectangle" /> 用于表示插入标记的位置和大小。</span><span class="sxs-lookup"><span data-stu-id="a550f-152">A <see cref="T:System.Drawing.Rectangle" /> that represents the position and size of the insertion mark.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a550f-153">插入标记边界矩形中的坐标相对于<xref:System.Windows.Forms.ListView>控件的左上角。</span><span class="sxs-lookup"><span data-stu-id="a550f-153">The coordinates in the insertion mark bounding rectangle are relative to the upper-left corner of the <xref:System.Windows.Forms.ListView> control.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Windows.Forms.ListView" />
      </Docs>
    </Member>
    <Member MemberName="Color">
      <MemberSignature Language="C#" Value="public System.Drawing.Color Color { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Drawing.Color Color" />
      <MemberSignature Language="DocId" Value="P:System.Windows.Forms.ListViewInsertionMark.Color" />
      <MemberSignature Language="VB.NET" Value="Public Property Color As Color" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Drawing::Color Color { System::Drawing::Color get(); void set(System::Drawing::Color value); };" />
      <MemberSignature Language="F#" Value="member this.Color : System.Drawing.Color with get, set" Usage="System.Windows.Forms.ListViewInsertionMark.Color" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Drawing.Color</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="a550f-154">获取或设置此插入标记的颜色。</span><span class="sxs-lookup"><span data-stu-id="a550f-154">Gets or sets the color of the insertion mark.</span></span></summary>
        <value><span data-ttu-id="a550f-155">一个 <see cref="T:System.Drawing.Color" /> 值，表示插入标记的颜色。</span><span class="sxs-lookup"><span data-stu-id="a550f-155">A <see cref="T:System.Drawing.Color" /> value that represents the color of the insertion mark.</span></span> <span data-ttu-id="a550f-156">默认值为 <see cref="P:System.Windows.Forms.ListView.ForeColor" /> 属性的值。</span><span class="sxs-lookup"><span data-stu-id="a550f-156">The default value is the value of the <see cref="P:System.Windows.Forms.ListView.ForeColor" /> property.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a550f-157">使用此属性将插入标记颜色设置为<xref:System.Windows.Forms.ListView>控件的前景色以外的值。</span><span class="sxs-lookup"><span data-stu-id="a550f-157">Use this property to set the insertion mark color to a value other than the foreground color of the <xref:System.Windows.Forms.ListView> control.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a550f-158">下面的代码示例演示如何使用<xref:System.Windows.Forms.ListView>插入标记功能并实现使用标准拖动事件的拖放项重新排序。</span><span class="sxs-lookup"><span data-stu-id="a550f-158">The following code example demonstrates how to use the <xref:System.Windows.Forms.ListView> insertion mark feature and implements drag-and-drop item reordering using the standard drag events.</span></span> <span data-ttu-id="a550f-159">在<xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType>事件的处理程序中更新插入标记的位置。</span><span class="sxs-lookup"><span data-stu-id="a550f-159">The position of the insertion mark is updated in a handler for the <xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType> event.</span></span> <span data-ttu-id="a550f-160">在此处理程序中, 将鼠标指针的位置与最近项的中点进行比较, 并使用结果来确定插入标记是显示在项的左侧还是右侧。</span><span class="sxs-lookup"><span data-stu-id="a550f-160">In this handler, the position of the mouse pointer is compared to the midpoint of the nearest item, and the result is used to determine whether the insertion mark appears to the left or the right of the item.</span></span>  
  
 <span data-ttu-id="a550f-161">有关完整示例, 请参阅<xref:System.Windows.Forms.ListViewInsertionMark>概述参考主题。</span><span class="sxs-lookup"><span data-stu-id="a550f-161">For the complete example, see the <xref:System.Windows.Forms.ListViewInsertionMark> overview reference topic.</span></span>  
  
 [!code-cpp[System.Windows.Forms.ListView.InsertionMark#2](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CPP/listviewinsertionmarkexample.cpp#2)]
 [!code-csharp[System.Windows.Forms.ListView.InsertionMark#2](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CS/listviewinsertionmarkexample.cs#2)]
 [!code-vb[System.Windows.Forms.ListView.InsertionMark#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/VB/listviewinsertionmarkexample.vb#2)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Windows.Forms.ListView" />
      </Docs>
    </Member>
    <Member MemberName="Index">
      <MemberSignature Language="C#" Value="public int Index { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 Index" />
      <MemberSignature Language="DocId" Value="P:System.Windows.Forms.ListViewInsertionMark.Index" />
      <MemberSignature Language="VB.NET" Value="Public Property Index As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property int Index { int get(); void set(int value); };" />
      <MemberSignature Language="F#" Value="member this.Index : int with get, set" Usage="System.Windows.Forms.ListViewInsertionMark.Index" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>get: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="a550f-162">获取或设置与插入标记旁边的项的索引。</span><span class="sxs-lookup"><span data-stu-id="a550f-162">Gets or sets the index of the item next to which the insertion mark appears.</span></span></summary>
        <value><span data-ttu-id="a550f-163">插入标记旁边的项的索引；如果隐藏插入标记，则为 -1。</span><span class="sxs-lookup"><span data-stu-id="a550f-163">The index of the item next to which the insertion mark appears or -1 when the insertion mark is hidden.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a550f-164">如果<xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A>将属性设置为`false`, 则插入标记出现在具有指定索引的项的左侧; 否则, 它将显示在项的右侧。</span><span class="sxs-lookup"><span data-stu-id="a550f-164">The insertion mark appears to the left of the item with the specified index if the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property is set to `false`; otherwise, it appears to the right of the item.</span></span> <span data-ttu-id="a550f-165">将拖动的项插入到<xref:System.Windows.Forms.ListView.Items%2A?displayProperty=nameWithType>集合中时, 插入标记会自动消失。</span><span class="sxs-lookup"><span data-stu-id="a550f-165">The insertion mark disappears automatically when a dragged item is inserted into the <xref:System.Windows.Forms.ListView.Items%2A?displayProperty=nameWithType> collection.</span></span> <span data-ttu-id="a550f-166">若要手动删除插入标记, 例如, 将某个项拖动到其自身或拖放到控件外时, 请<xref:System.Windows.Forms.ListViewInsertionMark.Index%2A>将值设置为-1。</span><span class="sxs-lookup"><span data-stu-id="a550f-166">To remove the insertion mark manually, for example, when an item is dragged onto itself or dragged outside the control, set the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> value to -1.</span></span>  
  
 <span data-ttu-id="a550f-167"><xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A>使用方法检索离指定位置最近的项的索引, 如在拖放操作中定位项时鼠标指针的位置。</span><span class="sxs-lookup"><span data-stu-id="a550f-167">Use the <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method to retrieve the index of the item closest to a specified location, such as the location of the mouse pointer when positioning an item in a drag-and-drop operation.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a550f-168">下面的代码示例演示如何使用<xref:System.Windows.Forms.ListView>插入标记功能并实现使用标准拖动事件的拖放项重新排序。</span><span class="sxs-lookup"><span data-stu-id="a550f-168">The following code example demonstrates how to use the <xref:System.Windows.Forms.ListView> insertion mark feature and implements drag-and-drop item reordering using the standard drag events.</span></span> <span data-ttu-id="a550f-169">在<xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType>事件的处理程序中更新插入标记的位置。</span><span class="sxs-lookup"><span data-stu-id="a550f-169">The position of the insertion mark is updated in a handler for the <xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType> event.</span></span> <span data-ttu-id="a550f-170">在此处理程序中, 将鼠标指针的位置与最近项的中点进行比较, 并使用结果来确定插入标记是显示在项的左侧还是右侧。</span><span class="sxs-lookup"><span data-stu-id="a550f-170">In this handler, the position of the mouse pointer is compared to the midpoint of the nearest item, and the result is used to determine whether the insertion mark appears to the left or the right of the item.</span></span>  
  
 <span data-ttu-id="a550f-171">有关完整示例, 请参阅<xref:System.Windows.Forms.ListViewInsertionMark>概述参考主题。</span><span class="sxs-lookup"><span data-stu-id="a550f-171">For the complete example, see the <xref:System.Windows.Forms.ListViewInsertionMark> overview reference topic.</span></span>  
  
 [!code-cpp[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CPP/listviewinsertionmarkexample.cpp#3)]
 [!code-csharp[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CS/listviewinsertionmarkexample.cs#3)]
 [!code-vb[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/VB/listviewinsertionmarkexample.vb#3)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Windows.Forms.ListView" />
      </Docs>
    </Member>
    <Member MemberName="NearestIndex">
      <MemberSignature Language="C#" Value="public int NearestIndex (System.Drawing.Point pt);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance int32 NearestIndex(valuetype System.Drawing.Point pt) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.ListViewInsertionMark.NearestIndex(System.Drawing.Point)" />
      <MemberSignature Language="VB.NET" Value="Public Function NearestIndex (pt As Point) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; int NearestIndex(System::Drawing::Point pt);" />
      <MemberSignature Language="F#" Value="member this.NearestIndex : System.Drawing.Point -&gt; int" Usage="listViewInsertionMark.NearestIndex pt" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="pt" Type="System.Drawing.Point" />
      </Parameters>
      <Docs>
        <param name="pt"><span data-ttu-id="a550f-172">从 <see cref="T:System.Drawing.Point" /> 表示的位置找到最近的项。</span><span class="sxs-lookup"><span data-stu-id="a550f-172">A <see cref="T:System.Drawing.Point" /> representing the location from which to find the nearest item.</span></span></param>
        <summary><span data-ttu-id="a550f-173">检索距离指定点最近的项的索引。</span><span class="sxs-lookup"><span data-stu-id="a550f-173">Retrieves the index of the item closest to the specified point.</span></span></summary>
        <returns><span data-ttu-id="a550f-174">距离指定点最近的项的索引；如果最近的项就是当前被拖动的项，则为 -1。</span><span class="sxs-lookup"><span data-stu-id="a550f-174">The index of the item closest to the specified point or -1 if the closest item is the item currently being dragged.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="a550f-175">此方法允许您在执行拖放操作时查找离鼠标指针最近的项。</span><span class="sxs-lookup"><span data-stu-id="a550f-175">This method lets you locate the item closest to the mouse pointer when doing a drag-and-drop operation.</span></span> <span data-ttu-id="a550f-176">使用返回的索引值设置<xref:System.Windows.Forms.ListViewInsertionMark.Index%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="a550f-176">Use the index value returned to set the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> property.</span></span> <span data-ttu-id="a550f-177">当最接近鼠标指针的项是要拖动的项时, 此方法的返回值为-1。</span><span class="sxs-lookup"><span data-stu-id="a550f-177">When the item closest to the mouse pointer is the item being dragged, the return value of this method is -1.</span></span> <span data-ttu-id="a550f-178">在这种情况下, <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A>将属性设置为该值将隐藏插入标记。</span><span class="sxs-lookup"><span data-stu-id="a550f-178">In this case, setting the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> property to this value hides the insertion mark.</span></span>  
  
 <span data-ttu-id="a550f-179">此方法查找最接近的项, 而不考虑鼠标指针的位置, 而<xref:System.Windows.Forms.ListView.GetItemAt%2A?displayProperty=nameWithType>方法只返回指定位置的项, 或者`null`如果该位置没有项, 则为。</span><span class="sxs-lookup"><span data-stu-id="a550f-179">This method finds the closest item regardless of where the mouse pointer is located, while the <xref:System.Windows.Forms.ListView.GetItemAt%2A?displayProperty=nameWithType> method returns the item at the specified location only, or `null` if there is no item at that location.</span></span> <span data-ttu-id="a550f-180">例如<xref:System.Windows.Forms.ListView.GetItemAt%2A?displayProperty=nameWithType> , 当`null`鼠标指针位于两个项之间时, 此方法将返回。</span><span class="sxs-lookup"><span data-stu-id="a550f-180">The <xref:System.Windows.Forms.ListView.GetItemAt%2A?displayProperty=nameWithType> method returns `null`, for example, when the mouse pointer is located between two items.</span></span> <span data-ttu-id="a550f-181">出于此原因, 在使用拖放操作<xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A>来定位项时, 应始终使用方法。</span><span class="sxs-lookup"><span data-stu-id="a550f-181">For this reason, you should always use the <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method when using a drag-and-drop operation to position items.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="a550f-182">下面的代码示例演示如何使用<xref:System.Windows.Forms.ListView>插入标记功能并实现使用标准拖动事件的拖放项重新排序。</span><span class="sxs-lookup"><span data-stu-id="a550f-182">The following code example demonstrates how to use the <xref:System.Windows.Forms.ListView> insertion mark feature and implements drag-and-drop item reordering using the standard drag events.</span></span> <span data-ttu-id="a550f-183">在<xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType>事件的处理程序中更新插入标记的位置。</span><span class="sxs-lookup"><span data-stu-id="a550f-183">The position of the insertion mark is updated in a handler for the <xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType> event.</span></span> <span data-ttu-id="a550f-184">在此处理程序中, 将鼠标指针的位置与最近项的中点进行比较, 并使用结果来确定插入标记是显示在项的左侧还是右侧。</span><span class="sxs-lookup"><span data-stu-id="a550f-184">In this handler, the position of the mouse pointer is compared to the midpoint of the nearest item, and the result is used to determine whether the insertion mark appears to the left or the right of the item.</span></span>  
  
 <span data-ttu-id="a550f-185">有关完整示例, 请参阅<xref:System.Windows.Forms.ListViewInsertionMark>概述参考主题。</span><span class="sxs-lookup"><span data-stu-id="a550f-185">For the complete example, see the <xref:System.Windows.Forms.ListViewInsertionMark> overview reference topic.</span></span>  
  
 [!code-cpp[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CPP/listviewinsertionmarkexample.cpp#3)]
 [!code-csharp[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CS/listviewinsertionmarkexample.cs#3)]
 [!code-vb[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/VB/listviewinsertionmarkexample.vb#3)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Windows.Forms.ListView" />
      </Docs>
    </Member>
  </Members>
</Type>
