<Type Name="DataObject" FullName="System.Windows.Forms.DataObject">
  <Metadata><Meta Name="ms.openlocfilehash" Value="fbeb22bd9356e133dcbbce574cca958c4f38c6f1" /><Meta Name="ms.sourcegitcommit" Value="2767b5903996fbd7e2b81eda1114dfc9d0d9db63" /><Meta Name="ms.translationtype" Value="MT" /><Meta Name="ms.contentlocale" Value="zh-CN" /><Meta Name="ms.lasthandoff" Value="05/02/2019" /><Meta Name="ms.locfileid" Value="65015818" /></Metadata><TypeSignature Language="C#" Value="public class DataObject : System.Runtime.InteropServices.ComTypes.IDataObject, System.Windows.Forms.IDataObject" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi beforefieldinit DataObject extends System.Object implements class System.Runtime.InteropServices.ComTypes.IDataObject, class System.Windows.Forms.IDataObject" />
  <TypeSignature Language="DocId" Value="T:System.Windows.Forms.DataObject" />
  <TypeSignature Language="VB.NET" Value="Public Class DataObject&#xA;Implements IDataObject, IDataObject" />
  <TypeSignature Language="C++ CLI" Value="public ref class DataObject : System::Runtime::InteropServices::ComTypes::IDataObject, System::Windows::Forms::IDataObject" />
  <TypeSignature Language="F#" Value="type DataObject = class&#xA;    interface IDataObject&#xA;    interface IDataObject" />
  <AssemblyInfo>
    <AssemblyName>System.Windows.Forms</AssemblyName>
    <AssemblyVersion>1.0.5000.0</AssemblyVersion>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Object</BaseTypeName>
  </Base>
  <Interfaces>
    <Interface>
      <InterfaceName>System.Runtime.InteropServices.ComTypes.IDataObject</InterfaceName>
    </Interface>
    <Interface>
      <InterfaceName>System.Windows.Forms.IDataObject</InterfaceName>
    </Interface>
  </Interfaces>
  <Attributes>
    <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;netcore-3.0">
      <AttributeName>System.Runtime.InteropServices.ClassInterface(System.Runtime.InteropServices.ClassInterfaceType.None)</AttributeName>
    </Attribute>
  </Attributes>
  <Docs>
    <summary><span data-ttu-id="9dccb-101">实现基数据传输机制。</span><span class="sxs-lookup"><span data-stu-id="9dccb-101">Implements a basic data transfer mechanism.</span></span></summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9dccb-102"><xref:System.Windows.Forms.DataObject>实现接口<xref:System.Windows.Forms.IDataObject> , 该接口的方法为数据传输提供与格式无关的机制。</span><span class="sxs-lookup"><span data-stu-id="9dccb-102"><xref:System.Windows.Forms.DataObject> implements the <xref:System.Windows.Forms.IDataObject> interface, whose methods provide a format-independent mechanism for data transfer.</span></span>  
  
 <span data-ttu-id="9dccb-103">通常与拖放操作中<xref:System.Windows.Forms.Clipboard>的和一起使用。 <xref:System.Windows.Forms.DataObject></span><span class="sxs-lookup"><span data-stu-id="9dccb-103">A <xref:System.Windows.Forms.DataObject> is typically used with the <xref:System.Windows.Forms.Clipboard> and in drag-and-drop operations.</span></span> <span data-ttu-id="9dccb-104">类提供<xref:System.Windows.Forms.IDataObject>接口的建议实现。 <xref:System.Windows.Forms.DataObject></span><span class="sxs-lookup"><span data-stu-id="9dccb-104">The <xref:System.Windows.Forms.DataObject> class provides the recommended implementation of the <xref:System.Windows.Forms.IDataObject> interface.</span></span> <span data-ttu-id="9dccb-105">建议使用<xref:System.Windows.Forms.DataObject>类, 而不是自行实现<xref:System.Windows.Forms.IDataObject> 。</span><span class="sxs-lookup"><span data-stu-id="9dccb-105">It is suggested that you use the <xref:System.Windows.Forms.DataObject> class rather than implementing <xref:System.Windows.Forms.IDataObject> yourself.</span></span>  
  
 <span data-ttu-id="9dccb-106">不同格式的多个数据片段可以存储在中<xref:System.Windows.Forms.DataObject>。</span><span class="sxs-lookup"><span data-stu-id="9dccb-106">Multiple pieces of data in different formats can be stored in a <xref:System.Windows.Forms.DataObject>.</span></span> <span data-ttu-id="9dccb-107">数据<xref:System.Windows.Forms.DataObject>按其关联格式从中检索。</span><span class="sxs-lookup"><span data-stu-id="9dccb-107">Data is retrieved from a <xref:System.Windows.Forms.DataObject> by its associated format.</span></span> <span data-ttu-id="9dccb-108">由于目标应用程序可能未知, 因此, 您可以通过将<xref:System.Windows.Forms.DataObject>数据置于多个格式中, 增加应用程序的相应格式的数据的可能性。</span><span class="sxs-lookup"><span data-stu-id="9dccb-108">Because the target application might not be known, you can increase the likelihood that the data will be in the appropriate format for an application by placing the data in a <xref:System.Windows.Forms.DataObject> in multiple formats.</span></span> <span data-ttu-id="9dccb-109">有关<xref:System.Windows.Forms.DataFormats>预定义格式, 请参阅。</span><span class="sxs-lookup"><span data-stu-id="9dccb-109">See <xref:System.Windows.Forms.DataFormats> for the predefined formats.</span></span> <span data-ttu-id="9dccb-110">可以通过创建<xref:System.Windows.Forms.DataFormats.Format>类的实例来实现自己的格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-110">You can implement your own format by creating an instance of the <xref:System.Windows.Forms.DataFormats.Format> class.</span></span>  
  
 <span data-ttu-id="9dccb-111">若要将数据存储<xref:System.Windows.Forms.DataObject>在中, 请将数据传递给构造<xref:System.Windows.Forms.DataObject.SetData%2A>函数或调用。</span><span class="sxs-lookup"><span data-stu-id="9dccb-111">To store data in a <xref:System.Windows.Forms.DataObject>, pass the data to the constructor or call <xref:System.Windows.Forms.DataObject.SetData%2A>.</span></span> <span data-ttu-id="9dccb-112">可以将多种格式的数据添加到同一个<xref:System.Windows.Forms.DataObject>中。</span><span class="sxs-lookup"><span data-stu-id="9dccb-112">You can add data in multiple formats to the same <xref:System.Windows.Forms.DataObject>.</span></span> <span data-ttu-id="9dccb-113">如果你希望添加的数据仅以本机格式检索, 请调用<xref:System.Windows.Forms.DataObject.SetData%28System.String%2CSystem.Boolean%2CSystem.Object%29> `autoConvert`并将参数设置为`false`。</span><span class="sxs-lookup"><span data-stu-id="9dccb-113">If you want the data you add to be retrieved in its native format only, call <xref:System.Windows.Forms.DataObject.SetData%28System.String%2CSystem.Boolean%2CSystem.Object%29> with the `autoConvert` parameter set to `false`.</span></span>  
  
 <span data-ttu-id="9dccb-114">可以从<xref:System.Windows.Forms.DataObject>与<xref:System.Windows.Forms.DataObject.GetData%2A>兼容的任何格式检索数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-114">Data can be retrieved from a <xref:System.Windows.Forms.DataObject> in any format which is compatible with <xref:System.Windows.Forms.DataObject.GetData%2A>.</span></span> <span data-ttu-id="9dccb-115">例如, 可以将文本转换为 Unicode。</span><span class="sxs-lookup"><span data-stu-id="9dccb-115">For example, text can be converted to Unicode.</span></span> <span data-ttu-id="9dccb-116">若要以存储数据的格式检索数据, 请调用<xref:System.Windows.Forms.DataObject.GetData%2A> `autoConvert`并将参数设置为`false`。</span><span class="sxs-lookup"><span data-stu-id="9dccb-116">To retrieve data in the format in which it was stored, call <xref:System.Windows.Forms.DataObject.GetData%2A> with the `autoConvert` parameter set to `false`.</span></span>  
  
 <span data-ttu-id="9dccb-117">若要确定数据存储的格式, 请调用<xref:System.Windows.Forms.DataObject.GetFormats%2A>。</span><span class="sxs-lookup"><span data-stu-id="9dccb-117">To determine what formats the data is stored in, call <xref:System.Windows.Forms.DataObject.GetFormats%2A>.</span></span> <span data-ttu-id="9dccb-118">若要确定格式是否可用, 请使用<xref:System.Windows.Forms.DataObject.GetDataPresent%2A>所需的格式调用。</span><span class="sxs-lookup"><span data-stu-id="9dccb-118">To determine if a format is available, call <xref:System.Windows.Forms.DataObject.GetDataPresent%2A> with the desired format.</span></span>  
  
 <span data-ttu-id="9dccb-119">在[!INCLUDE[dnprdnext](~/includes/dnprdnext-md.md)]中<xref:System.Windows.Forms.DataObject> , 类提供附加方法, 使您可以更轻松地处理常见格式的数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-119">In [!INCLUDE[dnprdnext](~/includes/dnprdnext-md.md)], the <xref:System.Windows.Forms.DataObject> class provides additional methods that make it easier to work with data in common formats.</span></span> <span data-ttu-id="9dccb-120">若要<xref:System.Windows.Forms.DataObject>向添加特定格式的数据, 请使用适当`Set`的*格式*方法, 如<xref:System.Windows.Forms.DataObject.SetText%2A>。</span><span class="sxs-lookup"><span data-stu-id="9dccb-120">To add data of a particular format to the <xref:System.Windows.Forms.DataObject>, use the appropriate `Set`*Format* method, such as <xref:System.Windows.Forms.DataObject.SetText%2A>.</span></span> <span data-ttu-id="9dccb-121">若<xref:System.Windows.Forms.DataObject>要从中检索特定格式的数据, 请首先调用适当`Contains`的*格式*方法 ( <xref:System.Windows.Forms.DataObject.ContainsText%2A> <xref:System.Windows.Forms.DataObject>如), 以确定是否包含该格式的数据, 然后调用适当的`Get` <xref:System.Windows.Forms.DataObject.GetText%2A>如果包含<xref:System.Windows.Forms.DataObject>数据, 则为格式方法 (如) 以检索数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-121">To retrieve data of a particular format from the <xref:System.Windows.Forms.DataObject>, first call the appropriate `Contains`*Format* method (such as <xref:System.Windows.Forms.DataObject.ContainsText%2A>) to determine whether the <xref:System.Windows.Forms.DataObject> contains data in that format, then call the appropriate `Get`*Format* method (such as <xref:System.Windows.Forms.DataObject.GetText%2A>) to retrieve the data if the <xref:System.Windows.Forms.DataObject> contains it.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="9dccb-122">使用带有剪贴板的图元文件格式时, 可能需要特别注意。</span><span class="sxs-lookup"><span data-stu-id="9dccb-122">Special considerations may be necessary when using the metafile format with the Clipboard.</span></span> <span data-ttu-id="9dccb-123">由于<xref:System.Windows.Forms.DataObject>类的当前实现中存在限制, 因此使用较旧的图元文件格式的应用程序可能无法识别 .NET Framework 使用的图元文件格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-123">Due to a limitation in the current implementation of the <xref:System.Windows.Forms.DataObject> class, the metafile format used by the .NET Framework may not be recognized by applications that use an older metafile format.</span></span> <span data-ttu-id="9dccb-124">在这种情况下, 必须与 Win32 剪贴板应用程序编程接口 (Api) 进行互操作。</span><span class="sxs-lookup"><span data-stu-id="9dccb-124">In this case, you must interoperate with the Win32 Clipboard application programming interfaces (APIs).</span></span>
>   
>  <span data-ttu-id="9dccb-125">对象必须是可序列化的, 才能将其放在剪贴板上。</span><span class="sxs-lookup"><span data-stu-id="9dccb-125">An object must be serializable for it to be put on the Clipboard.</span></span> <span data-ttu-id="9dccb-126">有关<xref:System.Runtime.Serialization>序列化的详细信息, 请参阅。</span><span class="sxs-lookup"><span data-stu-id="9dccb-126">See <xref:System.Runtime.Serialization> for more information on serialization.</span></span> <span data-ttu-id="9dccb-127">如果目标应用程序需要非常具体的数据格式, 则在序列化过程中添加到数据的标头可能会阻止应用程序识别数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-127">If your target application requires a very specific data format, the headers added to the data in the serialization process may prevent the application from recognizing your data.</span></span> <span data-ttu-id="9dccb-128">若要保留数据格式, 请<xref:System.Byte>将数据作为数组添加<xref:System.IO.MemoryStream>到, <xref:System.Windows.Forms.DataObject.SetData%2A>并将传递<xref:System.IO.MemoryStream>给方法。</span><span class="sxs-lookup"><span data-stu-id="9dccb-128">To preserve your data format, add your data as a <xref:System.Byte> array to a <xref:System.IO.MemoryStream> and pass the <xref:System.IO.MemoryStream> to the <xref:System.Windows.Forms.DataObject.SetData%2A> method.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9dccb-129">下面的代码示例在中<xref:System.Windows.Forms.DataObject>添加数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-129">The following code example adds data in a <xref:System.Windows.Forms.DataObject>.</span></span> <span data-ttu-id="9dccb-130">首先, 创建一个<xref:System.Windows.Forms.DataObject>新的, 并在其中存储一个组件。</span><span class="sxs-lookup"><span data-stu-id="9dccb-130">First, a new <xref:System.Windows.Forms.DataObject> is created and a component is stored in it.</span></span> <span data-ttu-id="9dccb-131">然后, 它会检查中是否存在<xref:System.Windows.Forms.DataObject>适当类型的数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-131">Then, it checks to see if data in the appropriate type exists in the <xref:System.Windows.Forms.DataObject>.</span></span> <span data-ttu-id="9dccb-132">结果将显示在文本框中。</span><span class="sxs-lookup"><span data-stu-id="9dccb-132">The result is displayed in a text box.</span></span> <span data-ttu-id="9dccb-133">此代码需要已`textBox1`创建的。</span><span class="sxs-lookup"><span data-stu-id="9dccb-133">This code requires that `textBox1` has been created.</span></span>  
  
 [!code-cpp[Classic DataObject Example#1](~/samples/snippets/cpp/VS_Snippets_Winforms/Classic DataObject Example/CPP/source.cpp#1)]
 [!code-csharp[Classic DataObject Example#1](~/samples/snippets/csharp/VS_Snippets_Winforms/Classic DataObject Example/CS/source.cs#1)]
 [!code-vb[Classic DataObject Example#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/Classic DataObject Example/VB/source.vb#1)]  
  
 <span data-ttu-id="9dccb-134">下一个示例检索存储在中<xref:System.Windows.Forms.DataObject>的数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-134">The next example retrieves the data stored in a <xref:System.Windows.Forms.DataObject>.</span></span> <span data-ttu-id="9dccb-135">首先, 使用文本<xref:System.Windows.Forms.DataObject>数据创建新的。</span><span class="sxs-lookup"><span data-stu-id="9dccb-135">First, a new <xref:System.Windows.Forms.DataObject> is created with text data.</span></span> <span data-ttu-id="9dccb-136">然后, 检索数据, 将其格式指定为字符串, 并在文本框中显示。</span><span class="sxs-lookup"><span data-stu-id="9dccb-136">Then, the data is retrieved, specifying its format as a string, and displayed in a text box.</span></span> <span data-ttu-id="9dccb-137">数据格式将自动从文本转换为字符串。</span><span class="sxs-lookup"><span data-stu-id="9dccb-137">The data format is automatically converted from text to string.</span></span> <span data-ttu-id="9dccb-138">此代码需要已`textBox1`创建的。</span><span class="sxs-lookup"><span data-stu-id="9dccb-138">This code requires that `textBox1` has been created.</span></span>  
  
 [!code-cpp[Classic DataObject Example#2](~/samples/snippets/cpp/VS_Snippets_Winforms/Classic DataObject Example/CPP/source.cpp#2)]
 [!code-csharp[Classic DataObject Example#2](~/samples/snippets/csharp/VS_Snippets_Winforms/Classic DataObject Example/CS/source.cs#2)]
 [!code-vb[Classic DataObject Example#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/Classic DataObject Example/VB/source.vb#2)]  
  
 ]]></format>
    </remarks>
    <altmember cref="T:System.Windows.Forms.Clipboard" />
    <altmember cref="T:System.Windows.Forms.IDataObject" />
    <altmember cref="T:System.Windows.Forms.DataFormats" />
  </Docs>
  <Members>
    <MemberGroup MemberName=".ctor">
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="9dccb-139">初始化 <see cref="T:System.Windows.Forms.DataObject" /> 类的新实例。</span><span class="sxs-lookup"><span data-stu-id="9dccb-139">Initializes a new instance of the <see cref="T:System.Windows.Forms.DataObject" /> class.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public DataObject ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; DataObject();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="9dccb-140">初始化 <see cref="T:System.Windows.Forms.DataObject" /> 类的新实例。</span><span class="sxs-lookup"><span data-stu-id="9dccb-140">Initializes a new instance of the <see cref="T:System.Windows.Forms.DataObject" /> class.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Examples  
 <span data-ttu-id="9dccb-141">下面的代码示例创建一个<xref:System.Windows.Forms.DataObject>并向其中添加数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-141">The following code example creates a <xref:System.Windows.Forms.DataObject> and adds data to it.</span></span> <span data-ttu-id="9dccb-142">然后, 该示例将检索并显示数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-142">The example then retrieves and displays the data.</span></span> <span data-ttu-id="9dccb-143">此代码需要已`textBox1`创建的。</span><span class="sxs-lookup"><span data-stu-id="9dccb-143">This code requires that `textBox1` has been created.</span></span>  
  
 [!code-cpp[Classic DataObject.DataObject2 Example#1](~/samples/snippets/cpp/VS_Snippets_Winforms/Classic DataObject.DataObject2 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic DataObject.DataObject2 Example#1](~/samples/snippets/csharp/VS_Snippets_Winforms/Classic DataObject.DataObject2 Example/CS/source.cs#1)]
 [!code-vb[Classic DataObject.DataObject2 Example#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/Classic DataObject.DataObject2 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Windows.Forms.DataObject.GetData(System.String,System.Boolean)" />
        <altmember cref="M:System.Windows.Forms.DataObject.SetData(System.String,System.Boolean,System.Object)" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetDataPresent(System.Type)" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public DataObject (object data);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(object data) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.#ctor(System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (data As Object)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; DataObject(System::Object ^ data);" />
      <MemberSignature Language="F#" Value="new System.Windows.Forms.DataObject : obj -&gt; System.Windows.Forms.DataObject" Usage="new System.Windows.Forms.DataObject data" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="data" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="data"><span data-ttu-id="9dccb-144">要存储的数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-144">The data to store.</span></span></param>
        <summary><span data-ttu-id="9dccb-145">初始化 <see cref="T:System.Windows.Forms.DataObject" /> 类的新实例，并为其添加指定的对象。</span><span class="sxs-lookup"><span data-stu-id="9dccb-145">Initializes a new instance of the <see cref="T:System.Windows.Forms.DataObject" /> class and adds the specified object to it.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9dccb-146">使用此构造函数时, 可以将任何<xref:System.Windows.Forms.DataObject>格式的数据添加到, 也可以将数据<xref:System.Windows.Forms.IDataObject>添加为, 同时提供多种格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-146">You can add data in any format to the <xref:System.Windows.Forms.DataObject> when you use this constructor, or you can add data as an <xref:System.Windows.Forms.IDataObject> to provide multiple formats at once.</span></span> <span data-ttu-id="9dccb-147">如果你熟悉 COM 编程, 还可以添加实现 COM `IDataObject`接口的数据对象。</span><span class="sxs-lookup"><span data-stu-id="9dccb-147">If you are familiar with COM programming, you can also add a data object that implements the COM `IDataObject` interface.</span></span> <span data-ttu-id="9dccb-148">有关详细信息, 请`IDataObject`参阅上http://msdn.microsoft.com/libraryMSDN library 中的。</span><span class="sxs-lookup"><span data-stu-id="9dccb-148">For more information, see `IDataObject` in the MSDN library at http://msdn.microsoft.com/library.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9dccb-149">下面的代码示例创建一个<xref:System.Windows.Forms.DataObject>包含字符串的。</span><span class="sxs-lookup"><span data-stu-id="9dccb-149">The following code example creates a <xref:System.Windows.Forms.DataObject> that contains a string.</span></span> <span data-ttu-id="9dccb-150">使用数据格式检索数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-150">The data is retrieved using its data format.</span></span> <span data-ttu-id="9dccb-151">结果显示在文本框中。</span><span class="sxs-lookup"><span data-stu-id="9dccb-151">The results are displayed in a text box.</span></span> <span data-ttu-id="9dccb-152">此代码需要已`textBox1`创建的。</span><span class="sxs-lookup"><span data-stu-id="9dccb-152">This code requires that `textBox1` has been created.</span></span>  
  
 [!code-cpp[Classic DataObject.DataObject3 Example#1](~/samples/snippets/cpp/VS_Snippets_Winforms/Classic DataObject.DataObject3 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic DataObject.DataObject3 Example#1](~/samples/snippets/csharp/VS_Snippets_Winforms/Classic DataObject.DataObject3 Example/CS/source.cs#1)]
 [!code-vb[Classic DataObject.DataObject3 Example#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/Classic DataObject.DataObject3 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Windows.Forms.IDataObject" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetData(System.String,System.Boolean)" />
        <altmember cref="M:System.Windows.Forms.DataObject.SetData(System.String,System.Boolean,System.Object)" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetDataPresent(System.Type)" />
        <related type="ExternalDocumentation" href="https://go.microsoft.com/fwlink/?LinkID=150123"><span data-ttu-id="9dccb-153">IDataObject</span><span class="sxs-lookup"><span data-stu-id="9dccb-153">IDataObject</span></span></related>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public DataObject (string format, object data);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string format, object data) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.#ctor(System.String,System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (format As String, data As Object)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; DataObject(System::String ^ format, System::Object ^ data);" />
      <MemberSignature Language="F#" Value="new System.Windows.Forms.DataObject : string * obj -&gt; System.Windows.Forms.DataObject" Usage="new System.Windows.Forms.DataObject (format, data)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="format" Type="System.String" />
        <Parameter Name="data" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="format"><span data-ttu-id="9dccb-154">指定数据的格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-154">The format of the specified data.</span></span> <span data-ttu-id="9dccb-155">请参见 <see cref="T:System.Windows.Forms.DataFormats" /> 以获取预定义的格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-155">See <see cref="T:System.Windows.Forms.DataFormats" /> for predefined formats.</span></span></param>
        <param name="data"><span data-ttu-id="9dccb-156">要存储的数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-156">The data to store.</span></span></param>
        <summary><span data-ttu-id="9dccb-157">初始化 <see cref="T:System.Windows.Forms.DataObject" /> 类的新实例，并以指定格式为其添加指定的对象。</span><span class="sxs-lookup"><span data-stu-id="9dccb-157">Initializes a new instance of the <see cref="T:System.Windows.Forms.DataObject" /> class and adds the specified object in the specified format.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Examples  
 <span data-ttu-id="9dccb-158">下面的代码示例使用指定<xref:System.Windows.Forms.DataObject>为字符串类型的字符串创建类。</span><span class="sxs-lookup"><span data-stu-id="9dccb-158">The following code example creates a <xref:System.Windows.Forms.DataObject> class using a string that is specified as the string type.</span></span> <span data-ttu-id="9dccb-159">从检索数据, <xref:System.Windows.Forms.DataObject>方法是将其格式指定为文本。</span><span class="sxs-lookup"><span data-stu-id="9dccb-159">The data is retrieved from the <xref:System.Windows.Forms.DataObject> by specifying its format as text.</span></span> <span data-ttu-id="9dccb-160">结果显示在文本框中。</span><span class="sxs-lookup"><span data-stu-id="9dccb-160">The results are displayed in a text box.</span></span> <span data-ttu-id="9dccb-161">此代码需要已`textBox1`创建的。</span><span class="sxs-lookup"><span data-stu-id="9dccb-161">This code requires that `textBox1` has been created.</span></span>  
  
 [!code-cpp[Classic DataObject.DataObject4 Example#1](~/samples/snippets/cpp/VS_Snippets_Winforms/Classic DataObject.DataObject4 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic DataObject.DataObject4 Example#1](~/samples/snippets/csharp/VS_Snippets_Winforms/Classic DataObject.DataObject4 Example/CS/source.cs#1)]
 [!code-vb[Classic DataObject.DataObject4 Example#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/Classic DataObject.DataObject4 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Windows.Forms.DataObject.GetData(System.String,System.Boolean)" />
        <altmember cref="M:System.Windows.Forms.DataObject.SetData(System.String,System.Boolean,System.Object)" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetDataPresent(System.Type)" />
      </Docs>
    </Member>
    <Member MemberName="ContainsAudio">
      <MemberSignature Language="C#" Value="public virtual bool ContainsAudio ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance bool ContainsAudio() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.ContainsAudio" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Function ContainsAudio () As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual bool ContainsAudio();" />
      <MemberSignature Language="F#" Value="abstract member ContainsAudio : unit -&gt; bool&#xA;override this.ContainsAudio : unit -&gt; bool" Usage="dataObject.ContainsAudio " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="9dccb-162">指示此数据对象是否包含 <see cref="F:System.Windows.Forms.DataFormats.WaveAudio" /> 格式的数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-162">Indicates whether the data object contains data in the <see cref="F:System.Windows.Forms.DataFormats.WaveAudio" /> format.</span></span></summary>
        <returns><span data-ttu-id="9dccb-163">如果此数据对象包含音频数据，则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="9dccb-163"><see langword="true" /> if the data object contains audio data; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9dccb-164">使用此方法可以在使用<xref:System.Windows.Forms.DataObject.GetAudioStream%2A>方法检索数据对象之前, 确定该数据对象是否包含音频数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-164">Use this method to determine whether the data object contains audio data before retrieving it with the <xref:System.Windows.Forms.DataObject.GetAudioStream%2A> method.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="F:System.Windows.Forms.DataFormats.WaveAudio" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetAudioStream" />
        <altmember cref="Overload:System.Windows.Forms.DataObject.SetAudio" />
      </Docs>
    </Member>
    <Member MemberName="ContainsFileDropList">
      <MemberSignature Language="C#" Value="public virtual bool ContainsFileDropList ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance bool ContainsFileDropList() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.ContainsFileDropList" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Function ContainsFileDropList () As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual bool ContainsFileDropList();" />
      <MemberSignature Language="F#" Value="abstract member ContainsFileDropList : unit -&gt; bool&#xA;override this.ContainsFileDropList : unit -&gt; bool" Usage="dataObject.ContainsFileDropList " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="9dccb-165">指示此数据对象是否包含 <see cref="F:System.Windows.Forms.DataFormats.FileDrop" /> 格式的数据，或者是否包含可以转换为该格式的数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-165">Indicates whether the data object contains data that is in the <see cref="F:System.Windows.Forms.DataFormats.FileDrop" /> format or can be converted to that format.</span></span></summary>
        <returns><span data-ttu-id="9dccb-166">如果此数据对象包含文件放置列表则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="9dccb-166"><see langword="true" /> if the data object contains a file drop list; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9dccb-167">文件放置列表是包含文件的路径信息的字符串的集合。</span><span class="sxs-lookup"><span data-stu-id="9dccb-167">A file drop list is a collection of strings containing path information for files.</span></span>  
  
 <span data-ttu-id="9dccb-168">使用此方法可以在使用<xref:System.Windows.Forms.DataObject.GetFileDropList%2A>方法检索数据对象之前, 确定该数据对象是否包含文件放置列表。</span><span class="sxs-lookup"><span data-stu-id="9dccb-168">Use this method to determine whether the data object contains a file drop list before retrieving it with the <xref:System.Windows.Forms.DataObject.GetFileDropList%2A> method.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="F:System.Windows.Forms.DataFormats.FileDrop" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetFileDropList" />
        <altmember cref="M:System.Windows.Forms.DataObject.SetFileDropList(System.Collections.Specialized.StringCollection)" />
      </Docs>
    </Member>
    <Member MemberName="ContainsImage">
      <MemberSignature Language="C#" Value="public virtual bool ContainsImage ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance bool ContainsImage() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.ContainsImage" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Function ContainsImage () As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual bool ContainsImage();" />
      <MemberSignature Language="F#" Value="abstract member ContainsImage : unit -&gt; bool&#xA;override this.ContainsImage : unit -&gt; bool" Usage="dataObject.ContainsImage " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="9dccb-169">指示此数据对象是否包含 <see cref="F:System.Windows.Forms.DataFormats.Bitmap" /> 格式的数据，或者是否包含可以转换为该格式的数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-169">Indicates whether the data object contains data that is in the <see cref="F:System.Windows.Forms.DataFormats.Bitmap" /> format or can be converted to that format.</span></span></summary>
        <returns><span data-ttu-id="9dccb-170">如果此数据对象包含图像数据则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="9dccb-170"><see langword="true" /> if the data object contains image data; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9dccb-171">使用此方法可以在使用<xref:System.Windows.Forms.DataObject.GetImage%2A>方法检索数据对象之前, 确定该数据对象是否包含图像数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-171">Use this method to determine whether the data object contains image data before retrieving it with the <xref:System.Windows.Forms.DataObject.GetImage%2A> method.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="F:System.Windows.Forms.DataFormats.Bitmap" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetImage" />
        <altmember cref="M:System.Windows.Forms.DataObject.SetImage(System.Drawing.Image)" />
      </Docs>
    </Member>
    <MemberGroup MemberName="ContainsText">
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="9dccb-172">指示此数据对象是否包含文本数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-172">Indicates whether the data object contains text data.</span></span></summary>
        <altmember cref="T:System.Windows.Forms.TextDataFormat" />
        <altmember cref="Overload:System.Windows.Forms.DataObject.GetText" />
        <altmember cref="Overload:System.Windows.Forms.DataObject.SetText" />
      </Docs>
    </MemberGroup>
    <Member MemberName="ContainsText">
      <MemberSignature Language="C#" Value="public virtual bool ContainsText ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance bool ContainsText() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.ContainsText" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Function ContainsText () As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual bool ContainsText();" />
      <MemberSignature Language="F#" Value="abstract member ContainsText : unit -&gt; bool&#xA;override this.ContainsText : unit -&gt; bool" Usage="dataObject.ContainsText " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="9dccb-173">指示此数据对象是否包含 <see cref="F:System.Windows.Forms.TextDataFormat.UnicodeText" /> 格式的数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-173">Indicates whether the data object contains data in the <see cref="F:System.Windows.Forms.TextDataFormat.UnicodeText" /> format.</span></span></summary>
        <returns><span data-ttu-id="9dccb-174">如果此数据对象包含文本数据则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="9dccb-174"><see langword="true" /> if the data object contains text data; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9dccb-175">使用此方法可以在使用<xref:System.Windows.Forms.DataObject.GetText%2A>方法检索数据对象之前, 确定该数据对象是否包含文本数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-175">Use this method to determine whether the data object contains text data before retrieving it with the <xref:System.Windows.Forms.DataObject.GetText%2A> method.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="F:System.Windows.Forms.TextDataFormat.UnicodeText" />
        <altmember cref="Overload:System.Windows.Forms.DataObject.GetText" />
        <altmember cref="Overload:System.Windows.Forms.DataObject.SetText" />
      </Docs>
    </Member>
    <Member MemberName="ContainsText">
      <MemberSignature Language="C#" Value="public virtual bool ContainsText (System.Windows.Forms.TextDataFormat format);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance bool ContainsText(valuetype System.Windows.Forms.TextDataFormat format) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.ContainsText(System.Windows.Forms.TextDataFormat)" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Function ContainsText (format As TextDataFormat) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual bool ContainsText(System::Windows::Forms::TextDataFormat format);" />
      <MemberSignature Language="F#" Value="abstract member ContainsText : System.Windows.Forms.TextDataFormat -&gt; bool&#xA;override this.ContainsText : System.Windows.Forms.TextDataFormat -&gt; bool" Usage="dataObject.ContainsText format" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="format" Type="System.Windows.Forms.TextDataFormat" Index="0" FrameworkAlternate="netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="format"><span data-ttu-id="9dccb-176"><see cref="T:System.Windows.Forms.TextDataFormat" /> 值之一。</span><span class="sxs-lookup"><span data-stu-id="9dccb-176">One of the <see cref="T:System.Windows.Forms.TextDataFormat" /> values.</span></span></param>
        <summary><span data-ttu-id="9dccb-177">指示此数据对象是否包含由指定的 <see cref="T:System.Windows.Forms.TextDataFormat" /> 值表示的格式的文本数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-177">Indicates whether the data object contains text data in the format indicated by the specified <see cref="T:System.Windows.Forms.TextDataFormat" /> value.</span></span></summary>
        <returns><span data-ttu-id="9dccb-178">如果此数据对象包含指定格式的文本数据则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="9dccb-178"><see langword="true" /> if the data object contains text data in the specified format; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9dccb-179">使用此方法可以在使用<xref:System.Windows.Forms.DataObject.GetText%2A>方法检索数据对象之前, 确定该数据对象是否包含文本数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-179">Use this method to determine whether the data object contains text data before retrieving it with the <xref:System.Windows.Forms.DataObject.GetText%2A> method.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="9dccb-180"><paramref name="format" /> 不是有效的 <see cref="T:System.Windows.Forms.TextDataFormat" /> 值。</span><span class="sxs-lookup"><span data-stu-id="9dccb-180"><paramref name="format" /> is not a valid <see cref="T:System.Windows.Forms.TextDataFormat" /> value.</span></span></exception>
        <altmember cref="T:System.Windows.Forms.TextDataFormat" />
        <altmember cref="Overload:System.Windows.Forms.DataObject.GetText" />
        <altmember cref="Overload:System.Windows.Forms.DataObject.SetText" />
      </Docs>
    </Member>
    <Member MemberName="GetAudioStream">
      <MemberSignature Language="C#" Value="public virtual System.IO.Stream GetAudioStream ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance class System.IO.Stream GetAudioStream() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.GetAudioStream" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Function GetAudioStream () As Stream" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual System::IO::Stream ^ GetAudioStream();" />
      <MemberSignature Language="F#" Value="abstract member GetAudioStream : unit -&gt; System.IO.Stream&#xA;override this.GetAudioStream : unit -&gt; System.IO.Stream" Usage="dataObject.GetAudioStream " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IO.Stream</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="9dccb-181">检索此数据对象中的音频流。</span><span class="sxs-lookup"><span data-stu-id="9dccb-181">Retrieves an audio stream from the data object.</span></span></summary>
        <returns><span data-ttu-id="9dccb-182">包含音频数据的 <see cref="T:System.IO.Stream" />；如果此数据对象不包含任何 <see cref="F:System.Windows.Forms.DataFormats.WaveAudio" /> 格式的数据，则为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="9dccb-182">A <see cref="T:System.IO.Stream" /> containing audio data or <see langword="null" /> if the data object does not contain any data in the <see cref="F:System.Windows.Forms.DataFormats.WaveAudio" /> format.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9dccb-183"><xref:System.Windows.Forms.DataObject.ContainsAudio%2A>使用方法在使用此方法检索数据对象之前, 确定该数据对象是否包含音频数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-183">Use the <xref:System.Windows.Forms.DataObject.ContainsAudio%2A> method to determine whether the data object contains audio data before retrieving it with this method.</span></span>  
  
 <span data-ttu-id="9dccb-184"><xref:System.Windows.Forms.DataObject.SetAudio%2A>使用方法可将音频数据添加到数据对象。</span><span class="sxs-lookup"><span data-stu-id="9dccb-184">Use the <xref:System.Windows.Forms.DataObject.SetAudio%2A> method to add audio data to the data object.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.IO.Stream" />
        <altmember cref="F:System.Windows.Forms.DataFormats.WaveAudio" />
        <altmember cref="M:System.Windows.Forms.DataObject.ContainsAudio" />
        <altmember cref="Overload:System.Windows.Forms.DataObject.SetAudio" />
      </Docs>
    </Member>
    <MemberGroup MemberName="GetData">
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="9dccb-185">返回与所指定数据格式关联的数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-185">Returns the data associated with the specified data format.</span></span></summary>
        <altmember cref="M:System.Windows.Forms.DataObject.SetData(System.String,System.Boolean,System.Object)" />
        <altmember cref="T:System.Type" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetDataPresent(System.Type)" />
        <altmember cref="T:System.Windows.Forms.DataFormats" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetFormats(System.Boolean)" />
      </Docs>
    </MemberGroup>
    <Member MemberName="GetData">
      <MemberSignature Language="C#" Value="public virtual object GetData (string format);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance object GetData(string format) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.GetData(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Function GetData (format As String) As Object" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual System::Object ^ GetData(System::String ^ format);" />
      <MemberSignature Language="F#" Value="abstract member GetData : string -&gt; obj&#xA;override this.GetData : string -&gt; obj" Usage="dataObject.GetData format" />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.Windows.Forms.IDataObject.GetData(System.String)</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Object</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="format" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="format"><span data-ttu-id="9dccb-186">要检索的数据的格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-186">The format of the data to retrieve.</span></span> <span data-ttu-id="9dccb-187">请参见 <see cref="T:System.Windows.Forms.DataFormats" /> 以获取预定义的格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-187">See <see cref="T:System.Windows.Forms.DataFormats" /> for predefined formats.</span></span></param>
        <summary><span data-ttu-id="9dccb-188">返回与所指定数据格式关联的数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-188">Returns the data associated with the specified data format.</span></span></summary>
        <returns><span data-ttu-id="9dccb-189">与指定格式关联的数据，或为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="9dccb-189">The data associated with the specified format, or <see langword="null" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9dccb-190">如果此方法无法找到具有指定格式的数据, 则会尝试将数据转换为格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-190">If this method cannot find data in the specified format, it attempts to convert the data to the format.</span></span> <span data-ttu-id="9dccb-191">如果数据无法转换为指定的格式, 或者, 如果数据是通过自动转换设置为`false`存储的, 则此方法将返回。 `null`</span><span class="sxs-lookup"><span data-stu-id="9dccb-191">If the data cannot be converted to the specified format, or if the data was stored with automatic conversion set to `false`, this method returns `null`.</span></span>  
  
 <span data-ttu-id="9dccb-192">若要确定数据是与格式关联还是可转换为格式, 请在调用<xref:System.Windows.Forms.DataObject.GetDataPresent%2A> <xref:System.Windows.Forms.DataObject.GetData%2A>前调用。</span><span class="sxs-lookup"><span data-stu-id="9dccb-192">To determine whether data is associated with, or can be converted to, a format, call <xref:System.Windows.Forms.DataObject.GetDataPresent%2A> before calling <xref:System.Windows.Forms.DataObject.GetData%2A>.</span></span> <span data-ttu-id="9dccb-193">调用<xref:System.Windows.Forms.DataObject.GetFormats%2A>以获取此<xref:System.Windows.Forms.DataObject>中存储的数据的有效格式列表。</span><span class="sxs-lookup"><span data-stu-id="9dccb-193">Call <xref:System.Windows.Forms.DataObject.GetFormats%2A> for a list of valid formats for the data stored in this <xref:System.Windows.Forms.DataObject>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="9dccb-194">如果数据已存储, 则可以将其转换为另一种格式, 这种格式指定允许该转换, 并且请求的格式与存储格式兼容。</span><span class="sxs-lookup"><span data-stu-id="9dccb-194">Data can be converted to another format if it was stored specifying that conversion is allowed, and if the requested format is compatible with the stored format.</span></span> <span data-ttu-id="9dccb-195">例如, 以 Unicode 形式存储的数据可以转换为文本。</span><span class="sxs-lookup"><span data-stu-id="9dccb-195">For example, data stored as Unicode can be converted to text.</span></span>  
>   
>  <span data-ttu-id="9dccb-196">当`format` 为<xref:System.Windows.Forms.DataFormats.Html>时, 此方法将在以 .net 4.5 或更高版本为目标的应用程序中返回 utf-8 编码的字符串, 并在面向 .net 4.0 或更低版本的应用程序中返回 ANSI 编码的字符串。</span><span class="sxs-lookup"><span data-stu-id="9dccb-196">When `format` is <xref:System.Windows.Forms.DataFormats.Html>, this method returns a UTF-8 encoded string in applications that target .NET 4.5 or higher, and an ANSI encoded string in applications that target .NET 4.0 or lower.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9dccb-197">下面的代码示例检索中<xref:System.Windows.Forms.DataObject>存储的数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-197">The following code example retrieves the data stored in a <xref:System.Windows.Forms.DataObject>.</span></span> <span data-ttu-id="9dccb-198">首先, 使用文本<xref:System.Windows.Forms.DataObject>数据创建新的。</span><span class="sxs-lookup"><span data-stu-id="9dccb-198">First, a new <xref:System.Windows.Forms.DataObject> is created with text data.</span></span> <span data-ttu-id="9dccb-199">然后, 检索数据, 将其格式指定为字符串, 并在文本框中显示。</span><span class="sxs-lookup"><span data-stu-id="9dccb-199">Then, the data is retrieved, specifying its format as a string, and displayed in a text box.</span></span>  
  
 <span data-ttu-id="9dccb-200">此代码需要已`textBox1`创建的。</span><span class="sxs-lookup"><span data-stu-id="9dccb-200">This code requires that `textBox1` has been created.</span></span>  
  
 [!code-cpp[classic dataobject example#1](~/samples/snippets/cpp/VS_Snippets_Winforms/Classic DataObject Example/CPP/source.cpp#1)]
 [!code-csharp[classic dataobject example#1](~/samples/snippets/csharp/VS_Snippets_Winforms/Classic DataObject Example/CS/source.cs#1)]
 [!code-vb[classic dataobject example#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/Classic DataObject Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Windows.Forms.DataObject.SetData(System.String,System.Boolean,System.Object)" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetDataPresent(System.Type)" />
        <altmember cref="T:System.Windows.Forms.DataFormats" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetFormats(System.Boolean)" />
      </Docs>
    </Member>
    <Member MemberName="GetData">
      <MemberSignature Language="C#" Value="public virtual object GetData (Type format);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance object GetData(class System.Type format) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.GetData(System.Type)" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Function GetData (format As Type) As Object" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual System::Object ^ GetData(Type ^ format);" />
      <MemberSignature Language="F#" Value="abstract member GetData : Type -&gt; obj&#xA;override this.GetData : Type -&gt; obj" Usage="dataObject.GetData format" />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.Windows.Forms.IDataObject.GetData(System.Type)</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Object</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="format" Type="System.Type" />
      </Parameters>
      <Docs>
        <param name="format"><span data-ttu-id="9dccb-201"><see cref="T:System.Type" /> 表示要检索的数据的格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-201">A <see cref="T:System.Type" /> representing the format of the data to retrieve.</span></span></param>
        <summary><span data-ttu-id="9dccb-202">返回与所指定类类型格式关联的数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-202">Returns the data associated with the specified class type format.</span></span></summary>
        <returns><span data-ttu-id="9dccb-203">与指定格式关联的数据，或为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="9dccb-203">The data associated with the specified format, or <see langword="null" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9dccb-204">如果此方法无法找到具有指定格式的数据, 则会尝试将数据转换为格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-204">If this method cannot find data in the specified format, it attempts to convert the data to the format.</span></span> <span data-ttu-id="9dccb-205">如果数据无法转换为指定的格式, 或者, 如果数据是通过自动转换设置为`false`存储的, 则此方法将返回。 `null`</span><span class="sxs-lookup"><span data-stu-id="9dccb-205">If the data cannot be converted to the specified format, or if the data was stored with automatic conversion set to `false`, this method returns `null`.</span></span>  
  
 <span data-ttu-id="9dccb-206">若要确定数据是与格式关联还是可转换为格式, 请在调用<xref:System.Windows.Forms.DataObject.GetDataPresent%2A> <xref:System.Windows.Forms.DataObject.GetData%2A>前调用。</span><span class="sxs-lookup"><span data-stu-id="9dccb-206">To determine whether data is associated with, or can be converted to, a format, call <xref:System.Windows.Forms.DataObject.GetDataPresent%2A> before calling <xref:System.Windows.Forms.DataObject.GetData%2A>.</span></span> <span data-ttu-id="9dccb-207">调用<xref:System.Windows.Forms.DataObject.GetFormats%2A>以获取此<xref:System.Windows.Forms.DataObject>中存储的数据的有效格式列表。</span><span class="sxs-lookup"><span data-stu-id="9dccb-207">Call <xref:System.Windows.Forms.DataObject.GetFormats%2A> for a list of valid formats for the data stored in this <xref:System.Windows.Forms.DataObject>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="9dccb-208">如果数据已存储, 则可以将其转换为另一种格式, 这种格式指定允许该转换, 并且请求的格式与存储格式兼容。</span><span class="sxs-lookup"><span data-stu-id="9dccb-208">Data can be converted to another format if it was stored specifying that conversion is allowed, and if the requested format is compatible with the stored format.</span></span> <span data-ttu-id="9dccb-209">例如, 以 Unicode 形式存储的数据可以转换为文本。</span><span class="sxs-lookup"><span data-stu-id="9dccb-209">For example, data stored as Unicode can be converted to text.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9dccb-210">下面的代码示例检索中<xref:System.Windows.Forms.DataObject>存储的数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-210">The following code example retrieves the data stored in a <xref:System.Windows.Forms.DataObject>.</span></span> <span data-ttu-id="9dccb-211">首先, 使用组件<xref:System.Windows.Forms.DataObject>创建新的。</span><span class="sxs-lookup"><span data-stu-id="9dccb-211">First, a new <xref:System.Windows.Forms.DataObject> is created with a component.</span></span> <span data-ttu-id="9dccb-212">然后, 将检索数据并指定其类型。</span><span class="sxs-lookup"><span data-stu-id="9dccb-212">Then, the data is retrieved, specifying its type.</span></span> <span data-ttu-id="9dccb-213">检索到的数据的类型会显示在文本框中。</span><span class="sxs-lookup"><span data-stu-id="9dccb-213">The type of the retrieved data is displayed in a text box.</span></span>  
  
 <span data-ttu-id="9dccb-214">此代码需要已`textBox1`创建的。</span><span class="sxs-lookup"><span data-stu-id="9dccb-214">This code requires that `textBox1` has been created.</span></span>  
  
 [!code-cpp[Classic DataObject.GetData2 Example#1](~/samples/snippets/cpp/VS_Snippets_Winforms/Classic DataObject.GetData2 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic DataObject.GetData2 Example#1](~/samples/snippets/csharp/VS_Snippets_Winforms/Classic DataObject.GetData2 Example/CS/source.cs#1)]
 [!code-vb[Classic DataObject.GetData2 Example#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/Classic DataObject.GetData2 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Windows.Forms.DataObject.SetData(System.String,System.Boolean,System.Object)" />
        <altmember cref="T:System.Type" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetDataPresent(System.Type)" />
        <altmember cref="T:System.Windows.Forms.DataFormats" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetFormats(System.Boolean)" />
      </Docs>
    </Member>
    <Member MemberName="GetData">
      <MemberSignature Language="C#" Value="public virtual object GetData (string format, bool autoConvert);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance object GetData(string format, bool autoConvert) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.GetData(System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Function GetData (format As String, autoConvert As Boolean) As Object" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual System::Object ^ GetData(System::String ^ format, bool autoConvert);" />
      <MemberSignature Language="F#" Value="abstract member GetData : string * bool -&gt; obj&#xA;override this.GetData : string * bool -&gt; obj" Usage="dataObject.GetData (format, autoConvert)" />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.Windows.Forms.IDataObject.GetData(System.String,System.Boolean)</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Object</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="format" Type="System.String" />
        <Parameter Name="autoConvert" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="format"><span data-ttu-id="9dccb-215">要检索的数据的格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-215">The format of the data to retrieve.</span></span> <span data-ttu-id="9dccb-216">请参见 <see cref="T:System.Windows.Forms.DataFormats" /> 以获取预定义的格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-216">See <see cref="T:System.Windows.Forms.DataFormats" /> for predefined formats.</span></span></param>
        <param name="autoConvert"><span data-ttu-id="9dccb-217">如果要将数据转换成指定的格式，则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="9dccb-217"><see langword="true" /> to the convert data to the specified format; otherwise, <see langword="false" />.</span></span></param>
        <summary><span data-ttu-id="9dccb-218">返回与所指定数据格式关联的数据，使用自动转换参数来确定是否将数据转换为此格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-218">Returns the data associated with the specified data format, using an automated conversion parameter to determine whether to convert the data to the format.</span></span></summary>
        <returns><span data-ttu-id="9dccb-219">与指定格式关联的数据，或为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="9dccb-219">The data associated with the specified format, or <see langword="null" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9dccb-220">如果参数为`true` , 并且此方法无法找到具有指定格式的数据, 则它会尝试将数据转换为格式。 `autoConvert`</span><span class="sxs-lookup"><span data-stu-id="9dccb-220">If the `autoConvert` parameter is `true` and this method cannot find data in the specified format, it attempts to convert the data to the format.</span></span> <span data-ttu-id="9dccb-221">如果数据无法转换为指定的格式, 或者如果数据是在自动转换设置为`false`的情况下存储的, 则此方法将返回。 `null`</span><span class="sxs-lookup"><span data-stu-id="9dccb-221">If the data cannot be converted to the specified format, or if the data was stored with the automatic conversion set to `false`, this method returns `null`.</span></span>  
  
 <span data-ttu-id="9dccb-222">如果参数为`false`, 则此方法返回指定格式`null`的数据; 如果找不到此格式的数据, 则为。 `autoConvert`</span><span class="sxs-lookup"><span data-stu-id="9dccb-222">If the `autoConvert` parameter is `false`, this method returns data in the specified format, or `null` if no data in this format can be found.</span></span>  
  
 <span data-ttu-id="9dccb-223">若要确定数据是与格式关联还是可转换为格式, 请在调用<xref:System.Windows.Forms.DataObject.GetDataPresent%2A> <xref:System.Windows.Forms.DataObject.GetData%2A>前调用。</span><span class="sxs-lookup"><span data-stu-id="9dccb-223">To determine whether data is associated with, or can be converted to, a format, call <xref:System.Windows.Forms.DataObject.GetDataPresent%2A> before calling <xref:System.Windows.Forms.DataObject.GetData%2A>.</span></span> <span data-ttu-id="9dccb-224">调用<xref:System.Windows.Forms.DataObject.GetFormats%2A>以获取此<xref:System.Windows.Forms.DataObject>中存储的数据的有效格式列表。</span><span class="sxs-lookup"><span data-stu-id="9dccb-224">Call <xref:System.Windows.Forms.DataObject.GetFormats%2A> for a list of valid formats for the data stored in this <xref:System.Windows.Forms.DataObject>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="9dccb-225">如果数据已存储, 则可以将其转换为另一种格式, 这种格式指定允许该转换, 并且请求的格式与存储格式兼容。</span><span class="sxs-lookup"><span data-stu-id="9dccb-225">Data can be converted to another format if it was stored specifying that conversion is allowed, and if the requested format is compatible with the stored format.</span></span> <span data-ttu-id="9dccb-226">例如, 以 Unicode 形式存储的数据可以转换为文本。</span><span class="sxs-lookup"><span data-stu-id="9dccb-226">For example, data stored as Unicode can be converted to text.</span></span>  
>   
>  <span data-ttu-id="9dccb-227">当`format` 为<xref:System.Windows.Forms.DataFormats.Html>时, 此方法将在以 .net 4.5 或更高版本为目标的应用程序中返回 utf-8 编码的字符串, 并在面向 .net 4.0 或更低版本的应用程序中返回 ANSI 编码的字符串。</span><span class="sxs-lookup"><span data-stu-id="9dccb-227">When `format` is <xref:System.Windows.Forms.DataFormats.Html>, this method returns a UTF-8 encoded string in applications that target .NET 4.5 or higher, and an ANSI encoded string in applications that target .NET 4.0 or lower.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9dccb-228">下面的代码示例<xref:System.Windows.Forms.DataObject> `autoConvert`使用参数指定是否转换数据格式, 从而检索中存储的数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-228">The following code example retrieves the data stored in a <xref:System.Windows.Forms.DataObject>, using the `autoConvert` parameter to specify whether to convert the data format.</span></span>  
  
 <span data-ttu-id="9dccb-229">首先, 使用文本<xref:System.Windows.Forms.DataObject>数据创建新的。</span><span class="sxs-lookup"><span data-stu-id="9dccb-229">First, a new <xref:System.Windows.Forms.DataObject> is created with text data.</span></span> <span data-ttu-id="9dccb-230">然后, 该示例尝试检索数据, 并将其格式指定为字符串而不进行格式转换, 也就是说, `autoConvert`参数是。 `false`</span><span class="sxs-lookup"><span data-stu-id="9dccb-230">Then the example tries to retrieve the data, specifying its format as a string and no format conversion, that is, the `autoConvert` parameter is `false`.</span></span> <span data-ttu-id="9dccb-231">此操作失败, 因为中<xref:System.Windows.Forms.DataObject>没有字符串数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-231">This operation fails because there is no string data in the <xref:System.Windows.Forms.DataObject>.</span></span>  
  
 <span data-ttu-id="9dccb-232">接下来, 该示例尝试再次检索数据, 并`autoConvert`将参数设置为。 `true`</span><span class="sxs-lookup"><span data-stu-id="9dccb-232">Next, the example tries to retrieve the data again, with the `autoConvert` parameter set to `true`.</span></span> <span data-ttu-id="9dccb-233">此操作成功, 结果显示在中<xref:System.Windows.Forms.MessageBox>。</span><span class="sxs-lookup"><span data-stu-id="9dccb-233">This operation succeeds and the results are displayed in a <xref:System.Windows.Forms.MessageBox>.</span></span>  
  
 <span data-ttu-id="9dccb-234">此代码需要已`textBox1`创建的。</span><span class="sxs-lookup"><span data-stu-id="9dccb-234">This code requires that `textBox1` has been created.</span></span>  
  
 [!code-cpp[Classic DataObject.GetData Example#1](~/samples/snippets/cpp/VS_Snippets_Winforms/Classic DataObject.GetData Example/CPP/source.cpp#1)]
 [!code-csharp[Classic DataObject.GetData Example#1](~/samples/snippets/csharp/VS_Snippets_Winforms/Classic DataObject.GetData Example/CS/source.cs#1)]
 [!code-vb[Classic DataObject.GetData Example#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/Classic DataObject.GetData Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Windows.Forms.DataObject.SetData(System.String,System.Boolean,System.Object)" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetDataPresent(System.Type)" />
        <altmember cref="T:System.Windows.Forms.DataFormats" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetFormats(System.Boolean)" />
      </Docs>
    </Member>
    <MemberGroup MemberName="GetDataPresent">
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="9dccb-235">确定此 <see cref="T:System.Windows.Forms.DataObject" /> 中存储的数据是否与指定的格式关联。</span><span class="sxs-lookup"><span data-stu-id="9dccb-235">Determines whether data stored in this <see cref="T:System.Windows.Forms.DataObject" /> is associated with the specified format.</span></span></summary>
        <altmember cref="M:System.Windows.Forms.DataObject.SetData(System.String,System.Boolean,System.Object)" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetData(System.String,System.Boolean)" />
        <altmember cref="T:System.Windows.Forms.DataFormats" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetFormats(System.Boolean)" />
      </Docs>
    </MemberGroup>
    <Member MemberName="GetDataPresent">
      <MemberSignature Language="C#" Value="public virtual bool GetDataPresent (string format);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance bool GetDataPresent(string format) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.GetDataPresent(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Function GetDataPresent (format As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual bool GetDataPresent(System::String ^ format);" />
      <MemberSignature Language="F#" Value="abstract member GetDataPresent : string -&gt; bool&#xA;override this.GetDataPresent : string -&gt; bool" Usage="dataObject.GetDataPresent format" />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.Windows.Forms.IDataObject.GetDataPresent(System.String)</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="format" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="format"><span data-ttu-id="9dccb-236">要检查的格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-236">The format to check for.</span></span> <span data-ttu-id="9dccb-237">请参见 <see cref="T:System.Windows.Forms.DataFormats" /> 以获取预定义的格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-237">See <see cref="T:System.Windows.Forms.DataFormats" /> for predefined formats.</span></span></param>
        <summary><span data-ttu-id="9dccb-238">确定此 <see cref="T:System.Windows.Forms.DataObject" /> 中存储的数据是否与指定的格式关联，或是否可以转换成指定的格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-238">Determines whether data stored in this <see cref="T:System.Windows.Forms.DataObject" /> is associated with, or can be converted to, the specified format.</span></span></summary>
        <returns><span data-ttu-id="9dccb-239">如果此 <see cref="T:System.Windows.Forms.DataObject" /> 中存储的数据与指定的格式关联，或者可以转换成指定的格式，则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="9dccb-239"><see langword="true" /> if data stored in this <see cref="T:System.Windows.Forms.DataObject" /> is associated with, or can be converted to, the specified format; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9dccb-240">调用此方法以确定在调用<xref:System.Windows.Forms.DataObject.GetData%2A>之前是否存在格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-240">Call this method to determine whether a format exists before calling <xref:System.Windows.Forms.DataObject.GetData%2A>.</span></span> <span data-ttu-id="9dccb-241">调用<xref:System.Windows.Forms.DataObject.GetFormats%2A> 此<xref:System.Windows.Forms.DataObject>中可用的格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-241">Call <xref:System.Windows.Forms.DataObject.GetFormats%2A> for the formats that are available in this <xref:System.Windows.Forms.DataObject>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="9dccb-242">如果数据已存储, 则可以将其转换为另一种格式, 这种格式指定允许该转换, 并且请求的格式与存储格式兼容。</span><span class="sxs-lookup"><span data-stu-id="9dccb-242">Data can be converted to another format if it was stored specifying that conversion is allowed, and if the requested format is compatible with the stored format.</span></span> <span data-ttu-id="9dccb-243">例如, 以 Unicode 形式存储的数据可以转换为文本。</span><span class="sxs-lookup"><span data-stu-id="9dccb-243">For example, data stored as Unicode can be converted to text.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="9dccb-244">如果无法检索任何数据, 则不会引发异常。</span><span class="sxs-lookup"><span data-stu-id="9dccb-244">If no data can be retrieved, no exception will be thrown.</span></span> <span data-ttu-id="9dccb-245">相反, `false`将返回。</span><span class="sxs-lookup"><span data-stu-id="9dccb-245">Instead, `false` will be returned.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9dccb-246">下面的代码示例确定当前存储在此<xref:System.Windows.Forms.DataObject>中的数据是与指定格式关联还是可转换为指定格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-246">The following code example determines whether data currently stored in this <xref:System.Windows.Forms.DataObject> is associated with, or can be converted to, a specified format.</span></span> <span data-ttu-id="9dccb-247">使用字符串<xref:System.Windows.Forms.DataObject>和指定为文本的关联格式来初始化新的。</span><span class="sxs-lookup"><span data-stu-id="9dccb-247">A new <xref:System.Windows.Forms.DataObject> is initialized with a string and its associated format specified as text.</span></span>  
  
 <span data-ttu-id="9dccb-248">然后, 示例输出中<xref:System.Windows.Forms.DataObject>是否存在文本数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-248">Then the examples prints whether text data exists in the <xref:System.Windows.Forms.DataObject>.</span></span> <span data-ttu-id="9dccb-249">此代码需要已`textBox1`创建的。</span><span class="sxs-lookup"><span data-stu-id="9dccb-249">This code requires that `textBox1` has been created.</span></span>  
  
  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Windows.Forms.DataObject.SetData(System.String,System.Boolean,System.Object)" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetData(System.String,System.Boolean)" />
        <altmember cref="T:System.Windows.Forms.DataFormats" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetFormats(System.Boolean)" />
      </Docs>
    </Member>
    <Member MemberName="GetDataPresent">
      <MemberSignature Language="C#" Value="public virtual bool GetDataPresent (Type format);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance bool GetDataPresent(class System.Type format) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.GetDataPresent(System.Type)" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Function GetDataPresent (format As Type) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual bool GetDataPresent(Type ^ format);" />
      <MemberSignature Language="F#" Value="abstract member GetDataPresent : Type -&gt; bool&#xA;override this.GetDataPresent : Type -&gt; bool" Usage="dataObject.GetDataPresent format" />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.Windows.Forms.IDataObject.GetDataPresent(System.Type)</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="format" Type="System.Type" />
      </Parameters>
      <Docs>
        <param name="format"><span data-ttu-id="9dccb-250">表示要检查的格式的 <see cref="T:System.Type" />。</span><span class="sxs-lookup"><span data-stu-id="9dccb-250">A <see cref="T:System.Type" /> representing the format to check for.</span></span></param>
        <summary><span data-ttu-id="9dccb-251">确定此 <see cref="T:System.Windows.Forms.DataObject" /> 中存储的数据是否与指定的格式关联，或是否可以转换成指定的格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-251">Determines whether data stored in this <see cref="T:System.Windows.Forms.DataObject" /> is associated with, or can be converted to, the specified format.</span></span></summary>
        <returns><span data-ttu-id="9dccb-252">如果此 <see cref="T:System.Windows.Forms.DataObject" /> 中存储的数据与指定的格式关联，或者可以转换成指定的格式，则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="9dccb-252"><see langword="true" /> if data stored in this <see cref="T:System.Windows.Forms.DataObject" /> is associated with, or can be converted to, the specified format; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9dccb-253">调用此方法以确定在调用<xref:System.Windows.Forms.DataObject.GetData%2A>之前是否存在格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-253">Call this method to determine whether a format exists before calling <xref:System.Windows.Forms.DataObject.GetData%2A>.</span></span> <span data-ttu-id="9dccb-254">调用<xref:System.Windows.Forms.DataObject.GetFormats%2A> 此<xref:System.Windows.Forms.DataObject>中可用的格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-254">Call <xref:System.Windows.Forms.DataObject.GetFormats%2A> for the formats that are available in this <xref:System.Windows.Forms.DataObject>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="9dccb-255">如果数据已存储, 则可以将其转换为另一种格式, 这种格式指定允许该转换, 并且请求的格式与存储格式兼容。</span><span class="sxs-lookup"><span data-stu-id="9dccb-255">Data can be converted to another format if it was stored specifying that conversion is allowed, and if the requested format is compatible with the stored format.</span></span> <span data-ttu-id="9dccb-256">例如, 以 Unicode 形式存储的数据可以转换为文本。</span><span class="sxs-lookup"><span data-stu-id="9dccb-256">For example, data stored as Unicode can be converted to text.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="9dccb-257">如果无法检索任何数据, 则不会引发异常。</span><span class="sxs-lookup"><span data-stu-id="9dccb-257">If no data can be retrieved, no exception will be thrown.</span></span> <span data-ttu-id="9dccb-258">相反, `false`将返回。</span><span class="sxs-lookup"><span data-stu-id="9dccb-258">Instead, `false` will be returned.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9dccb-259">下面的代码示例确定中<xref:System.Windows.Forms.DataObject>是否存在指定类型的数据, 或者数据是否可以转换为指定的类型。</span><span class="sxs-lookup"><span data-stu-id="9dccb-259">The following code example determines whether data of the specified type exists in a <xref:System.Windows.Forms.DataObject>, or whether the data can be converted to the specified type.</span></span> <span data-ttu-id="9dccb-260">结果将显示在文本框中。</span><span class="sxs-lookup"><span data-stu-id="9dccb-260">The result is displayed in a text box.</span></span> <span data-ttu-id="9dccb-261">代码需要已创建`textBox1`的。</span><span class="sxs-lookup"><span data-stu-id="9dccb-261">The code requires that `textBox1` has been created.</span></span>  
  
 [!code-cpp[Classic DataObject.GetDataPresent Example#1](~/samples/snippets/cpp/VS_Snippets_Winforms/Classic DataObject.GetDataPresent Example/CPP/source.cpp#1)]
 [!code-csharp[Classic DataObject.GetDataPresent Example#1](~/samples/snippets/csharp/VS_Snippets_Winforms/Classic DataObject.GetDataPresent Example/CS/source.cs#1)]
 [!code-vb[Classic DataObject.GetDataPresent Example#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/Classic DataObject.GetDataPresent Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Windows.Forms.DataObject.SetData(System.String,System.Boolean,System.Object)" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetData(System.String,System.Boolean)" />
        <altmember cref="T:System.Type" />
        <altmember cref="T:System.Windows.Forms.DataFormats" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetFormats(System.Boolean)" />
      </Docs>
    </Member>
    <Member MemberName="GetDataPresent">
      <MemberSignature Language="C#" Value="public virtual bool GetDataPresent (string format, bool autoConvert);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance bool GetDataPresent(string format, bool autoConvert) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.GetDataPresent(System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Function GetDataPresent (format As String, autoConvert As Boolean) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual bool GetDataPresent(System::String ^ format, bool autoConvert);" />
      <MemberSignature Language="F#" Value="abstract member GetDataPresent : string * bool -&gt; bool&#xA;override this.GetDataPresent : string * bool -&gt; bool" Usage="dataObject.GetDataPresent (format, autoConvert)" />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.Windows.Forms.IDataObject.GetDataPresent(System.String,System.Boolean)</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="format" Type="System.String" />
        <Parameter Name="autoConvert" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="format"><span data-ttu-id="9dccb-262">要检查的格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-262">The format to check for.</span></span> <span data-ttu-id="9dccb-263">请参见 <see cref="T:System.Windows.Forms.DataFormats" /> 以获取预定义的格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-263">See <see cref="T:System.Windows.Forms.DataFormats" /> for predefined formats.</span></span></param>
        <param name="autoConvert"><span data-ttu-id="9dccb-264">值为 <see langword="true" /> 时，确定此 <see cref="T:System.Windows.Forms.DataObject" /> 中存储的数据是否可以转换成指定的格式；值为 <see langword="false" /> 时，检查数据的格式是否为指定的格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-264"><see langword="true" /> to determine whether data stored in this <see cref="T:System.Windows.Forms.DataObject" /> can be converted to the specified format; <see langword="false" /> to check whether the data is in the specified format.</span></span></param>
        <summary><span data-ttu-id="9dccb-265">确定此 <see cref="T:System.Windows.Forms.DataObject" /> 是否包含指定格式的数据，或者是否包含可以转换为指定格式的数据，后者可选。</span><span class="sxs-lookup"><span data-stu-id="9dccb-265">Determines whether this <see cref="T:System.Windows.Forms.DataObject" /> contains data in the specified format or, optionally, contains data that can be converted to the specified format.</span></span></summary>
        <returns><span data-ttu-id="9dccb-266">如果数据采用指定的格式，或者可以转换成指定的格式，则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="9dccb-266"><see langword="true" /> if the data is in, or can be converted to, the specified format; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9dccb-267">调用此方法以确定在调用<xref:System.Windows.Forms.DataObject.GetData%2A>之前是否存在格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-267">Call this method to determine whether a format exists before calling <xref:System.Windows.Forms.DataObject.GetData%2A>.</span></span> <span data-ttu-id="9dccb-268">调用<xref:System.Windows.Forms.DataObject.GetFormats%2A> 此<xref:System.Windows.Forms.DataObject>中可用的格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-268">Call <xref:System.Windows.Forms.DataObject.GetFormats%2A> for the formats that are available in this <xref:System.Windows.Forms.DataObject>.</span></span>  
  
 <span data-ttu-id="9dccb-269">此方法在`true`以下情况下返回:</span><span class="sxs-lookup"><span data-stu-id="9dccb-269">This method returns `true` when:</span></span>  
  
-   <span data-ttu-id="9dccb-270">`autoConvert`参数为`true` , 数据的格式可以转换为适当的格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-270">The `autoConvert` parameter is `true` and the data is in a format that can be converted to the appropriate format.</span></span>  
  
-   <span data-ttu-id="9dccb-271">`autoConvert`参数为`false` , 数据采用适当的格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-271">The `autoConvert` parameter is `false` and the data is in the appropriate format.</span></span>  
  
 <span data-ttu-id="9dccb-272">此方法在`false`以下情况下返回:</span><span class="sxs-lookup"><span data-stu-id="9dccb-272">This method returns `false` when:</span></span>  
  
-   <span data-ttu-id="9dccb-273">参数为, `true`并且此方法无法找到具有指定格式的数据, 并且它不能将数据转换为指定格式, 也不能将数据存储在自动转换`false`设置为的情况下。 `autoConvert`</span><span class="sxs-lookup"><span data-stu-id="9dccb-273">The `autoConvert` parameter is `true` and this method cannot find data in the specified format, and it cannot convert data to the specified format, or the data was stored with automatic conversion set to `false`.</span></span>  
  
-   <span data-ttu-id="9dccb-274">参数为`false` , 并且数据在指定的格式中不存在于中<xref:System.Windows.Forms.DataObject>。 `autoConvert`</span><span class="sxs-lookup"><span data-stu-id="9dccb-274">The `autoConvert` parameter is `false` and data does not exist in this <xref:System.Windows.Forms.DataObject> in the specified format.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="9dccb-275">如果数据已存储, 则可以将其转换为另一种格式, 这种格式指定允许该转换, 并且请求的格式与存储格式兼容。</span><span class="sxs-lookup"><span data-stu-id="9dccb-275">Data can be converted to another format if it was stored specifying that conversion is allowed and if the requested format is compatible with the stored format.</span></span> <span data-ttu-id="9dccb-276">例如, 以 Unicode 形式存储的数据可以转换为文本。</span><span class="sxs-lookup"><span data-stu-id="9dccb-276">For example, data stored as Unicode can be converted to text.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="9dccb-277">如果无法检索任何数据, 则不会引发异常。</span><span class="sxs-lookup"><span data-stu-id="9dccb-277">If no data can be retrieved, no exception will be thrown.</span></span> <span data-ttu-id="9dccb-278">相反, `false`将返回。</span><span class="sxs-lookup"><span data-stu-id="9dccb-278">Instead, `false` will be returned.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9dccb-279">下面的代码示例确定当前存储在中的<xref:System.Windows.Forms.DataObject>数据是否与指定的格式关联。</span><span class="sxs-lookup"><span data-stu-id="9dccb-279">The following code example determines whether data currently stored in the <xref:System.Windows.Forms.DataObject> is associated with a specified format.</span></span> <span data-ttu-id="9dccb-280">首先, 使用字符串<xref:System.Windows.Forms.DataObject>来初始化新的, 并将其格式指定为文本。</span><span class="sxs-lookup"><span data-stu-id="9dccb-280">First, a new <xref:System.Windows.Forms.DataObject> is initialized with a string, specifying its format as text.</span></span>  
  
 <span data-ttu-id="9dccb-281">然后, `autoConvert` `false`将查询与文本格式关联的数据, 并将参数指定为。 <xref:System.Windows.Forms.DataObject></span><span class="sxs-lookup"><span data-stu-id="9dccb-281">Then the <xref:System.Windows.Forms.DataObject> is queried for data associated with the text format, specifying the `autoConvert` parameter as `false`.</span></span> <span data-ttu-id="9dccb-282">此查询的结果将打印在文本框中。</span><span class="sxs-lookup"><span data-stu-id="9dccb-282">The result of this query is printed in a text box.</span></span>  
  
 <span data-ttu-id="9dccb-283">然后, `autoConvert` `true`将查询与字符串格式关联的数据, 并将参数指定为。 <xref:System.Windows.Forms.DataObject></span><span class="sxs-lookup"><span data-stu-id="9dccb-283">Then the <xref:System.Windows.Forms.DataObject> is queried for data associated with string format, specifying the `autoConvert` parameter as `true`.</span></span> <span data-ttu-id="9dccb-284">结果将打印在文本框中。</span><span class="sxs-lookup"><span data-stu-id="9dccb-284">The results are printed in the text box.</span></span> <span data-ttu-id="9dccb-285">此代码需要已`textBox1`创建的。</span><span class="sxs-lookup"><span data-stu-id="9dccb-285">This code requires that `textBox1` has been created.</span></span>  
  
 [!code-cpp[Classic DataObject.GetDataPresent1 Example#1](~/samples/snippets/cpp/VS_Snippets_Winforms/Classic DataObject.GetDataPresent1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic DataObject.GetDataPresent1 Example#1](~/samples/snippets/csharp/VS_Snippets_Winforms/Classic DataObject.GetDataPresent1 Example/CS/source.cs#1)]
 [!code-vb[Classic DataObject.GetDataPresent1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/Classic DataObject.GetDataPresent1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Windows.Forms.DataObject.SetData(System.String,System.Boolean,System.Object)" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetData(System.String,System.Boolean)" />
        <altmember cref="T:System.Windows.Forms.DataFormats" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetFormats(System.Boolean)" />
      </Docs>
    </Member>
    <Member MemberName="GetFileDropList">
      <MemberSignature Language="C#" Value="public virtual System.Collections.Specialized.StringCollection GetFileDropList ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance class System.Collections.Specialized.StringCollection GetFileDropList() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.GetFileDropList" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Function GetFileDropList () As StringCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual System::Collections::Specialized::StringCollection ^ GetFileDropList();" />
      <MemberSignature Language="F#" Value="abstract member GetFileDropList : unit -&gt; System.Collections.Specialized.StringCollection&#xA;override this.GetFileDropList : unit -&gt; System.Collections.Specialized.StringCollection" Usage="dataObject.GetFileDropList " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Collections.Specialized.StringCollection</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="9dccb-286">检索此数据对象中文件名的集合。</span><span class="sxs-lookup"><span data-stu-id="9dccb-286">Retrieves a collection of file names from the data object.</span></span></summary>
        <returns><span data-ttu-id="9dccb-287">为包含文件名的 <see cref="T:System.Collections.Specialized.StringCollection" />，如果此数据对象不包含任何 <see cref="F:System.Windows.Forms.DataFormats.FileDrop" /> 格式的数据，或者不包含任何可以转换为该格式的数据，则为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="9dccb-287">A <see cref="T:System.Collections.Specialized.StringCollection" /> containing file names or <see langword="null" /> if the data object does not contain any data that is in the <see cref="F:System.Windows.Forms.DataFormats.FileDrop" /> format or can be converted to that format.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9dccb-288">文件放置列表是包含文件的路径信息的字符串的集合。</span><span class="sxs-lookup"><span data-stu-id="9dccb-288">A file drop list is a collection of strings containing path information for files.</span></span>  
  
 <span data-ttu-id="9dccb-289">文件放置列表以<xref:System.String>数组的形式存储在数据对象中。</span><span class="sxs-lookup"><span data-stu-id="9dccb-289">A file drop list is stored in a data object as a <xref:System.String> array.</span></span> <span data-ttu-id="9dccb-290">此方法将此数组转换为<xref:System.Collections.Specialized.StringCollection>并返回集合。</span><span class="sxs-lookup"><span data-stu-id="9dccb-290">This method converts this array to a <xref:System.Collections.Specialized.StringCollection> and returns the collection.</span></span>  
  
 <span data-ttu-id="9dccb-291"><xref:System.Windows.Forms.DataObject.ContainsFileDropList%2A>使用方法在使用此方法检索数据对象之前, 确定该数据对象是否包含文件放置列表。</span><span class="sxs-lookup"><span data-stu-id="9dccb-291">Use the <xref:System.Windows.Forms.DataObject.ContainsFileDropList%2A> method to determine whether the data object contains a file drop list before retrieving it with this method.</span></span>  
  
 <span data-ttu-id="9dccb-292"><xref:System.Windows.Forms.DataObject.SetFileDropList%2A>使用方法可向数据对象添加文件放置列表。</span><span class="sxs-lookup"><span data-stu-id="9dccb-292">Use the <xref:System.Windows.Forms.DataObject.SetFileDropList%2A> method to add a file drop list to the data object.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Collections.Specialized.StringCollection" />
        <altmember cref="F:System.Windows.Forms.DataFormats.FileDrop" />
        <altmember cref="M:System.Windows.Forms.DataObject.ContainsFileDropList" />
        <altmember cref="M:System.Windows.Forms.DataObject.SetFileDropList(System.Collections.Specialized.StringCollection)" />
      </Docs>
    </Member>
    <MemberGroup MemberName="GetFormats">
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="9dccb-293">返回存储在此 <see cref="T:System.Windows.Forms.DataObject" /> 中的数据所关联的或可以转换为的所有格式的列表。</span><span class="sxs-lookup"><span data-stu-id="9dccb-293">Returns a list of all formats that data stored in this <see cref="T:System.Windows.Forms.DataObject" /> is associated with or can be converted to.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="GetFormats">
      <MemberSignature Language="C#" Value="public virtual string[] GetFormats ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance string[] GetFormats() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.GetFormats" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Function GetFormats () As String()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual cli::array &lt;System::String ^&gt; ^ GetFormats();" />
      <MemberSignature Language="F#" Value="abstract member GetFormats : unit -&gt; string[]&#xA;override this.GetFormats : unit -&gt; string[]" Usage="dataObject.GetFormats " />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.Windows.Forms.IDataObject.GetFormats</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String[]</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="9dccb-294">返回存储在此 <see cref="T:System.Windows.Forms.DataObject" /> 中的数据所关联的或可以转换为的所有格式的列表。</span><span class="sxs-lookup"><span data-stu-id="9dccb-294">Returns a list of all formats that data stored in this <see cref="T:System.Windows.Forms.DataObject" /> is associated with or can be converted to.</span></span></summary>
        <returns><span data-ttu-id="9dccb-295">一个类型为 <see cref="T:System.String" /> 的数组，它包含所有格式的列表，并且这些格式受存储在此对象中的数据支持。</span><span class="sxs-lookup"><span data-stu-id="9dccb-295">An array of type <see cref="T:System.String" />, containing a list of all formats that are supported by the data stored in this object.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9dccb-296">调用此方法可在调用<xref:System.Windows.Forms.DataObject.GetData%2A>之前获取受支持的数据格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-296">Call this method to get the supported data formats before calling <xref:System.Windows.Forms.DataObject.GetData%2A>.</span></span> <span data-ttu-id="9dccb-297">有关<xref:System.Windows.Forms.DataFormats>预定义格式, 请参阅。</span><span class="sxs-lookup"><span data-stu-id="9dccb-297">See <xref:System.Windows.Forms.DataFormats> for the predefined formats.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="9dccb-298">如果数据已存储, 则可以将其转换为另一种格式, 这种格式指定允许该转换, 并且请求的格式与存储格式兼容。</span><span class="sxs-lookup"><span data-stu-id="9dccb-298">Data can be converted to another format if it was stored specifying that conversion is allowed and if the requested format is compatible with the stored format.</span></span> <span data-ttu-id="9dccb-299">例如, 以 Unicode 形式存储的数据可以转换为文本。</span><span class="sxs-lookup"><span data-stu-id="9dccb-299">For example, data stored as Unicode can be converted to text.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9dccb-300">下面的代码示例将查询<xref:System.Windows.Forms.DataObject>与数据关联的格式, 以及数据可以转换为的格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-300">The following code example queries a <xref:System.Windows.Forms.DataObject> for the formats associated with its data, and the formats that the data can be converted to.</span></span> <span data-ttu-id="9dccb-301">生成的列表显示在文本框中。</span><span class="sxs-lookup"><span data-stu-id="9dccb-301">The resulting list is displayed in a text box.</span></span> <span data-ttu-id="9dccb-302">此代码需要已`textBox1`创建的。</span><span class="sxs-lookup"><span data-stu-id="9dccb-302">This code requires that `textBox1` has been created.</span></span>  
  
 [!code-cpp[Classic DataObject.GetFormats1 Example#1](~/samples/snippets/cpp/VS_Snippets_Winforms/Classic DataObject.GetFormats1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic DataObject.GetFormats1 Example#1](~/samples/snippets/csharp/VS_Snippets_Winforms/Classic DataObject.GetFormats1 Example/CS/source.cs#1)]
 [!code-vb[Classic DataObject.GetFormats1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/Classic DataObject.GetFormats1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Windows.Forms.DataObject.GetData(System.String,System.Boolean)" />
        <altmember cref="M:System.Windows.Forms.DataObject.SetData(System.String,System.Boolean,System.Object)" />
        <altmember cref="T:System.Windows.Forms.DataFormats" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetDataPresent(System.Type)" />
      </Docs>
    </Member>
    <Member MemberName="GetFormats">
      <MemberSignature Language="C#" Value="public virtual string[] GetFormats (bool autoConvert);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance string[] GetFormats(bool autoConvert) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.GetFormats(System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Function GetFormats (autoConvert As Boolean) As String()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual cli::array &lt;System::String ^&gt; ^ GetFormats(bool autoConvert);" />
      <MemberSignature Language="F#" Value="abstract member GetFormats : bool -&gt; string[]&#xA;override this.GetFormats : bool -&gt; string[]" Usage="dataObject.GetFormats autoConvert" />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.Windows.Forms.IDataObject.GetFormats(System.Boolean)</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="autoConvert" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="autoConvert"><span data-ttu-id="9dccb-303">值为 <see langword="true" /> 时，检索存储在此 <see cref="T:System.Windows.Forms.DataObject" /> 中的数据所关联的或可以转换成的所有格式；值为 <see langword="false" /> 时，仅检索本机数据格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-303"><see langword="true" /> to retrieve all formats that data stored in this <see cref="T:System.Windows.Forms.DataObject" /> is associated with, or can be converted to; <see langword="false" /> to retrieve only native data formats.</span></span></param>
        <summary><span data-ttu-id="9dccb-304">返回存储在此 <see cref="T:System.Windows.Forms.DataObject" /> 中的数据所关联的或可以转换为的所有格式的列表，同时使用自动转换参数来确定是只检索本机数据格式，还是检索此数据可以转换为的所有格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-304">Returns a list of all formats that data stored in this <see cref="T:System.Windows.Forms.DataObject" /> is associated with or can be converted to, using an automatic conversion parameter to determine whether to retrieve only native data formats or all formats that the data can be converted to.</span></span></summary>
        <returns><span data-ttu-id="9dccb-305">一个类型为 <see cref="T:System.String" /> 的数组，它包含所有格式的列表，并且这些格式受存储在此对象中的数据支持。</span><span class="sxs-lookup"><span data-stu-id="9dccb-305">An array of type <see cref="T:System.String" />, containing a list of all formats that are supported by the data stored in this object.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9dccb-306">调用此方法可在调用<xref:System.Windows.Forms.DataObject.GetData%2A>之前获取受支持的数据格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-306">Call this method to get the supported data formats before calling <xref:System.Windows.Forms.DataObject.GetData%2A>.</span></span> <span data-ttu-id="9dccb-307">有关<xref:System.Windows.Forms.DataFormats>预定义格式, 请参阅。</span><span class="sxs-lookup"><span data-stu-id="9dccb-307">See <xref:System.Windows.Forms.DataFormats> for the predefined formats.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="9dccb-308">如果数据已存储, 则可以将其转换为另一种格式, 这种格式指定允许该转换, 并且请求的格式与存储格式兼容。</span><span class="sxs-lookup"><span data-stu-id="9dccb-308">Data can be converted to another format if it was stored specifying that conversion is allowed and if the requested format is compatible with the stored format.</span></span> <span data-ttu-id="9dccb-309">例如, 以 Unicode 形式存储的数据可以转换为文本。</span><span class="sxs-lookup"><span data-stu-id="9dccb-309">For example, data stored as Unicode can be converted to text.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9dccb-310">下面的代码示例将查询<xref:System.Windows.Forms.DataObject>与数据关联的格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-310">The following code example queries a <xref:System.Windows.Forms.DataObject> for the formats associated with its data.</span></span> <span data-ttu-id="9dccb-311">第一个查询将`autoConvert`参数指定为`false`, 因此只返回数据的本机格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-311">The first query specifies the `autoConvert` parameter as `false`, so only the native format of the data is returned.</span></span> <span data-ttu-id="9dccb-312">第二个查询将`autoConvert`参数指定`true`为, 因此格式列表包括数据可以转换为的格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-312">The second query specifies the `autoConvert` parameter as `true`, so the list of formats includes the formats that the data can be converted to.</span></span>  
  
 <span data-ttu-id="9dccb-313">此代码需要已`textBox1`创建的。</span><span class="sxs-lookup"><span data-stu-id="9dccb-313">This code requires that `textBox1` has been created.</span></span>  
  
 [!code-cpp[Classic DataObject.GetFormats Example#1](~/samples/snippets/cpp/VS_Snippets_Winforms/Classic DataObject.GetFormats Example/CPP/source.cpp#1)]
 [!code-csharp[Classic DataObject.GetFormats Example#1](~/samples/snippets/csharp/VS_Snippets_Winforms/Classic DataObject.GetFormats Example/CS/source.cs#1)]
 [!code-vb[Classic DataObject.GetFormats Example#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/Classic DataObject.GetFormats Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Windows.Forms.DataObject.GetData(System.String,System.Boolean)" />
        <altmember cref="M:System.Windows.Forms.DataObject.SetData(System.String,System.Boolean,System.Object)" />
        <altmember cref="T:System.Windows.Forms.DataFormats" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetDataPresent(System.Type)" />
      </Docs>
    </Member>
    <Member MemberName="GetImage">
      <MemberSignature Language="C#" Value="public virtual System.Drawing.Image GetImage ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance class System.Drawing.Image GetImage() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.GetImage" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Function GetImage () As Image" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual System::Drawing::Image ^ GetImage();" />
      <MemberSignature Language="F#" Value="abstract member GetImage : unit -&gt; System.Drawing.Image&#xA;override this.GetImage : unit -&gt; System.Drawing.Image" Usage="dataObject.GetImage " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Drawing.Image</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="9dccb-314">检索此数据对象中的图像。</span><span class="sxs-lookup"><span data-stu-id="9dccb-314">Retrieves an image from the data object.</span></span></summary>
        <returns><span data-ttu-id="9dccb-315">为表示此数据对象中图像数据的 <see cref="T:System.Drawing.Image" />，如果此数据对象不包含任何 <see cref="F:System.Windows.Forms.DataFormats.Bitmap" /> 格式的数据，或者不包含任何可转换为该格式的数据，则为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="9dccb-315">An <see cref="T:System.Drawing.Image" /> representing the image data in the data object or <see langword="null" /> if the data object does not contain any data that is in the <see cref="F:System.Windows.Forms.DataFormats.Bitmap" /> format or can be converted to that format.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9dccb-316"><xref:System.Windows.Forms.DataObject.ContainsImage%2A>使用方法在使用此方法检索数据对象之前, 确定该数据对象是否包含图像数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-316">Use the <xref:System.Windows.Forms.DataObject.ContainsImage%2A> method to determine whether the data object contains image data before retrieving it with this method.</span></span>  
  
 <span data-ttu-id="9dccb-317"><xref:System.Windows.Forms.DataObject.SetImage%2A>使用方法将图像数据添加到数据对象。</span><span class="sxs-lookup"><span data-stu-id="9dccb-317">Use the <xref:System.Windows.Forms.DataObject.SetImage%2A> method to add image data to the data object.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Drawing.Image" />
        <altmember cref="F:System.Windows.Forms.DataFormats.Bitmap" />
        <altmember cref="M:System.Windows.Forms.DataObject.ContainsImage" />
        <altmember cref="M:System.Windows.Forms.DataObject.SetImage(System.Drawing.Image)" />
      </Docs>
    </Member>
    <MemberGroup MemberName="GetText">
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="9dccb-318">检索此数据对象中的文本数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-318">Retrieves text data from the data object.</span></span></summary>
        <altmember cref="T:System.Windows.Forms.TextDataFormat" />
        <altmember cref="Overload:System.Windows.Forms.DataObject.ContainsText" />
        <altmember cref="Overload:System.Windows.Forms.DataObject.SetText" />
      </Docs>
    </MemberGroup>
    <Member MemberName="GetText">
      <MemberSignature Language="C#" Value="public virtual string GetText ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance string GetText() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.GetText" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Function GetText () As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual System::String ^ GetText();" />
      <MemberSignature Language="F#" Value="abstract member GetText : unit -&gt; string&#xA;override this.GetText : unit -&gt; string" Usage="dataObject.GetText " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="9dccb-319">检索此数据对象中 <see cref="F:System.Windows.Forms.TextDataFormat.UnicodeText" /> 格式的文本数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-319">Retrieves text data from the data object in the <see cref="F:System.Windows.Forms.TextDataFormat.UnicodeText" /> format.</span></span></summary>
        <returns><span data-ttu-id="9dccb-320">为此数据对象中的文本数据，如果此数据对象不包含 <see cref="F:System.String.Empty" /> 格式的数据，则为 <see cref="F:System.Windows.Forms.TextDataFormat.UnicodeText" />。</span><span class="sxs-lookup"><span data-stu-id="9dccb-320">The text data in the data object or <see cref="F:System.String.Empty" /> if the data object does not contain data in the <see cref="F:System.Windows.Forms.TextDataFormat.UnicodeText" /> format.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9dccb-321"><xref:System.Windows.Forms.DataObject.ContainsText%2A>使用方法在使用此方法检索数据对象之前, 确定该数据对象是否包含文本数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-321">Use the <xref:System.Windows.Forms.DataObject.ContainsText%2A> method to determine whether the data object contains text data before retrieving it with this method.</span></span>  
  
 <span data-ttu-id="9dccb-322"><xref:System.Windows.Forms.DataObject.SetText%2A>使用方法可向数据对象添加文本数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-322">Use the <xref:System.Windows.Forms.DataObject.SetText%2A> method to add text data to the data object.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="F:System.Windows.Forms.TextDataFormat.UnicodeText" />
        <altmember cref="Overload:System.Windows.Forms.DataObject.ContainsText" />
        <altmember cref="Overload:System.Windows.Forms.DataObject.SetText" />
      </Docs>
    </Member>
    <Member MemberName="GetText">
      <MemberSignature Language="C#" Value="public virtual string GetText (System.Windows.Forms.TextDataFormat format);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance string GetText(valuetype System.Windows.Forms.TextDataFormat format) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.GetText(System.Windows.Forms.TextDataFormat)" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Function GetText (format As TextDataFormat) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual System::String ^ GetText(System::Windows::Forms::TextDataFormat format);" />
      <MemberSignature Language="F#" Value="abstract member GetText : System.Windows.Forms.TextDataFormat -&gt; string&#xA;override this.GetText : System.Windows.Forms.TextDataFormat -&gt; string" Usage="dataObject.GetText format" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="format" Type="System.Windows.Forms.TextDataFormat" Index="0" FrameworkAlternate="netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="format"><span data-ttu-id="9dccb-323"><see cref="T:System.Windows.Forms.TextDataFormat" /> 值之一。</span><span class="sxs-lookup"><span data-stu-id="9dccb-323">One of the <see cref="T:System.Windows.Forms.TextDataFormat" /> values.</span></span></param>
        <summary><span data-ttu-id="9dccb-324">检索此数据对象中由指定的 <see cref="T:System.Windows.Forms.TextDataFormat" /> 值表示的格式的文本数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-324">Retrieves text data from the data object in the format indicated by the specified <see cref="T:System.Windows.Forms.TextDataFormat" /> value.</span></span></summary>
        <returns><span data-ttu-id="9dccb-325">为此数据对象中的文本数据，如果此数据对象不包含指定格式的数据，则为 <see cref="F:System.String.Empty" />。</span><span class="sxs-lookup"><span data-stu-id="9dccb-325">The text data in the data object or <see cref="F:System.String.Empty" /> if the data object does not contain data in the specified format.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9dccb-326"><xref:System.Windows.Forms.DataObject.ContainsText%2A>使用方法在使用此方法检索数据对象之前, 确定该数据对象是否包含文本数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-326">Use the <xref:System.Windows.Forms.DataObject.ContainsText%2A> method to determine whether the data object contains text data before retrieving it with this method.</span></span>  
  
 <span data-ttu-id="9dccb-327"><xref:System.Windows.Forms.DataObject.SetText%2A>使用方法可向数据对象添加文本数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-327">Use the <xref:System.Windows.Forms.DataObject.SetText%2A> method to add text data to the data object.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="9dccb-328"><paramref name="format" /> 不是有效的 <see cref="T:System.Windows.Forms.TextDataFormat" /> 值。</span><span class="sxs-lookup"><span data-stu-id="9dccb-328"><paramref name="format" /> is not a valid <see cref="T:System.Windows.Forms.TextDataFormat" /> value.</span></span></exception>
        <altmember cref="T:System.Windows.Forms.TextDataFormat" />
        <altmember cref="Overload:System.Windows.Forms.DataObject.ContainsText" />
        <altmember cref="Overload:System.Windows.Forms.DataObject.SetText" />
      </Docs>
    </Member>
    <MemberGroup MemberName="SetAudio">
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="9dccb-329">将数据以 <see cref="F:System.Windows.Forms.DataFormats.WaveAudio" /> 格式添加到此数据对象。</span><span class="sxs-lookup"><span data-stu-id="9dccb-329">Adds data to the data object in the <see cref="F:System.Windows.Forms.DataFormats.WaveAudio" /> format.</span></span></summary>
        <altmember cref="F:System.Windows.Forms.DataFormats.WaveAudio" />
        <altmember cref="M:System.Windows.Forms.DataObject.ContainsAudio" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetAudioStream" />
      </Docs>
    </MemberGroup>
    <Member MemberName="SetAudio">
      <MemberSignature Language="C#" Value="public virtual void SetAudio (byte[] audioBytes);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance void SetAudio(unsigned int8[] audioBytes) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.SetAudio(System.Byte[])" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Sub SetAudio (audioBytes As Byte())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual void SetAudio(cli::array &lt;System::Byte&gt; ^ audioBytes);" />
      <MemberSignature Language="F#" Value="abstract member SetAudio : byte[] -&gt; unit&#xA;override this.SetAudio : byte[] -&gt; unit" Usage="dataObject.SetAudio audioBytes" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="audioBytes" Type="System.Byte[]" Index="0" FrameworkAlternate="netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="audioBytes"><span data-ttu-id="9dccb-330">包含音频数据的 <see cref="T:System.Byte" /> 数组。</span><span class="sxs-lookup"><span data-stu-id="9dccb-330">A <see cref="T:System.Byte" /> array containing the audio data.</span></span></param>
        <summary><span data-ttu-id="9dccb-331">在将 <see cref="T:System.Byte" /> 数组转换为 <see cref="F:System.Windows.Forms.DataFormats.WaveAudio" /> 之后，将其以 <see cref="T:System.IO.Stream" /> 格式添加到此数据对象。</span><span class="sxs-lookup"><span data-stu-id="9dccb-331">Adds a <see cref="T:System.Byte" /> array to the data object in the <see cref="F:System.Windows.Forms.DataFormats.WaveAudio" /> format after converting it to a <see cref="T:System.IO.Stream" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9dccb-332">若要从数据对象检索音频数据, 请先使用<xref:System.Windows.Forms.DataObject.ContainsAudio%2A>方法来确定数据对象是否包含音频数据, 然后再使用<xref:System.Windows.Forms.DataObject.GetAudioStream%2A>方法对其进行检索。</span><span class="sxs-lookup"><span data-stu-id="9dccb-332">To retrieve audio data from the data object, first use the <xref:System.Windows.Forms.DataObject.ContainsAudio%2A> method to determine whether the data object contains audio data before retrieving it with the <xref:System.Windows.Forms.DataObject.GetAudioStream%2A> method.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="9dccb-333"><paramref name="audioBytes" /> 为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="9dccb-333"><paramref name="audioBytes" /> is <see langword="null" />.</span></span></exception>
        <altmember cref="F:System.Windows.Forms.DataFormats.WaveAudio" />
        <altmember cref="M:System.Windows.Forms.DataObject.ContainsAudio" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetAudioStream" />
      </Docs>
    </Member>
    <Member MemberName="SetAudio">
      <MemberSignature Language="C#" Value="public virtual void SetAudio (System.IO.Stream audioStream);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance void SetAudio(class System.IO.Stream audioStream) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.SetAudio(System.IO.Stream)" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Sub SetAudio (audioStream As Stream)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual void SetAudio(System::IO::Stream ^ audioStream);" />
      <MemberSignature Language="F#" Value="abstract member SetAudio : System.IO.Stream -&gt; unit&#xA;override this.SetAudio : System.IO.Stream -&gt; unit" Usage="dataObject.SetAudio audioStream" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="audioStream" Type="System.IO.Stream" Index="0" FrameworkAlternate="netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="audioStream"><span data-ttu-id="9dccb-334">包含音频数据的 <see cref="T:System.IO.Stream" />。</span><span class="sxs-lookup"><span data-stu-id="9dccb-334">A <see cref="T:System.IO.Stream" /> containing the audio data.</span></span></param>
        <summary><span data-ttu-id="9dccb-335">将 <see cref="T:System.IO.Stream" /> 以 <see cref="F:System.Windows.Forms.DataFormats.WaveAudio" /> 格式添加到此数据对象。</span><span class="sxs-lookup"><span data-stu-id="9dccb-335">Adds a <see cref="T:System.IO.Stream" /> to the data object in the <see cref="F:System.Windows.Forms.DataFormats.WaveAudio" /> format.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9dccb-336">若要从数据对象检索音频数据, 请先使用<xref:System.Windows.Forms.DataObject.ContainsAudio%2A>方法来确定数据对象是否包含音频数据, 然后再使用<xref:System.Windows.Forms.DataObject.GetAudioStream%2A>方法对其进行检索。</span><span class="sxs-lookup"><span data-stu-id="9dccb-336">To retrieve audio data from the data object, first use the <xref:System.Windows.Forms.DataObject.ContainsAudio%2A> method to determine whether the data object contains audio data before retrieving it with the <xref:System.Windows.Forms.DataObject.GetAudioStream%2A> method.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="9dccb-337"><paramref name="audioStream" /> 为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="9dccb-337"><paramref name="audioStream" /> is <see langword="null" />.</span></span></exception>
        <altmember cref="F:System.Windows.Forms.DataFormats.WaveAudio" />
        <altmember cref="M:System.Windows.Forms.DataObject.ContainsAudio" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetAudioStream" />
      </Docs>
    </Member>
    <MemberGroup MemberName="SetData">
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="9dccb-338">将对象添加到 <see cref="T:System.Windows.Forms.DataObject" /> 中。</span><span class="sxs-lookup"><span data-stu-id="9dccb-338">Adds an object to the <see cref="T:System.Windows.Forms.DataObject" />.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="SetData">
      <MemberSignature Language="C#" Value="public virtual void SetData (object data);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance void SetData(object data) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.SetData(System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Sub SetData (data As Object)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual void SetData(System::Object ^ data);" />
      <MemberSignature Language="F#" Value="abstract member SetData : obj -&gt; unit&#xA;override this.SetData : obj -&gt; unit" Usage="dataObject.SetData data" />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.Windows.Forms.IDataObject.SetData(System.Object)</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="data" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="data"><span data-ttu-id="9dccb-339">要存储的数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-339">The data to store.</span></span></param>
        <summary><span data-ttu-id="9dccb-340">使用对象类型作为数据格式将指定对象添加到 <see cref="T:System.Windows.Forms.DataObject" />。</span><span class="sxs-lookup"><span data-stu-id="9dccb-340">Adds the specified object to the <see cref="T:System.Windows.Forms.DataObject" /> using the object type as the data format.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  

[!INCLUDE [untrusted-data-method-note](~/includes/untrusted-data-method-note.md)]

 <span data-ttu-id="9dccb-341">如果您不知道目标应用程序的格式, 则可以使用此方法以多种格式存储数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-341">If you do not know the format of the target application, you can store data in multiple formats using this method.</span></span> <span data-ttu-id="9dccb-342">在检索使用此方法存储的数据时, 可以将其转换为兼容的格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-342">Data stored using this method can be converted to a compatible format when it is retrieved.</span></span>  
  
 <span data-ttu-id="9dccb-343">重载通过调用<xref:System.Object.GetType%2A?displayProperty=nameWithType>方法`data`将值存储为它确定的格式。 <xref:System.Windows.Forms.DataObject.SetData%28System.Object%29></span><span class="sxs-lookup"><span data-stu-id="9dccb-343">The <xref:System.Windows.Forms.DataObject.SetData%28System.Object%29> overload stores the `data` value in a format that it determines by calling the <xref:System.Object.GetType%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="9dccb-344">如果`data` <xref:System.Windows.DataFormats.Serializable>实现接口, 此重载还会将值存储为格式。 <xref:System.Runtime.Serialization.ISerializable></span><span class="sxs-lookup"><span data-stu-id="9dccb-344">If `data` implements the <xref:System.Runtime.Serialization.ISerializable> interface, this overload also stores the value in the <xref:System.Windows.DataFormats.Serializable> format.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9dccb-345">下面的代码示例将<xref:System.Windows.Forms.DataObject>数据存储在中。</span><span class="sxs-lookup"><span data-stu-id="9dccb-345">The following code example stores data in a <xref:System.Windows.Forms.DataObject>.</span></span> <span data-ttu-id="9dccb-346">首先, 创建一个<xref:System.Windows.Forms.DataObject>新的, 并在其中存储一个组件。</span><span class="sxs-lookup"><span data-stu-id="9dccb-346">First, a new <xref:System.Windows.Forms.DataObject> is created and a component is stored in it.</span></span> <span data-ttu-id="9dccb-347">然后, 通过指定类来检索数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-347">Then, the data is retrieved by specifying the class.</span></span> <span data-ttu-id="9dccb-348">结果将显示在文本框中。</span><span class="sxs-lookup"><span data-stu-id="9dccb-348">The result is displayed in a text box.</span></span>  
  
 <span data-ttu-id="9dccb-349">此代码需要已`textBox1`创建的。</span><span class="sxs-lookup"><span data-stu-id="9dccb-349">This code requires that `textBox1` has been created.</span></span>  
  
 [!code-cpp[Classic DataObject.SetData3 Example#1](~/samples/snippets/cpp/VS_Snippets_Winforms/Classic DataObject.SetData3 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic DataObject.SetData3 Example#1](~/samples/snippets/csharp/VS_Snippets_Winforms/Classic DataObject.SetData3 Example/CS/source.cs#1)]
 [!code-vb[Classic DataObject.SetData3 Example#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/Classic DataObject.SetData3 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Windows.Forms.DataObject.GetDataPresent(System.Type)" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetData(System.String,System.Boolean)" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetFormats(System.Boolean)" />
        <altmember cref="N:System.Runtime.Serialization" />
      </Docs>
    </Member>
    <Member MemberName="SetData">
      <MemberSignature Language="C#" Value="public virtual void SetData (string format, object data);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance void SetData(string format, object data) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.SetData(System.String,System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Sub SetData (format As String, data As Object)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual void SetData(System::String ^ format, System::Object ^ data);" />
      <MemberSignature Language="F#" Value="abstract member SetData : string * obj -&gt; unit&#xA;override this.SetData : string * obj -&gt; unit" Usage="dataObject.SetData (format, data)" />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.Windows.Forms.IDataObject.SetData(System.String,System.Object)</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="format" Type="System.String" />
        <Parameter Name="data" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="format"><span data-ttu-id="9dccb-350">与数据关联的格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-350">The format associated with the data.</span></span> <span data-ttu-id="9dccb-351">请参见 <see cref="T:System.Windows.Forms.DataFormats" /> 以获取预定义的格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-351">See <see cref="T:System.Windows.Forms.DataFormats" /> for predefined formats.</span></span></param>
        <param name="data"><span data-ttu-id="9dccb-352">要存储的数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-352">The data to store.</span></span></param>
        <summary><span data-ttu-id="9dccb-353">使用指定格式将指定对象添加到 <see cref="T:System.Windows.Forms.DataObject" />。</span><span class="sxs-lookup"><span data-stu-id="9dccb-353">Adds the specified object to the <see cref="T:System.Windows.Forms.DataObject" /> using the specified format.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  

[!INCLUDE [untrusted-data-method-note](~/includes/untrusted-data-method-note.md)]

 <span data-ttu-id="9dccb-354">如果您不知道目标应用程序的格式, 则可以使用此方法以多种格式存储数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-354">If you do not know the format of the target application, you can store data in multiple formats using this method.</span></span>  
  
 <span data-ttu-id="9dccb-355">在检索使用此方法存储的数据时, 可以将其转换为兼容的格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-355">Data stored using this method can be converted to a compatible format when it is retrieved.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9dccb-356">下面的代码示例将数据存储在<xref:System.Windows.Forms.DataObject>中, 并将其格式指定为 Unicode。</span><span class="sxs-lookup"><span data-stu-id="9dccb-356">The following code example stores data in a <xref:System.Windows.Forms.DataObject>, specifying its format as Unicode.</span></span>  
  
 <span data-ttu-id="9dccb-357">然后通过指定文本格式来检索数据, 因为默认情况下, 在最终格式兼容时转换数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-357">Then the data is retrieved by specifying the text format, since the default is to convert the data when the final format is compatible.</span></span> <span data-ttu-id="9dccb-358">结果将显示在文本框中。</span><span class="sxs-lookup"><span data-stu-id="9dccb-358">The result is displayed in a text box.</span></span>  
  
 <span data-ttu-id="9dccb-359">此代码需要已`textBox1`创建的。</span><span class="sxs-lookup"><span data-stu-id="9dccb-359">This code requires that `textBox1` has been created.</span></span>  
  
 [!code-cpp[Classic DataObject.SetData1 Example#1](~/samples/snippets/cpp/VS_Snippets_Winforms/Classic DataObject.SetData1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic DataObject.SetData1 Example#1](~/samples/snippets/csharp/VS_Snippets_Winforms/Classic DataObject.SetData1 Example/CS/source.cs#1)]
 [!code-vb[Classic DataObject.SetData1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/Classic DataObject.SetData1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Windows.Forms.DataObject.GetData(System.String,System.Boolean)" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetDataPresent(System.Type)" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetFormats(System.Boolean)" />
        <altmember cref="T:System.Windows.Forms.DataFormats" />
      </Docs>
    </Member>
    <Member MemberName="SetData">
      <MemberSignature Language="C#" Value="public virtual void SetData (Type format, object data);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance void SetData(class System.Type format, object data) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.SetData(System.Type,System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Sub SetData (format As Type, data As Object)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual void SetData(Type ^ format, System::Object ^ data);" />
      <MemberSignature Language="F#" Value="abstract member SetData : Type * obj -&gt; unit&#xA;override this.SetData : Type * obj -&gt; unit" Usage="dataObject.SetData (format, data)" />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.Windows.Forms.IDataObject.SetData(System.Type,System.Object)</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="format" Type="System.Type" />
        <Parameter Name="data" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="format"><span data-ttu-id="9dccb-360">表示与数据关联的格式的 <see cref="T:System.Type" />。</span><span class="sxs-lookup"><span data-stu-id="9dccb-360">A <see cref="T:System.Type" /> representing the format associated with the data.</span></span></param>
        <param name="data"><span data-ttu-id="9dccb-361">要存储的数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-361">The data to store.</span></span></param>
        <summary><span data-ttu-id="9dccb-362">使用指定类型作为格式将指定对象添加到 <see cref="T:System.Windows.Forms.DataObject" />。</span><span class="sxs-lookup"><span data-stu-id="9dccb-362">Adds the specified object to the <see cref="T:System.Windows.Forms.DataObject" /> using the specified type as the format.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  

[!INCLUDE [untrusted-data-method-note](~/includes/untrusted-data-method-note.md)]

 <span data-ttu-id="9dccb-363">如果您不知道目标应用程序的格式, 则可以使用此方法以多种格式存储数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-363">If you do not know the format of the target application, you can store data in multiple formats using this method.</span></span>  
  
 <span data-ttu-id="9dccb-364">在检索使用此方法存储的数据时, 可以将其转换为兼容的格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-364">Data stored using this method can be converted to a compatible format when it is retrieved.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9dccb-365">下面的代码示例<xref:System.Windows.Forms.DataObject> <xref:System.Type>使用作为数据格式将数据存储在中。</span><span class="sxs-lookup"><span data-stu-id="9dccb-365">The following code example stores data in a <xref:System.Windows.Forms.DataObject> using a <xref:System.Type> as the data format.</span></span> <span data-ttu-id="9dccb-366">然后通过调用<xref:System.Windows.Forms.DataObject.GetData%2A> <xref:System.Type>来检索数据, 以指定数据格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-366">The data is then retrieved by calling <xref:System.Windows.Forms.DataObject.GetData%2A> using the <xref:System.Type> to specify the data format.</span></span> <span data-ttu-id="9dccb-367">结果将显示在文本框中。</span><span class="sxs-lookup"><span data-stu-id="9dccb-367">The result is displayed in a text box.</span></span>  
  
 <span data-ttu-id="9dccb-368">此代码需要已`textBox1`创建的。</span><span class="sxs-lookup"><span data-stu-id="9dccb-368">This code requires that `textBox1` has been created.</span></span>  
  
 [!code-cpp[Classic DataObject.SetData2 Example#1](~/samples/snippets/cpp/VS_Snippets_Winforms/Classic DataObject.SetData2 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic DataObject.SetData2 Example#1](~/samples/snippets/csharp/VS_Snippets_Winforms/Classic DataObject.SetData2 Example/CS/source.cs#1)]
 [!code-vb[Classic DataObject.SetData2 Example#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/Classic DataObject.SetData2 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Windows.Forms.DataObject.GetDataPresent(System.Type)" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetData(System.String,System.Boolean)" />
        <altmember cref="T:System.Windows.Forms.DataFormats" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetFormats(System.Boolean)" />
        <altmember cref="T:System.Type" />
      </Docs>
    </Member>
    <Member MemberName="SetData">
      <MemberSignature Language="C#" Value="public virtual void SetData (string format, bool autoConvert, object data);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance void SetData(string format, bool autoConvert, object data) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.SetData(System.String,System.Boolean,System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Sub SetData (format As String, autoConvert As Boolean, data As Object)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual void SetData(System::String ^ format, bool autoConvert, System::Object ^ data);" />
      <MemberSignature Language="F#" Value="abstract member SetData : string * bool * obj -&gt; unit&#xA;override this.SetData : string * bool * obj -&gt; unit" Usage="dataObject.SetData (format, autoConvert, data)" />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.Windows.Forms.IDataObject.SetData(System.String,System.Boolean,System.Object)</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="format" Type="System.String" />
        <Parameter Name="autoConvert" Type="System.Boolean" />
        <Parameter Name="data" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="format"><span data-ttu-id="9dccb-369">与数据关联的格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-369">The format associated with the data.</span></span> <span data-ttu-id="9dccb-370">请参见 <see cref="T:System.Windows.Forms.DataFormats" /> 以获取预定义的格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-370">See <see cref="T:System.Windows.Forms.DataFormats" /> for predefined formats.</span></span></param>
        <param name="autoConvert"><span data-ttu-id="9dccb-371">如果允许将数据转换成另一格式，值为 <see langword="true" />；否则，值为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="9dccb-371"><see langword="true" /> to allow the data to be converted to another format; otherwise, <see langword="false" />.</span></span></param>
        <param name="data"><span data-ttu-id="9dccb-372">要存储的数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-372">The data to store.</span></span></param>
        <summary><span data-ttu-id="9dccb-373">使用指定格式将指定对象添加到 <see cref="T:System.Windows.Forms.DataObject" /> 并指示这些数据是否可以转换为其他格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-373">Adds the specified object to the <see cref="T:System.Windows.Forms.DataObject" /> using the specified format and indicating whether the data can be converted to another format.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  

[!INCLUDE [untrusted-data-method-note](~/includes/untrusted-data-method-note.md)]

 <span data-ttu-id="9dccb-374">如果您不知道目标应用程序的格式, 则可以使用此方法以多种格式存储数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-374">If you do not know the format of the target application, you can store data in multiple formats using this method.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="9dccb-375">下面的代码示例将<xref:System.Windows.Forms.DataObject>数据存储在中, 并指定只能以本机格式检索数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-375">The following code example stores data in a <xref:System.Windows.Forms.DataObject> and specifies that the data can only be retrieved in its native format.</span></span>  
  
 <span data-ttu-id="9dccb-376">首先, 创建一个<xref:System.Windows.Forms.DataObject>新的。</span><span class="sxs-lookup"><span data-stu-id="9dccb-376">First, a new <xref:System.Windows.Forms.DataObject> is created.</span></span> <span data-ttu-id="9dccb-377">Unicode 格式的数据存储在<xref:System.Windows.Forms.DataObject>中, 并`autoConvert`将设置为`false`。</span><span class="sxs-lookup"><span data-stu-id="9dccb-377">Data in the Unicode format is stored in the <xref:System.Windows.Forms.DataObject>, with `autoConvert` set to `false`.</span></span>  
  
 <span data-ttu-id="9dccb-378">然后, <xref:System.Windows.Forms.DataObject>查询以获取可用数据格式的列表。</span><span class="sxs-lookup"><span data-stu-id="9dccb-378">Then, the <xref:System.Windows.Forms.DataObject> is queried for the list of available data formats.</span></span> <span data-ttu-id="9dccb-379">仅返回 Unicode 格式, 尽管 Unicode 数据可以转换为文本和其他格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-379">Only the Unicode format is returned, although Unicode data can be converted to text and other formats.</span></span>  
  
 <span data-ttu-id="9dccb-380">此代码需要已`textBox1`创建的。</span><span class="sxs-lookup"><span data-stu-id="9dccb-380">This code requires that `textBox1` has been created.</span></span>  
  
 [!code-cpp[Classic DataObject.SetData Example#1](~/samples/snippets/cpp/VS_Snippets_Winforms/Classic DataObject.SetData Example/CPP/source.cpp#1)]
 [!code-csharp[Classic DataObject.SetData Example#1](~/samples/snippets/csharp/VS_Snippets_Winforms/Classic DataObject.SetData Example/CS/source.cs#1)]
 [!code-vb[Classic DataObject.SetData Example#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/Classic DataObject.SetData Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Windows.Forms.DataObject.GetData(System.String,System.Boolean)" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetDataPresent(System.Type)" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetFormats(System.Boolean)" />
        <altmember cref="T:System.Windows.Forms.DataFormats" />
      </Docs>
    </Member>
    <Member MemberName="SetFileDropList">
      <MemberSignature Language="C#" Value="public virtual void SetFileDropList (System.Collections.Specialized.StringCollection filePaths);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance void SetFileDropList(class System.Collections.Specialized.StringCollection filePaths) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.SetFileDropList(System.Collections.Specialized.StringCollection)" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Sub SetFileDropList (filePaths As StringCollection)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual void SetFileDropList(System::Collections::Specialized::StringCollection ^ filePaths);" />
      <MemberSignature Language="F#" Value="abstract member SetFileDropList : System.Collections.Specialized.StringCollection -&gt; unit&#xA;override this.SetFileDropList : System.Collections.Specialized.StringCollection -&gt; unit" Usage="dataObject.SetFileDropList filePaths" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="filePaths" Type="System.Collections.Specialized.StringCollection" Index="0" FrameworkAlternate="netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="filePaths"><span data-ttu-id="9dccb-381">包含这些文件名的 <see cref="T:System.Collections.Specialized.StringCollection" />。</span><span class="sxs-lookup"><span data-stu-id="9dccb-381">A <see cref="T:System.Collections.Specialized.StringCollection" /> containing the file names.</span></span></param>
        <summary><span data-ttu-id="9dccb-382">将文件名的集合以 <see cref="F:System.Windows.Forms.DataFormats.FileDrop" /> 格式添加到此数据对象。</span><span class="sxs-lookup"><span data-stu-id="9dccb-382">Adds a collection of file names to the data object in the <see cref="F:System.Windows.Forms.DataFormats.FileDrop" /> format.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9dccb-383">文件放置列表是包含文件的路径信息的字符串的集合。</span><span class="sxs-lookup"><span data-stu-id="9dccb-383">A file drop list is a collection of strings containing path information for files.</span></span>  
  
 <span data-ttu-id="9dccb-384">文件放置列表以<xref:System.String>数组的形式存储在数据对象中。</span><span class="sxs-lookup"><span data-stu-id="9dccb-384">A file drop list is stored in a data object as a <xref:System.String> array.</span></span> <span data-ttu-id="9dccb-385">此方法在`filePaths`将其<xref:System.String>添加到数据对象之前将转换为数组。</span><span class="sxs-lookup"><span data-stu-id="9dccb-385">This method converts `filePaths` to a <xref:System.String> array before adding it to the data object.</span></span>  
  
 <span data-ttu-id="9dccb-386">若要从数据对象检索文件放置列表, 请首先使用<xref:System.Windows.Forms.DataObject.ContainsFileDropList%2A>方法来确定该数据对象是否包含该格式的数据, 然后再使用<xref:System.Windows.Forms.DataObject.GetFileDropList%2A>方法检索数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-386">To retrieve a file drop list from the data object, first use the <xref:System.Windows.Forms.DataObject.ContainsFileDropList%2A> method to determine whether the data object contains data in that format before retrieving it with the <xref:System.Windows.Forms.DataObject.GetFileDropList%2A> method.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="9dccb-387"><paramref name="filePaths" /> 为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="9dccb-387"><paramref name="filePaths" /> is <see langword="null" />.</span></span></exception>
        <altmember cref="F:System.Windows.Forms.DataFormats.FileDrop" />
        <altmember cref="M:System.Windows.Forms.DataObject.ContainsFileDropList" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetFileDropList" />
      </Docs>
    </Member>
    <Member MemberName="SetImage">
      <MemberSignature Language="C#" Value="public virtual void SetImage (System.Drawing.Image image);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance void SetImage(class System.Drawing.Image image) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.SetImage(System.Drawing.Image)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual void SetImage(System::Drawing::Image ^ image);" />
      <MemberSignature Language="F#" Value="abstract member SetImage : System.Drawing.Image -&gt; unit&#xA;override this.SetImage : System.Drawing.Image -&gt; unit" Usage="dataObject.SetImage image" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="image" Type="System.Drawing.Image" Index="0" FrameworkAlternate="netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="image"><span data-ttu-id="9dccb-388">要添加到此数据对象的 <see cref="T:System.Drawing.Image" />。</span><span class="sxs-lookup"><span data-stu-id="9dccb-388">The <see cref="T:System.Drawing.Image" /> to add to the data object.</span></span></param>
        <summary><span data-ttu-id="9dccb-389">将 <see cref="T:System.Drawing.Image" /> 以 <see cref="F:System.Windows.Forms.DataFormats.Bitmap" /> 格式添加到此数据对象。</span><span class="sxs-lookup"><span data-stu-id="9dccb-389">Adds an <see cref="T:System.Drawing.Image" /> to the data object in the <see cref="F:System.Windows.Forms.DataFormats.Bitmap" /> format.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9dccb-390">若要从数据对象中检索图像数据, 请先<xref:System.Windows.Forms.DataObject.ContainsImage%2A>使用方法来确定数据对象是否包含图像数据, 然后再使用<xref:System.Windows.Forms.DataObject.GetImage%2A>方法对其进行检索。</span><span class="sxs-lookup"><span data-stu-id="9dccb-390">To retrieve image data from the data object, first use the <xref:System.Windows.Forms.DataObject.ContainsImage%2A> method to determine whether the data object contains image data before retrieving it with the <xref:System.Windows.Forms.DataObject.GetImage%2A> method.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="9dccb-391"><paramref name="image" /> 为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="9dccb-391"><paramref name="image" /> is <see langword="null" />.</span></span></exception>
        <altmember cref="F:System.Windows.Forms.DataFormats.Bitmap" />
        <altmember cref="M:System.Windows.Forms.DataObject.ContainsImage" />
        <altmember cref="M:System.Windows.Forms.DataObject.GetImage" />
      </Docs>
    </Member>
    <MemberGroup MemberName="SetText">
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="9dccb-392">将文本数据添加到此数据对象。</span><span class="sxs-lookup"><span data-stu-id="9dccb-392">Adds text data to the data object.</span></span></summary>
        <altmember cref="T:System.Windows.Forms.TextDataFormat" />
        <altmember cref="Overload:System.Windows.Forms.DataObject.ContainsText" />
        <altmember cref="Overload:System.Windows.Forms.DataObject.GetText" />
      </Docs>
    </MemberGroup>
    <Member MemberName="SetText">
      <MemberSignature Language="C#" Value="public virtual void SetText (string textData);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance void SetText(string textData) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.SetText(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Sub SetText (textData As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual void SetText(System::String ^ textData);" />
      <MemberSignature Language="F#" Value="abstract member SetText : string -&gt; unit&#xA;override this.SetText : string -&gt; unit" Usage="dataObject.SetText textData" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="textData" Type="System.String" Index="0" FrameworkAlternate="netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="textData"><span data-ttu-id="9dccb-393">要添加到数据对象的文本。</span><span class="sxs-lookup"><span data-stu-id="9dccb-393">The text to add to the data object.</span></span></param>
        <summary><span data-ttu-id="9dccb-394">将文本数据以 <see cref="F:System.Windows.Forms.TextDataFormat.UnicodeText" /> 格式添加到此数据对象。</span><span class="sxs-lookup"><span data-stu-id="9dccb-394">Adds text data to the data object in the <see cref="F:System.Windows.Forms.TextDataFormat.UnicodeText" /> format.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9dccb-395">若要检索数据对象中的文本数据, 请先<xref:System.Windows.Forms.DataObject.ContainsText%2A>使用方法来确定该数据对象是否包含图像数据, 然后再使用<xref:System.Windows.Forms.DataObject.GetText%2A>方法对其进行检索。</span><span class="sxs-lookup"><span data-stu-id="9dccb-395">To retrieve text data from the data object, first use the <xref:System.Windows.Forms.DataObject.ContainsText%2A> method to determine whether the data object contains image data before retrieving it with the <xref:System.Windows.Forms.DataObject.GetText%2A> method.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="9dccb-396"><paramref name="textData" /> 为 <see langword="null" /> 或 <see cref="F:System.String.Empty" />。</span><span class="sxs-lookup"><span data-stu-id="9dccb-396"><paramref name="textData" /> is <see langword="null" /> or <see cref="F:System.String.Empty" />.</span></span></exception>
        <altmember cref="T:System.Windows.Forms.TextDataFormat" />
        <altmember cref="Overload:System.Windows.Forms.DataObject.ContainsText" />
        <altmember cref="Overload:System.Windows.Forms.DataObject.GetText" />
      </Docs>
    </Member>
    <Member MemberName="SetText">
      <MemberSignature Language="C#" Value="public virtual void SetText (string textData, System.Windows.Forms.TextDataFormat format);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance void SetText(string textData, valuetype System.Windows.Forms.TextDataFormat format) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.SetText(System.String,System.Windows.Forms.TextDataFormat)" />
      <MemberSignature Language="VB.NET" Value="Public Overridable Sub SetText (textData As String, format As TextDataFormat)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual void SetText(System::String ^ textData, System::Windows::Forms::TextDataFormat format);" />
      <MemberSignature Language="F#" Value="abstract member SetText : string * System.Windows.Forms.TextDataFormat -&gt; unit&#xA;override this.SetText : string * System.Windows.Forms.TextDataFormat -&gt; unit" Usage="dataObject.SetText (textData, format)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="textData" Type="System.String" Index="0" FrameworkAlternate="netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="format" Type="System.Windows.Forms.TextDataFormat" Index="1" FrameworkAlternate="netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="textData"><span data-ttu-id="9dccb-397">要添加到数据对象的文本。</span><span class="sxs-lookup"><span data-stu-id="9dccb-397">The text to add to the data object.</span></span></param>
        <param name="format"><span data-ttu-id="9dccb-398"><see cref="T:System.Windows.Forms.TextDataFormat" /> 值之一。</span><span class="sxs-lookup"><span data-stu-id="9dccb-398">One of the <see cref="T:System.Windows.Forms.TextDataFormat" /> values.</span></span></param>
        <summary><span data-ttu-id="9dccb-399">将文本数据以指定的 <see cref="T:System.Windows.Forms.TextDataFormat" /> 值表示的格式添加到此数据对象。</span><span class="sxs-lookup"><span data-stu-id="9dccb-399">Adds text data to the data object in the format indicated by the specified <see cref="T:System.Windows.Forms.TextDataFormat" /> value.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9dccb-400">若要检索数据对象中的文本数据, 请先<xref:System.Windows.Forms.DataObject.ContainsText%2A>使用方法来确定该数据对象是否包含图像数据, 然后再使用<xref:System.Windows.Forms.DataObject.GetText%2A>方法对其进行检索。</span><span class="sxs-lookup"><span data-stu-id="9dccb-400">To retrieve text data from the data object, first use the <xref:System.Windows.Forms.DataObject.ContainsText%2A> method to determine whether the data object contains image data before retrieving it with the <xref:System.Windows.Forms.DataObject.GetText%2A> method.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="9dccb-401"><paramref name="textData" /> 为 <see langword="null" /> 或 <see cref="F:System.String.Empty" />。</span><span class="sxs-lookup"><span data-stu-id="9dccb-401"><paramref name="textData" /> is <see langword="null" /> or <see cref="F:System.String.Empty" />.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="9dccb-402"><paramref name="format" /> 不是有效的 <see cref="T:System.Windows.Forms.TextDataFormat" /> 值。</span><span class="sxs-lookup"><span data-stu-id="9dccb-402"><paramref name="format" /> is not a valid <see cref="T:System.Windows.Forms.TextDataFormat" /> value.</span></span></exception>
        <altmember cref="T:System.Windows.Forms.TextDataFormat" />
        <altmember cref="Overload:System.Windows.Forms.DataObject.ContainsText" />
        <altmember cref="Overload:System.Windows.Forms.DataObject.GetText" />
      </Docs>
    </Member>
    <Member MemberName="System.Runtime.InteropServices.ComTypes.IDataObject.DAdvise">
      <MemberSignature Language="C#" Value="int IDataObject.DAdvise (ref System.Runtime.InteropServices.ComTypes.FORMATETC pFormatetc, System.Runtime.InteropServices.ComTypes.ADVF advf, System.Runtime.InteropServices.ComTypes.IAdviseSink pAdvSink, out int pdwConnection);" />
      <MemberSignature Language="ILAsm" Value=".method hidebysig newslot virtual instance int32 System.Runtime.InteropServices.ComTypes.IDataObject.DAdvise(valuetype System.Runtime.InteropServices.ComTypes.FORMATETC&amp; pFormatetc, valuetype System.Runtime.InteropServices.ComTypes.ADVF advf, class System.Runtime.InteropServices.ComTypes.IAdviseSink pAdvSink, [out] int32&amp; pdwConnection) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.System#Runtime#InteropServices#ComTypes#IDataObject#DAdvise(System.Runtime.InteropServices.ComTypes.FORMATETC@,System.Runtime.InteropServices.ComTypes.ADVF,System.Runtime.InteropServices.ComTypes.IAdviseSink,System.Int32@)" />
      <MemberSignature Language="C++ CLI" Value=" virtual int System.Runtime.InteropServices.ComTypes.IDataObject.DAdvise(System::Runtime::InteropServices::ComTypes::FORMATETC % pFormatetc, System::Runtime::InteropServices::ComTypes::ADVF advf, System::Runtime::InteropServices::ComTypes::IAdviseSink ^ pAdvSink, [Runtime::InteropServices::Out] int % pdwConnection) = System::Runtime::InteropServices::ComTypes::IDataObject::DAdvise;" />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.Runtime.InteropServices.ComTypes.IDataObject.DAdvise(System.Runtime.InteropServices.ComTypes.FORMATETC@,System.Runtime.InteropServices.ComTypes.ADVF,System.Runtime.InteropServices.ComTypes.IAdviseSink,System.Int32@)</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="pFormatetc" Type="System.Runtime.InteropServices.ComTypes.FORMATETC" RefType="ref" Index="0" FrameworkAlternate="netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="advf" Type="System.Runtime.InteropServices.ComTypes.ADVF" Index="1" FrameworkAlternate="netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="pAdvSink" Type="System.Runtime.InteropServices.ComTypes.IAdviseSink" Index="2" FrameworkAlternate="netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="pdwConnection" Type="System.Int32" RefType="out" Index="3" FrameworkAlternate="netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="pFormatetc"><span data-ttu-id="9dccb-403">由引用传递的 <see cref="T:System.Runtime.InteropServices.ComTypes.FORMATETC" /> 结构，它定义以后的通知将使用的格式、目标设备、方面和介质。</span><span class="sxs-lookup"><span data-stu-id="9dccb-403">A <see cref="T:System.Runtime.InteropServices.ComTypes.FORMATETC" /> structure, passed by reference, that defines the format, target device, aspect, and medium that will be used for future notifications.</span></span></param>
        <param name="advf"><span data-ttu-id="9dccb-404">一个 <see cref="T:System.Runtime.InteropServices.ComTypes.ADVF" /> 值，它指定用于控制通知连接的一组标志。</span><span class="sxs-lookup"><span data-stu-id="9dccb-404">One of the <see cref="T:System.Runtime.InteropServices.ComTypes.ADVF" /> values that specifies a group of flags for controlling the advisory connection.</span></span></param>
        <param name="pAdvSink"><span data-ttu-id="9dccb-405">指向将接收更改通知的通知接收器上的 <see cref="T:System.Runtime.InteropServices.ComTypes.IAdviseSink" /> 接口的指针。</span><span class="sxs-lookup"><span data-stu-id="9dccb-405">A pointer to the <see cref="T:System.Runtime.InteropServices.ComTypes.IAdviseSink" /> interface on the advisory sink that will receive the change notification.</span></span></param>
        <param name="pdwConnection"><span data-ttu-id="9dccb-406">此方法返回时，包含指向标识此连接的 DWORD 标记的指针。</span><span class="sxs-lookup"><span data-stu-id="9dccb-406">When this method returns, contains a pointer to a DWORD token that identifies this connection.</span></span> <span data-ttu-id="9dccb-407">以后可以使用此标记来删除通知连接，方法是将该标记发送至 <see cref="M:System.Runtime.InteropServices.ComTypes.IDataObject.DUnadvise(System.Int32)" />。</span><span class="sxs-lookup"><span data-stu-id="9dccb-407">You can use this token later to delete the advisory connection by passing it to <see cref="M:System.Runtime.InteropServices.ComTypes.IDataObject.DUnadvise(System.Int32)" />.</span></span> <span data-ttu-id="9dccb-408">如果此值为零，则未建立连接。</span><span class="sxs-lookup"><span data-stu-id="9dccb-408">If this value is zero, the connection was not established.</span></span> <span data-ttu-id="9dccb-409">此参数未经初始化即被传递。</span><span class="sxs-lookup"><span data-stu-id="9dccb-409">This parameter is passed uninitialized.</span></span></param>
        <summary><span data-ttu-id="9dccb-410">在数据对象和通知接收器之间创建连接。</span><span class="sxs-lookup"><span data-stu-id="9dccb-410">Creates a connection between a data object and an advisory sink.</span></span> <span data-ttu-id="9dccb-411">此方法由对象进行调用，该对象支持通知接收器并使通知接收器能收到有关对象数据中的更改的通知。</span><span class="sxs-lookup"><span data-stu-id="9dccb-411">This method is called by an object that supports an advisory sink and enables the advisory sink to be notified of changes in the object's data.</span></span></summary>
        <returns><span data-ttu-id="9dccb-412">此方法支持 E_INVALIDARG、E_UNEXPECTED 和 E_OUTOFMEMORY 等标准返回值，以及下面的值：</span><span class="sxs-lookup"><span data-stu-id="9dccb-412">This method supports the standard return values E_INVALIDARG, E_UNEXPECTED, and E_OUTOFMEMORY, as well as the following:</span></span> 
 <list type="table"><listheader><term> <span data-ttu-id="9dccb-413">值</span><span class="sxs-lookup"><span data-stu-id="9dccb-413">Value</span></span> 
 </term><description> <span data-ttu-id="9dccb-414">说明</span><span class="sxs-lookup"><span data-stu-id="9dccb-414">Description</span></span> 
 </description></listheader><item><term> <span data-ttu-id="9dccb-415">S_OK</span><span class="sxs-lookup"><span data-stu-id="9dccb-415">S_OK</span></span> 
 </term><description> <span data-ttu-id="9dccb-416">已创建通知连接。</span><span class="sxs-lookup"><span data-stu-id="9dccb-416">The advisory connection was created.</span></span>  
  
 </description></item><item><term> <span data-ttu-id="9dccb-417">E_NOTIMPL</span><span class="sxs-lookup"><span data-stu-id="9dccb-417">E_NOTIMPL</span></span> 
 </term><description> <span data-ttu-id="9dccb-418">此方法未在数据对象上实现。</span><span class="sxs-lookup"><span data-stu-id="9dccb-418">This method is not implemented on the data object.</span></span>  
  
 </description></item><item><term> <span data-ttu-id="9dccb-419">DV_E_LINDEX</span><span class="sxs-lookup"><span data-stu-id="9dccb-419">DV_E_LINDEX</span></span> 
 </term><description> <span data-ttu-id="9dccb-420"><see cref="F:System.Runtime.InteropServices.ComTypes.FORMATETC.lindex" /> 有一个无效值；当前，只支持 -1。</span><span class="sxs-lookup"><span data-stu-id="9dccb-420">There is an invalid value for <see cref="F:System.Runtime.InteropServices.ComTypes.FORMATETC.lindex" />; currently, only -1 is supported.</span></span>  
  
 </description></item><item><term> <span data-ttu-id="9dccb-421">DV_E_FORMATETC</span><span class="sxs-lookup"><span data-stu-id="9dccb-421">DV_E_FORMATETC</span></span> 
 </term><description> <span data-ttu-id="9dccb-422"><paramref name="pFormatetc" /> 参数有一个无效值。</span><span class="sxs-lookup"><span data-stu-id="9dccb-422">There is an invalid value for the <paramref name="pFormatetc" /> parameter.</span></span>  
  
 </description></item><item><term> <span data-ttu-id="9dccb-423">OLE_E_ADVISENOTSUPPORTED</span><span class="sxs-lookup"><span data-stu-id="9dccb-423">OLE_E_ADVISENOTSUPPORTED</span></span> 
 </term><description> <span data-ttu-id="9dccb-424">该数据对象不支持更改通知。</span><span class="sxs-lookup"><span data-stu-id="9dccb-424">The data object does not support change notification.</span></span>  
  
 </description></item></list></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9dccb-425">此成员是显式接口成员的实现。</span><span class="sxs-lookup"><span data-stu-id="9dccb-425">This member is an explicit interface member implementation.</span></span> <span data-ttu-id="9dccb-426">它只能在 <xref:System.Windows.Forms.DataObject> 被强制转换为 <xref:System.Runtime.InteropServices.ComTypes.IDataObject> 接口时使用。</span><span class="sxs-lookup"><span data-stu-id="9dccb-426">It can be used only when the <xref:System.Windows.Forms.DataObject> is cast to an <xref:System.Runtime.InteropServices.ComTypes.IDataObject> interface.</span></span>  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Security.Permissions.SecurityPermission"><span data-ttu-id="9dccb-427">用于调用非托管代码。</span><span class="sxs-lookup"><span data-stu-id="9dccb-427">for calling unmanaged code.</span></span> <span data-ttu-id="9dccb-428">关联的枚举:<see cref="F:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode" /></span><span class="sxs-lookup"><span data-stu-id="9dccb-428">Associated enumeration: <see cref="F:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode" /></span></span></permission>
      </Docs>
    </Member>
    <Member MemberName="System.Runtime.InteropServices.ComTypes.IDataObject.DUnadvise">
      <MemberSignature Language="C#" Value="void IDataObject.DUnadvise (int dwConnection);" />
      <MemberSignature Language="ILAsm" Value=".method hidebysig newslot virtual instance void System.Runtime.InteropServices.ComTypes.IDataObject.DUnadvise(int32 dwConnection) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.System#Runtime#InteropServices#ComTypes#IDataObject#DUnadvise(System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Sub DUnadvise (dwConnection As Integer) Implements IDataObject.DUnadvise" />
      <MemberSignature Language="C++ CLI" Value=" virtual void System.Runtime.InteropServices.ComTypes.IDataObject.DUnadvise(int dwConnection) = System::Runtime::InteropServices::ComTypes::IDataObject::DUnadvise;" />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.Runtime.InteropServices.ComTypes.IDataObject.DUnadvise(System.Int32)</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="dwConnection" Type="System.Int32" Index="0" FrameworkAlternate="netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="dwConnection"><span data-ttu-id="9dccb-429">指定要移除的连接的 DWORD 标记。</span><span class="sxs-lookup"><span data-stu-id="9dccb-429">A DWORD token that specifies the connection to remove.</span></span> <span data-ttu-id="9dccb-430">使用最初建立连接时 <see cref="M:System.Runtime.InteropServices.ComTypes.IDataObject.DAdvise(System.Runtime.InteropServices.ComTypes.FORMATETC@,System.Runtime.InteropServices.ComTypes.ADVF,System.Runtime.InteropServices.ComTypes.IAdviseSink,System.Int32@)" /> 返回的值。</span><span class="sxs-lookup"><span data-stu-id="9dccb-430">Use the value returned by <see cref="M:System.Runtime.InteropServices.ComTypes.IDataObject.DAdvise(System.Runtime.InteropServices.ComTypes.FORMATETC@,System.Runtime.InteropServices.ComTypes.ADVF,System.Runtime.InteropServices.ComTypes.IAdviseSink,System.Int32@)" /> when the connection was originally established.</span></span></param>
        <summary><span data-ttu-id="9dccb-431">销毁以前建立的通知连接。</span><span class="sxs-lookup"><span data-stu-id="9dccb-431">Destroys a notification connection that had been previously established.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9dccb-432">此成员是显式接口成员的实现。</span><span class="sxs-lookup"><span data-stu-id="9dccb-432">This member is an explicit interface member implementation.</span></span> <span data-ttu-id="9dccb-433">它只能在 <xref:System.Windows.Forms.DataObject> 被强制转换为 <xref:System.Runtime.InteropServices.ComTypes.IDataObject> 接口时使用。</span><span class="sxs-lookup"><span data-stu-id="9dccb-433">It can be used only when the <xref:System.Windows.Forms.DataObject> is cast to an <xref:System.Runtime.InteropServices.ComTypes.IDataObject> interface.</span></span>  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Security.Permissions.SecurityPermission"><span data-ttu-id="9dccb-434">用于调用非托管代码。</span><span class="sxs-lookup"><span data-stu-id="9dccb-434">for calling unmanaged code.</span></span> <span data-ttu-id="9dccb-435">关联的枚举:<see cref="F:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode" /></span><span class="sxs-lookup"><span data-stu-id="9dccb-435">Associated enumeration: <see cref="F:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode" /></span></span></permission>
      </Docs>
    </Member>
    <Member MemberName="System.Runtime.InteropServices.ComTypes.IDataObject.EnumDAdvise">
      <MemberSignature Language="C#" Value="int IDataObject.EnumDAdvise (out System.Runtime.InteropServices.ComTypes.IEnumSTATDATA enumAdvise);" />
      <MemberSignature Language="ILAsm" Value=".method hidebysig newslot virtual instance int32 System.Runtime.InteropServices.ComTypes.IDataObject.EnumDAdvise([out] class System.Runtime.InteropServices.ComTypes.IEnumSTATDATA&amp; enumAdvise) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.System#Runtime#InteropServices#ComTypes#IDataObject#EnumDAdvise(System.Runtime.InteropServices.ComTypes.IEnumSTATDATA@)" />
      <MemberSignature Language="VB.NET" Value="Function EnumDAdvise (ByRef enumAdvise As IEnumSTATDATA) As Integer Implements IDataObject.EnumDAdvise" />
      <MemberSignature Language="C++ CLI" Value=" virtual int System.Runtime.InteropServices.ComTypes.IDataObject.EnumDAdvise([Runtime::InteropServices::Out] System::Runtime::InteropServices::ComTypes::IEnumSTATDATA ^ % enumAdvise) = System::Runtime::InteropServices::ComTypes::IDataObject::EnumDAdvise;" />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.Runtime.InteropServices.ComTypes.IDataObject.EnumDAdvise(System.Runtime.InteropServices.ComTypes.IEnumSTATDATA@)</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="enumAdvise" Type="System.Runtime.InteropServices.ComTypes.IEnumSTATDATA" RefType="out" Index="0" FrameworkAlternate="netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="enumAdvise"><span data-ttu-id="9dccb-436">此方法返回时，包含 <see cref="T:System.Runtime.InteropServices.ComTypes.IEnumSTATDATA" />，它接收指向新枚举数对象的接口指针。</span><span class="sxs-lookup"><span data-stu-id="9dccb-436">When this method returns, contains an <see cref="T:System.Runtime.InteropServices.ComTypes.IEnumSTATDATA" /> that receives the interface pointer to the new enumerator object.</span></span> <span data-ttu-id="9dccb-437">如果该实现将 <paramref name="enumAdvise" /> 设置为 <see langword="null" />，则此时没有到通知接收器的连接。</span><span class="sxs-lookup"><span data-stu-id="9dccb-437">If the implementation sets <paramref name="enumAdvise" /> to <see langword="null" />, there are no connections to advisory sinks at this time.</span></span> <span data-ttu-id="9dccb-438">此参数未经初始化即被传递。</span><span class="sxs-lookup"><span data-stu-id="9dccb-438">This parameter is passed uninitialized.</span></span></param>
        <summary><span data-ttu-id="9dccb-439">创建可用于对当前的通知连接进行枚举的对象。</span><span class="sxs-lookup"><span data-stu-id="9dccb-439">Creates an object that can be used to enumerate the current advisory connections.</span></span></summary>
        <returns><span data-ttu-id="9dccb-440">此方法支持标准返回值 E_OUTOFMEMORY 以及下面的值：</span><span class="sxs-lookup"><span data-stu-id="9dccb-440">This method supports the standard return value E_OUTOFMEMORY, as well as the following:</span></span>  
  
 <list type="table"><listheader><term> <span data-ttu-id="9dccb-441">值</span><span class="sxs-lookup"><span data-stu-id="9dccb-441">Value</span></span>  
  
 </term><description> <span data-ttu-id="9dccb-442">说明</span><span class="sxs-lookup"><span data-stu-id="9dccb-442">Description</span></span>  
  
 </description></listheader><item><term> <span data-ttu-id="9dccb-443">S_OK</span><span class="sxs-lookup"><span data-stu-id="9dccb-443">S_OK</span></span>  
  
 </term><description> <span data-ttu-id="9dccb-444">枚举数对象已成功实例化或没有连接。</span><span class="sxs-lookup"><span data-stu-id="9dccb-444">The enumerator object is successfully instantiated or there are no connections.</span></span>  
  
 </description></item><item><term> <span data-ttu-id="9dccb-445">OLE_E_ADVISENOTSUPPORTED</span><span class="sxs-lookup"><span data-stu-id="9dccb-445">OLE_E_ADVISENOTSUPPORTED</span></span>  
  
 </term><description> <span data-ttu-id="9dccb-446">此对象不支持通知。</span><span class="sxs-lookup"><span data-stu-id="9dccb-446">This object does not support advisory notifications.</span></span>  
  
 </description></item></list></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9dccb-447">此成员是显式接口成员的实现。</span><span class="sxs-lookup"><span data-stu-id="9dccb-447">This member is an explicit interface member implementation.</span></span> <span data-ttu-id="9dccb-448">它只能在 <xref:System.Windows.Forms.DataObject> 被强制转换为 <xref:System.Runtime.InteropServices.ComTypes.IDataObject> 接口时使用。</span><span class="sxs-lookup"><span data-stu-id="9dccb-448">It can be used only when the <xref:System.Windows.Forms.DataObject> is cast to an <xref:System.Runtime.InteropServices.ComTypes.IDataObject> interface.</span></span>  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Security.Permissions.SecurityPermission"><span data-ttu-id="9dccb-449">用于调用非托管代码。</span><span class="sxs-lookup"><span data-stu-id="9dccb-449">for calling unmanaged code.</span></span> <span data-ttu-id="9dccb-450">关联的枚举:<see cref="F:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode" /></span><span class="sxs-lookup"><span data-stu-id="9dccb-450">Associated enumeration: <see cref="F:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode" /></span></span></permission>
      </Docs>
    </Member>
    <Member MemberName="System.Runtime.InteropServices.ComTypes.IDataObject.EnumFormatEtc">
      <MemberSignature Language="C#" Value="System.Runtime.InteropServices.ComTypes.IEnumFORMATETC IDataObject.EnumFormatEtc (System.Runtime.InteropServices.ComTypes.DATADIR dwDirection);" />
      <MemberSignature Language="ILAsm" Value=".method hidebysig newslot virtual instance class System.Runtime.InteropServices.ComTypes.IEnumFORMATETC System.Runtime.InteropServices.ComTypes.IDataObject.EnumFormatEtc(valuetype System.Runtime.InteropServices.ComTypes.DATADIR dwDirection) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.System#Runtime#InteropServices#ComTypes#IDataObject#EnumFormatEtc(System.Runtime.InteropServices.ComTypes.DATADIR)" />
      <MemberSignature Language="VB.NET" Value="Function EnumFormatEtc (dwDirection As DATADIR) As IEnumFORMATETC Implements IDataObject.EnumFormatEtc" />
      <MemberSignature Language="C++ CLI" Value=" virtual System::Runtime::InteropServices::ComTypes::IEnumFORMATETC ^ System.Runtime.InteropServices.ComTypes.IDataObject.EnumFormatEtc(System::Runtime::InteropServices::ComTypes::DATADIR dwDirection) = System::Runtime::InteropServices::ComTypes::IDataObject::EnumFormatEtc;" />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.Runtime.InteropServices.ComTypes.IDataObject.EnumFormatEtc(System.Runtime.InteropServices.ComTypes.DATADIR)</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Runtime.InteropServices.ComTypes.IEnumFORMATETC</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="dwDirection" Type="System.Runtime.InteropServices.ComTypes.DATADIR" Index="0" FrameworkAlternate="netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="dwDirection"><span data-ttu-id="9dccb-451">指定数据方向的 <see cref="T:System.Runtime.InteropServices.ComTypes.DATADIR" /> 值之一。</span><span class="sxs-lookup"><span data-stu-id="9dccb-451">One of the <see cref="T:System.Runtime.InteropServices.ComTypes.DATADIR" /> values that specifies the direction of the data.</span></span></param>
        <summary><span data-ttu-id="9dccb-452">创建一个用于枚举数据对象的 <see cref="T:System.Runtime.InteropServices.ComTypes.FORMATETC" /> 结构的对象。</span><span class="sxs-lookup"><span data-stu-id="9dccb-452">Creates an object for enumerating the <see cref="T:System.Runtime.InteropServices.ComTypes.FORMATETC" /> structures for a data object.</span></span> <span data-ttu-id="9dccb-453">这些结构用于对 <see cref="M:System.Runtime.InteropServices.ComTypes.IDataObject.GetData(System.Runtime.InteropServices.ComTypes.FORMATETC@,System.Runtime.InteropServices.ComTypes.STGMEDIUM@)" /> 或 <see cref="M:System.Runtime.InteropServices.ComTypes.IDataObject.SetData(System.Runtime.InteropServices.ComTypes.FORMATETC@,System.Runtime.InteropServices.ComTypes.STGMEDIUM@,System.Boolean)" /> 的调用中。</span><span class="sxs-lookup"><span data-stu-id="9dccb-453">These structures are used in calls to <see cref="M:System.Runtime.InteropServices.ComTypes.IDataObject.GetData(System.Runtime.InteropServices.ComTypes.FORMATETC@,System.Runtime.InteropServices.ComTypes.STGMEDIUM@)" /> or <see cref="M:System.Runtime.InteropServices.ComTypes.IDataObject.SetData(System.Runtime.InteropServices.ComTypes.FORMATETC@,System.Runtime.InteropServices.ComTypes.STGMEDIUM@,System.Boolean)" />.</span></span></summary>
        <returns><span data-ttu-id="9dccb-454">此方法支持 E_INVALIDARG 和 E_OUTOFMEMORY 等标准返回值，以及下面的值：</span><span class="sxs-lookup"><span data-stu-id="9dccb-454">This method supports the standard return values E_INVALIDARG and E_OUTOFMEMORY, as well as the following:</span></span> 
 <list type="table"><listheader><term> <span data-ttu-id="9dccb-455">值</span><span class="sxs-lookup"><span data-stu-id="9dccb-455">Value</span></span> 
 </term><description> <span data-ttu-id="9dccb-456">说明</span><span class="sxs-lookup"><span data-stu-id="9dccb-456">Description</span></span> 
 </description></listheader><item><term> <span data-ttu-id="9dccb-457">S_OK</span><span class="sxs-lookup"><span data-stu-id="9dccb-457">S_OK</span></span> 
 </term><description> <span data-ttu-id="9dccb-458">已成功创建枚举数对象。</span><span class="sxs-lookup"><span data-stu-id="9dccb-458">The enumerator object was successfully created.</span></span>  
  
 </description></item><item><term> <span data-ttu-id="9dccb-459">E_NOTIMPL</span><span class="sxs-lookup"><span data-stu-id="9dccb-459">E_NOTIMPL</span></span> 
 </term><description> <span data-ttu-id="9dccb-460">由 <paramref name="direction" /> 参数指定的方向不受支持。</span><span class="sxs-lookup"><span data-stu-id="9dccb-460">The direction specified by the <paramref name="direction" /> parameter is not supported.</span></span>  
  
 </description></item><item><term> <span data-ttu-id="9dccb-461">OLE_S_USEREG</span><span class="sxs-lookup"><span data-stu-id="9dccb-461">OLE_S_USEREG</span></span> 
 </term><description> <span data-ttu-id="9dccb-462">OLE 枚举注册表中的格式的请求。</span><span class="sxs-lookup"><span data-stu-id="9dccb-462">Requests that OLE enumerate the formats from the registry.</span></span>  
  
 </description></item></list></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9dccb-463">此成员是显式接口成员的实现。</span><span class="sxs-lookup"><span data-stu-id="9dccb-463">This member is an explicit interface member implementation.</span></span> <span data-ttu-id="9dccb-464">它只能在 <xref:System.Windows.Forms.DataObject> 被强制转换为 <xref:System.Runtime.InteropServices.ComTypes.IDataObject> 接口时使用。</span><span class="sxs-lookup"><span data-stu-id="9dccb-464">It can be used only when the <xref:System.Windows.Forms.DataObject> is cast to an <xref:System.Runtime.InteropServices.ComTypes.IDataObject> interface.</span></span>  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Security.Permissions.SecurityPermission"><span data-ttu-id="9dccb-465">用于调用非托管代码。</span><span class="sxs-lookup"><span data-stu-id="9dccb-465">for calling unmanaged code.</span></span> <span data-ttu-id="9dccb-466">关联的枚举:<see cref="F:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode" /></span><span class="sxs-lookup"><span data-stu-id="9dccb-466">Associated enumeration: <see cref="F:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode" /></span></span></permission>
      </Docs>
    </Member>
    <Member MemberName="System.Runtime.InteropServices.ComTypes.IDataObject.GetCanonicalFormatEtc">
      <MemberSignature Language="C#" Value="int IDataObject.GetCanonicalFormatEtc (ref System.Runtime.InteropServices.ComTypes.FORMATETC pformatetcIn, out System.Runtime.InteropServices.ComTypes.FORMATETC pformatetcOut);" />
      <MemberSignature Language="ILAsm" Value=".method hidebysig newslot virtual instance int32 System.Runtime.InteropServices.ComTypes.IDataObject.GetCanonicalFormatEtc(valuetype System.Runtime.InteropServices.ComTypes.FORMATETC&amp; pformatetcIn, [out] valuetype System.Runtime.InteropServices.ComTypes.FORMATETC&amp; pformatetcOut) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.System#Runtime#InteropServices#ComTypes#IDataObject#GetCanonicalFormatEtc(System.Runtime.InteropServices.ComTypes.FORMATETC@,System.Runtime.InteropServices.ComTypes.FORMATETC@)" />
      <MemberSignature Language="VB.NET" Value="Function GetCanonicalFormatEtc (ByRef pformatetcIn As FORMATETC, ByRef pformatetcOut As FORMATETC) As Integer Implements IDataObject.GetCanonicalFormatEtc" />
      <MemberSignature Language="C++ CLI" Value=" virtual int System.Runtime.InteropServices.ComTypes.IDataObject.GetCanonicalFormatEtc(System::Runtime::InteropServices::ComTypes::FORMATETC % pformatetcIn, [Runtime::InteropServices::Out] System::Runtime::InteropServices::ComTypes::FORMATETC % pformatetcOut) = System::Runtime::InteropServices::ComTypes::IDataObject::GetCanonicalFormatEtc;" />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.Runtime.InteropServices.ComTypes.IDataObject.GetCanonicalFormatEtc(System.Runtime.InteropServices.ComTypes.FORMATETC@,System.Runtime.InteropServices.ComTypes.FORMATETC@)</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="pformatetcIn" Type="System.Runtime.InteropServices.ComTypes.FORMATETC" RefType="ref" Index="0" FrameworkAlternate="netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="pformatetcOut" Type="System.Runtime.InteropServices.ComTypes.FORMATETC" RefType="out" Index="1" FrameworkAlternate="netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="pformatetcIn"><span data-ttu-id="9dccb-467">由引用传递的、指向 <see cref="T:System.Runtime.InteropServices.ComTypes.FORMATETC" /> 结构的指针，该结构定义调用方在后续调用（如 <see cref="M:System.Runtime.InteropServices.ComTypes.IDataObject.GetData(System.Runtime.InteropServices.ComTypes.FORMATETC@,System.Runtime.InteropServices.ComTypes.STGMEDIUM@)" />）中检索数据时将要使用的格式、介质和目标设备。</span><span class="sxs-lookup"><span data-stu-id="9dccb-467">A pointer to a <see cref="T:System.Runtime.InteropServices.ComTypes.FORMATETC" /> structure, passed by reference, that defines the format, medium, and target device that the caller would like to use to retrieve data in a subsequent call such as <see cref="M:System.Runtime.InteropServices.ComTypes.IDataObject.GetData(System.Runtime.InteropServices.ComTypes.FORMATETC@,System.Runtime.InteropServices.ComTypes.STGMEDIUM@)" />.</span></span> <span data-ttu-id="9dccb-468">在此情况下，<see cref="T:System.Runtime.InteropServices.ComTypes.TYMED" /> 成员并无意义，应将其忽略。</span><span class="sxs-lookup"><span data-stu-id="9dccb-468">The <see cref="T:System.Runtime.InteropServices.ComTypes.TYMED" /> member is not significant in this case and should be ignored.</span></span></param>
        <param name="pformatetcOut"><span data-ttu-id="9dccb-469">此方法返回时，结果包含指向 <see cref="T:System.Runtime.InteropServices.ComTypes.FORMATETC" /> 结构的指针（该结构中包含可能用于特定呈现的最常规信息），使其规范地等效于 <c>formatetcIn</c>。</span><span class="sxs-lookup"><span data-stu-id="9dccb-469">When this method returns, contains a pointer to a <see cref="T:System.Runtime.InteropServices.ComTypes.FORMATETC" /> structure that contains the most general information possible for a specific rendering, making it canonically equivalent to <c>formatetcIn</c>.</span></span> <span data-ttu-id="9dccb-470">调用方必须分配此结构，并且 <see cref="M:System.Runtime.InteropServices.ComTypes.IDataObject.GetCanonicalFormatEtc(System.Runtime.InteropServices.ComTypes.FORMATETC@,System.Runtime.InteropServices.ComTypes.FORMATETC@)" /> 方法必须填充数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-470">The caller must allocate this structure and the <see cref="M:System.Runtime.InteropServices.ComTypes.IDataObject.GetCanonicalFormatEtc(System.Runtime.InteropServices.ComTypes.FORMATETC@,System.Runtime.InteropServices.ComTypes.FORMATETC@)" /> method must fill in the data.</span></span> <span data-ttu-id="9dccb-471">为了在后续调用（如 <see cref="M:System.Runtime.InteropServices.ComTypes.IDataObject.GetData(System.Runtime.InteropServices.ComTypes.FORMATETC@,System.Runtime.InteropServices.ComTypes.STGMEDIUM@)" />）中检索数据，调用方将使用提供的 <c>formatOut</c> 值，除非提供的值为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="9dccb-471">To retrieve data in a subsequent call such as <see cref="M:System.Runtime.InteropServices.ComTypes.IDataObject.GetData(System.Runtime.InteropServices.ComTypes.FORMATETC@,System.Runtime.InteropServices.ComTypes.STGMEDIUM@)" />, the caller uses the supplied value of <c>formatOut</c>, unless the value supplied is <see langword="null" />.</span></span> <span data-ttu-id="9dccb-472">如果方法返回 <see langword="null" />，则此值为 <see langword="DATA_S_SAMEFORMATETC" />。</span><span class="sxs-lookup"><span data-stu-id="9dccb-472">This value is <see langword="null" /> if the method returns <see langword="DATA_S_SAMEFORMATETC" />.</span></span> <span data-ttu-id="9dccb-473">在此情况下，<see cref="T:System.Runtime.InteropServices.ComTypes.TYMED" /> 成员并无意义，应将其忽略。</span><span class="sxs-lookup"><span data-stu-id="9dccb-473">The <see cref="T:System.Runtime.InteropServices.ComTypes.TYMED" /> member is not significant in this case and should be ignored.</span></span> <span data-ttu-id="9dccb-474">此参数未经初始化即被传递。</span><span class="sxs-lookup"><span data-stu-id="9dccb-474">This parameter is passed uninitialized.</span></span></param>
        <summary><span data-ttu-id="9dccb-475">提供一个在逻辑上与更复杂的结构等效的标准 <see cref="T:System.Runtime.InteropServices.ComTypes.FORMATETC" /> 结构。</span><span class="sxs-lookup"><span data-stu-id="9dccb-475">Provides a standard <see cref="T:System.Runtime.InteropServices.ComTypes.FORMATETC" /> structure that is logically equivalent to a more complex structure.</span></span> <span data-ttu-id="9dccb-476">使用此方法可以确定两个不同的 <see cref="T:System.Runtime.InteropServices.ComTypes.FORMATETC" /> 结构是否将返回相同的数据，从而无需重复呈现。</span><span class="sxs-lookup"><span data-stu-id="9dccb-476">Use this method to determine whether two different <see cref="T:System.Runtime.InteropServices.ComTypes.FORMATETC" /> structures would return the same data, removing the need for duplicate rendering.</span></span></summary>
        <returns><span data-ttu-id="9dccb-477">此方法支持 E_INVALIDARG、E_UNEXPECTED 和 E_OUTOFMEMORY 等标准返回值，以及下面的值：</span><span class="sxs-lookup"><span data-stu-id="9dccb-477">This method supports the standard return values E_INVALIDARG, E_UNEXPECTED, and E_OUTOFMEMORY, as well as the following:</span></span> 
 <list type="table"><listheader><term> <span data-ttu-id="9dccb-478">值</span><span class="sxs-lookup"><span data-stu-id="9dccb-478">Value</span></span> 
 </term><description> <span data-ttu-id="9dccb-479">说明</span><span class="sxs-lookup"><span data-stu-id="9dccb-479">Description</span></span> 
 </description></listheader><item><term> <span data-ttu-id="9dccb-480">S_OK</span><span class="sxs-lookup"><span data-stu-id="9dccb-480">S_OK</span></span> 
 </term><description> <span data-ttu-id="9dccb-481">返回的 <see cref="T:System.Runtime.InteropServices.ComTypes.FORMATETC" /> 结构与传递的结构不同。</span><span class="sxs-lookup"><span data-stu-id="9dccb-481">The returned <see cref="T:System.Runtime.InteropServices.ComTypes.FORMATETC" /> structure is different from the one that was passed.</span></span>  
  
 </description></item><item><term> <span data-ttu-id="9dccb-482">DATA_S_SAMEFORMATETC</span><span class="sxs-lookup"><span data-stu-id="9dccb-482">DATA_S_SAMEFORMATETC</span></span> 
 </term><description> <span data-ttu-id="9dccb-483"><see cref="T:System.Runtime.InteropServices.ComTypes.FORMATETC" /> 结构都相同，并且在 <paramref name="formatOut" /> 参数中返回 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="9dccb-483">The <see cref="T:System.Runtime.InteropServices.ComTypes.FORMATETC" /> structures are the same and <see langword="null" /> is returned in the <paramref name="formatOut" /> parameter.</span></span>  
  
 </description></item><item><term> <span data-ttu-id="9dccb-484">DV_E_LINDEX</span><span class="sxs-lookup"><span data-stu-id="9dccb-484">DV_E_LINDEX</span></span> 
 </term><description> <span data-ttu-id="9dccb-485"><see cref="F:System.Runtime.InteropServices.ComTypes.FORMATETC.lindex" /> 有一个无效值；当前，只支持 -1。</span><span class="sxs-lookup"><span data-stu-id="9dccb-485">There is an invalid value for <see cref="F:System.Runtime.InteropServices.ComTypes.FORMATETC.lindex" />; currently, only -1 is supported.</span></span>  
  
 </description></item><item><term> <span data-ttu-id="9dccb-486">DV_E_FORMATETC</span><span class="sxs-lookup"><span data-stu-id="9dccb-486">DV_E_FORMATETC</span></span> 
 </term><description> <span data-ttu-id="9dccb-487"><paramref name="pFormatetc" /> 参数有一个无效值。</span><span class="sxs-lookup"><span data-stu-id="9dccb-487">There is an invalid value for the <paramref name="pFormatetc" /> parameter.</span></span>  
  
 </description></item><item><term> <span data-ttu-id="9dccb-488">OLE_E_NOTRUNNING</span><span class="sxs-lookup"><span data-stu-id="9dccb-488">OLE_E_NOTRUNNING</span></span> 
 </term><description> <span data-ttu-id="9dccb-489">应用程序未运行。</span><span class="sxs-lookup"><span data-stu-id="9dccb-489">The application is not running.</span></span>  
  
 </description></item></list></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9dccb-490">此成员是显式接口成员的实现。</span><span class="sxs-lookup"><span data-stu-id="9dccb-490">This member is an explicit interface member implementation.</span></span> <span data-ttu-id="9dccb-491">它只能在 <xref:System.Windows.Forms.DataObject> 被强制转换为 <xref:System.Runtime.InteropServices.ComTypes.IDataObject> 接口时使用。</span><span class="sxs-lookup"><span data-stu-id="9dccb-491">It can be used only when the <xref:System.Windows.Forms.DataObject> is cast to an <xref:System.Runtime.InteropServices.ComTypes.IDataObject> interface.</span></span>  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Security.Permissions.SecurityPermission"><span data-ttu-id="9dccb-492">用于调用非托管代码。</span><span class="sxs-lookup"><span data-stu-id="9dccb-492">for calling unmanaged code.</span></span> <span data-ttu-id="9dccb-493">关联的枚举:<see cref="F:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode" /></span><span class="sxs-lookup"><span data-stu-id="9dccb-493">Associated enumeration: <see cref="F:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode" /></span></span></permission>
      </Docs>
    </Member>
    <Member MemberName="System.Runtime.InteropServices.ComTypes.IDataObject.GetData">
      <MemberSignature Language="C#" Value="void IDataObject.GetData (ref System.Runtime.InteropServices.ComTypes.FORMATETC formatetc, out System.Runtime.InteropServices.ComTypes.STGMEDIUM medium);" />
      <MemberSignature Language="ILAsm" Value=".method hidebysig newslot virtual instance void System.Runtime.InteropServices.ComTypes.IDataObject.GetData(valuetype System.Runtime.InteropServices.ComTypes.FORMATETC&amp; formatetc, [out] valuetype System.Runtime.InteropServices.ComTypes.STGMEDIUM&amp; medium) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.System#Runtime#InteropServices#ComTypes#IDataObject#GetData(System.Runtime.InteropServices.ComTypes.FORMATETC@,System.Runtime.InteropServices.ComTypes.STGMEDIUM@)" />
      <MemberSignature Language="VB.NET" Value="Sub GetData (ByRef formatetc As FORMATETC, ByRef medium As STGMEDIUM) Implements IDataObject.GetData" />
      <MemberSignature Language="C++ CLI" Value=" virtual void System.Runtime.InteropServices.ComTypes.IDataObject.GetData(System::Runtime::InteropServices::ComTypes::FORMATETC % formatetc, [Runtime::InteropServices::Out] System::Runtime::InteropServices::ComTypes::STGMEDIUM % medium) = System::Runtime::InteropServices::ComTypes::IDataObject::GetData;" />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.Runtime.InteropServices.ComTypes.IDataObject.GetData(System.Runtime.InteropServices.ComTypes.FORMATETC@,System.Runtime.InteropServices.ComTypes.STGMEDIUM@)</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="formatetc" Type="System.Runtime.InteropServices.ComTypes.FORMATETC" RefType="ref" Index="0" FrameworkAlternate="netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="medium" Type="System.Runtime.InteropServices.ComTypes.STGMEDIUM" RefType="out" Index="1" FrameworkAlternate="netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="formatetc"><span data-ttu-id="9dccb-494">由引用传递的、指向 <see cref="T:System.Runtime.InteropServices.ComTypes.FORMATETC" /> 结构的指针，该结构定义传递数据时将使用的格式、介质和目标设备。</span><span class="sxs-lookup"><span data-stu-id="9dccb-494">A pointer to a <see cref="T:System.Runtime.InteropServices.ComTypes.FORMATETC" /> structure, passed by reference, that defines the format, medium, and target device to use when passing the data.</span></span> <span data-ttu-id="9dccb-495">使用布尔型 OR 运算符可以指定多个介质，从而允许方法在指定的介质中做出最佳选择。</span><span class="sxs-lookup"><span data-stu-id="9dccb-495">It is possible to specify more than one medium by using the Boolean OR operator, allowing the method to choose the best medium among those specified.</span></span></param>
        <param name="medium"><span data-ttu-id="9dccb-496">此方法返回时，包含一个指向 <see cref="T:System.Runtime.InteropServices.ComTypes.STGMEDIUM" /> 结构的指针，该结构通过其 <see cref="F:System.Runtime.InteropServices.ComTypes.STGMEDIUM.tymed" /> 成员指示包含返回数据的存储介质，并通过其 <see cref="F:System.Runtime.InteropServices.ComTypes.STGMEDIUM.pUnkForRelease" /> 成员的值指示释放介质的责任。</span><span class="sxs-lookup"><span data-stu-id="9dccb-496">When this method returns, contains a pointer to the <see cref="T:System.Runtime.InteropServices.ComTypes.STGMEDIUM" /> structure that indicates the storage medium containing the returned data through its <see cref="F:System.Runtime.InteropServices.ComTypes.STGMEDIUM.tymed" /> member, and the responsibility for releasing the medium through the value of its <see cref="F:System.Runtime.InteropServices.ComTypes.STGMEDIUM.pUnkForRelease" /> member.</span></span> <span data-ttu-id="9dccb-497">如果 <see cref="F:System.Runtime.InteropServices.ComTypes.STGMEDIUM.pUnkForRelease" /> 为 <see langword="null" />，则介质接收方负责释放介质；否则，<see cref="F:System.Runtime.InteropServices.ComTypes.STGMEDIUM.pUnkForRelease" /> 指向相应对象上的 <see langword="IUnknown" /> 接口，以便调用其 <see langword="Release" /> 方法。</span><span class="sxs-lookup"><span data-stu-id="9dccb-497">If <see cref="F:System.Runtime.InteropServices.ComTypes.STGMEDIUM.pUnkForRelease" /> is <see langword="null" />, the receiver of the medium is responsible for releasing it; otherwise, <see cref="F:System.Runtime.InteropServices.ComTypes.STGMEDIUM.pUnkForRelease" /> points to the <see langword="IUnknown" /> interface on the appropriate object so its <see langword="Release" /> method can be called.</span></span> <span data-ttu-id="9dccb-498">介质必须由 <see cref="M:System.Runtime.InteropServices.ComTypes.IDataObject.GetData(System.Runtime.InteropServices.ComTypes.FORMATETC@,System.Runtime.InteropServices.ComTypes.STGMEDIUM@)" /> 进行分配和填充。</span><span class="sxs-lookup"><span data-stu-id="9dccb-498">The medium must be allocated and filled in by <see cref="M:System.Runtime.InteropServices.ComTypes.IDataObject.GetData(System.Runtime.InteropServices.ComTypes.FORMATETC@,System.Runtime.InteropServices.ComTypes.STGMEDIUM@)" />.</span></span> <span data-ttu-id="9dccb-499">此参数未经初始化即被传递。</span><span class="sxs-lookup"><span data-stu-id="9dccb-499">This parameter is passed uninitialized.</span></span></param>
        <summary><span data-ttu-id="9dccb-500">从源数据对象中获取数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-500">Obtains data from a source data object.</span></span> <span data-ttu-id="9dccb-501">数据使用者调用的 <see cref="M:System.Runtime.InteropServices.ComTypes.IDataObject.GetData(System.Runtime.InteropServices.ComTypes.FORMATETC@,System.Runtime.InteropServices.ComTypes.STGMEDIUM@)" /> 方法将呈现指定的 <see cref="T:System.Runtime.InteropServices.ComTypes.FORMATETC" /> 结构中描述的数据，并通过指定的 <see cref="T:System.Runtime.InteropServices.ComTypes.STGMEDIUM" /> 结构传输该数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-501">The <see cref="M:System.Runtime.InteropServices.ComTypes.IDataObject.GetData(System.Runtime.InteropServices.ComTypes.FORMATETC@,System.Runtime.InteropServices.ComTypes.STGMEDIUM@)" /> method, which is called by a data consumer, renders the data described in the specified <see cref="T:System.Runtime.InteropServices.ComTypes.FORMATETC" /> structure and transfers it through the specified <see cref="T:System.Runtime.InteropServices.ComTypes.STGMEDIUM" /> structure.</span></span> <span data-ttu-id="9dccb-502">然后，调用方对释放 <see cref="T:System.Runtime.InteropServices.ComTypes.STGMEDIUM" /> 结构的责任进行假定。</span><span class="sxs-lookup"><span data-stu-id="9dccb-502">The caller then assumes responsibility for releasing the <see cref="T:System.Runtime.InteropServices.ComTypes.STGMEDIUM" /> structure.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9dccb-503">此成员是显式接口成员的实现。</span><span class="sxs-lookup"><span data-stu-id="9dccb-503">This member is an explicit interface member implementation.</span></span> <span data-ttu-id="9dccb-504">它只能在 <xref:System.Windows.Forms.DataObject> 被强制转换为 <xref:System.Runtime.InteropServices.ComTypes.IDataObject> 接口时使用。</span><span class="sxs-lookup"><span data-stu-id="9dccb-504">It can be used only when the <xref:System.Windows.Forms.DataObject> is cast to an <xref:System.Runtime.InteropServices.ComTypes.IDataObject> interface.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.OutOfMemoryException"><span data-ttu-id="9dccb-505">没有足够的内存执行此操作。</span><span class="sxs-lookup"><span data-stu-id="9dccb-505">There is not enough memory to perform this operation.</span></span></exception>
        <permission cref="T:System.Security.Permissions.SecurityPermission"><span data-ttu-id="9dccb-506">用于调用非托管代码。</span><span class="sxs-lookup"><span data-stu-id="9dccb-506">for calling unmanaged code.</span></span> <span data-ttu-id="9dccb-507">关联的枚举:<see cref="F:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode" /></span><span class="sxs-lookup"><span data-stu-id="9dccb-507">Associated enumeration: <see cref="F:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode" /></span></span></permission>
      </Docs>
    </Member>
    <Member MemberName="System.Runtime.InteropServices.ComTypes.IDataObject.GetDataHere">
      <MemberSignature Language="C#" Value="void IDataObject.GetDataHere (ref System.Runtime.InteropServices.ComTypes.FORMATETC formatetc, ref System.Runtime.InteropServices.ComTypes.STGMEDIUM medium);" />
      <MemberSignature Language="ILAsm" Value=".method hidebysig newslot virtual instance void System.Runtime.InteropServices.ComTypes.IDataObject.GetDataHere(valuetype System.Runtime.InteropServices.ComTypes.FORMATETC&amp; formatetc, valuetype System.Runtime.InteropServices.ComTypes.STGMEDIUM&amp; medium) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.System#Runtime#InteropServices#ComTypes#IDataObject#GetDataHere(System.Runtime.InteropServices.ComTypes.FORMATETC@,System.Runtime.InteropServices.ComTypes.STGMEDIUM@)" />
      <MemberSignature Language="VB.NET" Value="Sub GetDataHere (ByRef formatetc As FORMATETC, ByRef medium As STGMEDIUM) Implements IDataObject.GetDataHere" />
      <MemberSignature Language="C++ CLI" Value=" virtual void System.Runtime.InteropServices.ComTypes.IDataObject.GetDataHere(System::Runtime::InteropServices::ComTypes::FORMATETC % formatetc, System::Runtime::InteropServices::ComTypes::STGMEDIUM % medium) = System::Runtime::InteropServices::ComTypes::IDataObject::GetDataHere;" />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.Runtime.InteropServices.ComTypes.IDataObject.GetDataHere(System.Runtime.InteropServices.ComTypes.FORMATETC@,System.Runtime.InteropServices.ComTypes.STGMEDIUM@)</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="formatetc" Type="System.Runtime.InteropServices.ComTypes.FORMATETC" RefType="ref" Index="0" FrameworkAlternate="netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="medium" Type="System.Runtime.InteropServices.ComTypes.STGMEDIUM" RefType="ref" Index="1" FrameworkAlternate="netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="formatetc"><span data-ttu-id="9dccb-508">由引用传递的、指向 <see cref="T:System.Runtime.InteropServices.ComTypes.FORMATETC" /> 结构的指针，该结构定义传递数据时将使用的格式、介质和目标设备。</span><span class="sxs-lookup"><span data-stu-id="9dccb-508">A pointer to a <see cref="T:System.Runtime.InteropServices.ComTypes.FORMATETC" /> structure, passed by reference, that defines the format, medium, and target device to use when passing the data.</span></span> <span data-ttu-id="9dccb-509"><see cref="T:System.Runtime.InteropServices.ComTypes.TYMED" /> 中只能指定一个介质，并且只有下列 <see cref="T:System.Runtime.InteropServices.ComTypes.TYMED" /> 值有效：<see cref="F:System.Runtime.InteropServices.ComTypes.TYMED.TYMED_ISTORAGE" />、<see cref="F:System.Runtime.InteropServices.ComTypes.TYMED.TYMED_ISTREAM" />、<see cref="F:System.Runtime.InteropServices.ComTypes.TYMED.TYMED_HGLOBAL" /> 或 <see cref="F:System.Runtime.InteropServices.ComTypes.TYMED.TYMED_FILE" />。</span><span class="sxs-lookup"><span data-stu-id="9dccb-509">Only one medium can be specified in <see cref="T:System.Runtime.InteropServices.ComTypes.TYMED" />, and only the following <see cref="T:System.Runtime.InteropServices.ComTypes.TYMED" /> values are valid: <see cref="F:System.Runtime.InteropServices.ComTypes.TYMED.TYMED_ISTORAGE" />, <see cref="F:System.Runtime.InteropServices.ComTypes.TYMED.TYMED_ISTREAM" />, <see cref="F:System.Runtime.InteropServices.ComTypes.TYMED.TYMED_HGLOBAL" />, or <see cref="F:System.Runtime.InteropServices.ComTypes.TYMED.TYMED_FILE" />.</span></span></param>
        <param name="medium"><span data-ttu-id="9dccb-510">由引用传递的 <see cref="T:System.Runtime.InteropServices.ComTypes.STGMEDIUM" />，它定义包含正在传输的数据的存储介质。</span><span class="sxs-lookup"><span data-stu-id="9dccb-510">A <see cref="T:System.Runtime.InteropServices.ComTypes.STGMEDIUM" />, passed by reference, that defines the storage medium containing the data being transferred.</span></span> <span data-ttu-id="9dccb-511">介质必须由调用方分配并由 <see cref="M:System.Runtime.InteropServices.ComTypes.IDataObject.GetDataHere(System.Runtime.InteropServices.ComTypes.FORMATETC@,System.Runtime.InteropServices.ComTypes.STGMEDIUM@)" /> 填充。</span><span class="sxs-lookup"><span data-stu-id="9dccb-511">The medium must be allocated by the caller and filled in by <see cref="M:System.Runtime.InteropServices.ComTypes.IDataObject.GetDataHere(System.Runtime.InteropServices.ComTypes.FORMATETC@,System.Runtime.InteropServices.ComTypes.STGMEDIUM@)" />.</span></span> <span data-ttu-id="9dccb-512">调用方还必须释放介质。</span><span class="sxs-lookup"><span data-stu-id="9dccb-512">The caller must also free the medium.</span></span> <span data-ttu-id="9dccb-513">此方法的实现必须始终为此参数指向的 <see cref="F:System.Runtime.InteropServices.ComTypes.STGMEDIUM.pUnkForRelease" /> 结构的 <see cref="T:System.Runtime.InteropServices.ComTypes.STGMEDIUM" /> 成员提供一个 <see langword="null" /> 值。</span><span class="sxs-lookup"><span data-stu-id="9dccb-513">The implementation of this method must always supply a value of <see langword="null" /> for the <see cref="F:System.Runtime.InteropServices.ComTypes.STGMEDIUM.pUnkForRelease" /> member of the <see cref="T:System.Runtime.InteropServices.ComTypes.STGMEDIUM" /> structure that this parameter points to.</span></span></param>
        <summary><span data-ttu-id="9dccb-514">从源数据对象中获取数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-514">Obtains data from a source data object.</span></span> <span data-ttu-id="9dccb-515">数据使用者调用的此方法与 <see cref="M:System.Runtime.InteropServices.ComTypes.IDataObject.GetData(System.Runtime.InteropServices.ComTypes.FORMATETC@,System.Runtime.InteropServices.ComTypes.STGMEDIUM@)" /> 方法的区别在于调用方必须分配并释放指定的存储介质。</span><span class="sxs-lookup"><span data-stu-id="9dccb-515">This method, which is called by a data consumer, differs from the <see cref="M:System.Runtime.InteropServices.ComTypes.IDataObject.GetData(System.Runtime.InteropServices.ComTypes.FORMATETC@,System.Runtime.InteropServices.ComTypes.STGMEDIUM@)" /> method in that the caller must allocate and free the specified storage medium.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9dccb-516">此成员是显式接口成员的实现。</span><span class="sxs-lookup"><span data-stu-id="9dccb-516">This member is an explicit interface member implementation.</span></span> <span data-ttu-id="9dccb-517">它只能在 <xref:System.Windows.Forms.DataObject> 被强制转换为 <xref:System.Runtime.InteropServices.ComTypes.IDataObject> 接口时使用。</span><span class="sxs-lookup"><span data-stu-id="9dccb-517">It can be used only when the <xref:System.Windows.Forms.DataObject> is cast to an <xref:System.Runtime.InteropServices.ComTypes.IDataObject> interface.</span></span>  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Security.Permissions.SecurityPermission"><span data-ttu-id="9dccb-518">用于调用非托管代码。</span><span class="sxs-lookup"><span data-stu-id="9dccb-518">for calling unmanaged code.</span></span> <span data-ttu-id="9dccb-519">关联的枚举:<see cref="F:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode" /></span><span class="sxs-lookup"><span data-stu-id="9dccb-519">Associated enumeration: <see cref="F:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode" /></span></span></permission>
      </Docs>
    </Member>
    <Member MemberName="System.Runtime.InteropServices.ComTypes.IDataObject.QueryGetData">
      <MemberSignature Language="C#" Value="int IDataObject.QueryGetData (ref System.Runtime.InteropServices.ComTypes.FORMATETC formatetc);" />
      <MemberSignature Language="ILAsm" Value=".method hidebysig newslot virtual instance int32 System.Runtime.InteropServices.ComTypes.IDataObject.QueryGetData(valuetype System.Runtime.InteropServices.ComTypes.FORMATETC&amp; formatetc) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.System#Runtime#InteropServices#ComTypes#IDataObject#QueryGetData(System.Runtime.InteropServices.ComTypes.FORMATETC@)" />
      <MemberSignature Language="VB.NET" Value="Function QueryGetData (ByRef formatetc As FORMATETC) As Integer Implements IDataObject.QueryGetData" />
      <MemberSignature Language="C++ CLI" Value=" virtual int System.Runtime.InteropServices.ComTypes.IDataObject.QueryGetData(System::Runtime::InteropServices::ComTypes::FORMATETC % formatetc) = System::Runtime::InteropServices::ComTypes::IDataObject::QueryGetData;" />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.Runtime.InteropServices.ComTypes.IDataObject.QueryGetData(System.Runtime.InteropServices.ComTypes.FORMATETC@)</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="formatetc" Type="System.Runtime.InteropServices.ComTypes.FORMATETC" RefType="ref" Index="0" FrameworkAlternate="netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="formatetc"><span data-ttu-id="9dccb-520">由引用传递的、指向 <see cref="T:System.Runtime.InteropServices.ComTypes.FORMATETC" /> 结构的指针，该结构定义要用于查询的格式、介质和目标设备。</span><span class="sxs-lookup"><span data-stu-id="9dccb-520">A pointer to a <see cref="T:System.Runtime.InteropServices.ComTypes.FORMATETC" /> structure, passed by reference, that defines the format, medium, and target device to use for the query.</span></span></param>
        <summary><span data-ttu-id="9dccb-521">确定数据对象是否能够呈现 <see cref="T:System.Runtime.InteropServices.ComTypes.FORMATETC" /> 结构中所描述的数据。</span><span class="sxs-lookup"><span data-stu-id="9dccb-521">Determines whether the data object is capable of rendering the data described in the <see cref="T:System.Runtime.InteropServices.ComTypes.FORMATETC" /> structure.</span></span> <span data-ttu-id="9dccb-522">尝试执行粘贴或删除操作的对象可以在调用 <see cref="M:System.Runtime.InteropServices.ComTypes.IDataObject.GetData(System.Runtime.InteropServices.ComTypes.FORMATETC@,System.Runtime.InteropServices.ComTypes.STGMEDIUM@)" /> 来获取操作是否成功的指示之前调用此方法。</span><span class="sxs-lookup"><span data-stu-id="9dccb-522">Objects attempting a paste or drop operation can call this method before calling <see cref="M:System.Runtime.InteropServices.ComTypes.IDataObject.GetData(System.Runtime.InteropServices.ComTypes.FORMATETC@,System.Runtime.InteropServices.ComTypes.STGMEDIUM@)" /> to get an indication of whether the operation may be successful.</span></span></summary>
        <returns><span data-ttu-id="9dccb-523">此方法支持 E_INVALIDARG、E_UNEXPECTED 和 E_OUTOFMEMORY 等标准返回值，以及下面的值：</span><span class="sxs-lookup"><span data-stu-id="9dccb-523">This method supports the standard return values E_INVALIDARG, E_UNEXPECTED, and E_OUTOFMEMORY, as well as the following:</span></span> 
 <list type="table"><listheader><term> <span data-ttu-id="9dccb-524">值</span><span class="sxs-lookup"><span data-stu-id="9dccb-524">Value</span></span> 
 </term><description> <span data-ttu-id="9dccb-525">说明</span><span class="sxs-lookup"><span data-stu-id="9dccb-525">Description</span></span> 
 </description></listheader><item><term> <span data-ttu-id="9dccb-526">S_OK</span><span class="sxs-lookup"><span data-stu-id="9dccb-526">S_OK</span></span> 
 </term><description> <span data-ttu-id="9dccb-527">对 <see cref="M:System.Runtime.InteropServices.ComTypes.IDataObject.GetData(System.Runtime.InteropServices.ComTypes.FORMATETC@,System.Runtime.InteropServices.ComTypes.STGMEDIUM@)" /> 的后续调用可能会成功。</span><span class="sxs-lookup"><span data-stu-id="9dccb-527">A subsequent call to <see cref="M:System.Runtime.InteropServices.ComTypes.IDataObject.GetData(System.Runtime.InteropServices.ComTypes.FORMATETC@,System.Runtime.InteropServices.ComTypes.STGMEDIUM@)" /> would probably be successful.</span></span>  
  
 </description></item><item><term> <span data-ttu-id="9dccb-528">DV_E_LINDEX</span><span class="sxs-lookup"><span data-stu-id="9dccb-528">DV_E_LINDEX</span></span> 
 </term><description> <span data-ttu-id="9dccb-529"><see cref="F:System.Runtime.InteropServices.ComTypes.FORMATETC.lindex" /> 的无效值；当前，只支持 -1。</span><span class="sxs-lookup"><span data-stu-id="9dccb-529">An invalid value for <see cref="F:System.Runtime.InteropServices.ComTypes.FORMATETC.lindex" />; currently, only -1 is supported.</span></span>  
  
 </description></item><item><term> <span data-ttu-id="9dccb-530">DV_E_FORMATETC</span><span class="sxs-lookup"><span data-stu-id="9dccb-530">DV_E_FORMATETC</span></span> 
 </term><description> <span data-ttu-id="9dccb-531"><paramref name="pFormatetc" /> 参数的无效值。</span><span class="sxs-lookup"><span data-stu-id="9dccb-531">An invalid value for the <paramref name="pFormatetc" /> parameter.</span></span>  
  
 </description></item><item><term> <span data-ttu-id="9dccb-532">DV_E_TYMED</span><span class="sxs-lookup"><span data-stu-id="9dccb-532">DV_E_TYMED</span></span> 
 </term><description> <span data-ttu-id="9dccb-533">无效的 <see cref="F:System.Runtime.InteropServices.ComTypes.FORMATETC.tymed" /> 值。</span><span class="sxs-lookup"><span data-stu-id="9dccb-533">An invalid <see cref="F:System.Runtime.InteropServices.ComTypes.FORMATETC.tymed" /> value.</span></span>  
  
 </description></item><item><term> <span data-ttu-id="9dccb-534">DV_E_DVASPECT</span><span class="sxs-lookup"><span data-stu-id="9dccb-534">DV_E_DVASPECT</span></span> 
 </term><description> <span data-ttu-id="9dccb-535">无效的 <see cref="F:System.Runtime.InteropServices.ComTypes.FORMATETC.dwAspect" /> 值。</span><span class="sxs-lookup"><span data-stu-id="9dccb-535">An invalid <see cref="F:System.Runtime.InteropServices.ComTypes.FORMATETC.dwAspect" /> value.</span></span>  
  
 </description></item><item><term> <span data-ttu-id="9dccb-536">OLE_E_NOTRUNNING</span><span class="sxs-lookup"><span data-stu-id="9dccb-536">OLE_E_NOTRUNNING</span></span> 
 </term><description> <span data-ttu-id="9dccb-537">应用程序未运行。</span><span class="sxs-lookup"><span data-stu-id="9dccb-537">The application is not running.</span></span>  
  
 </description></item></list></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9dccb-538">此成员是显式接口成员的实现。</span><span class="sxs-lookup"><span data-stu-id="9dccb-538">This member is an explicit interface member implementation.</span></span> <span data-ttu-id="9dccb-539">它只能在 <xref:System.Windows.Forms.DataObject> 被强制转换为 <xref:System.Runtime.InteropServices.ComTypes.IDataObject> 接口时使用。</span><span class="sxs-lookup"><span data-stu-id="9dccb-539">It can be used only when the <xref:System.Windows.Forms.DataObject> is cast to an <xref:System.Runtime.InteropServices.ComTypes.IDataObject> interface.</span></span>  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Security.Permissions.SecurityPermission"><span data-ttu-id="9dccb-540">用于调用非托管代码。</span><span class="sxs-lookup"><span data-stu-id="9dccb-540">for calling unmanaged code.</span></span> <span data-ttu-id="9dccb-541">关联的枚举:<see cref="F:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode" /></span><span class="sxs-lookup"><span data-stu-id="9dccb-541">Associated enumeration: <see cref="F:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode" /></span></span></permission>
      </Docs>
    </Member>
    <Member MemberName="System.Runtime.InteropServices.ComTypes.IDataObject.SetData">
      <MemberSignature Language="C#" Value="void IDataObject.SetData (ref System.Runtime.InteropServices.ComTypes.FORMATETC pFormatetcIn, ref System.Runtime.InteropServices.ComTypes.STGMEDIUM pmedium, bool fRelease);" />
      <MemberSignature Language="ILAsm" Value=".method hidebysig newslot virtual instance void System.Runtime.InteropServices.ComTypes.IDataObject.SetData(valuetype System.Runtime.InteropServices.ComTypes.FORMATETC&amp; pFormatetcIn, valuetype System.Runtime.InteropServices.ComTypes.STGMEDIUM&amp; pmedium, bool fRelease) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.DataObject.System#Runtime#InteropServices#ComTypes#IDataObject#SetData(System.Runtime.InteropServices.ComTypes.FORMATETC@,System.Runtime.InteropServices.ComTypes.STGMEDIUM@,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Sub SetData (ByRef pFormatetcIn As FORMATETC, ByRef pmedium As STGMEDIUM, fRelease As Boolean) Implements IDataObject.SetData" />
      <MemberSignature Language="C++ CLI" Value=" virtual void System.Runtime.InteropServices.ComTypes.IDataObject.SetData(System::Runtime::InteropServices::ComTypes::FORMATETC % pFormatetcIn, System::Runtime::InteropServices::ComTypes::STGMEDIUM % pmedium, bool fRelease) = System::Runtime::InteropServices::ComTypes::IDataObject::SetData;" />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.Runtime.InteropServices.ComTypes.IDataObject.SetData(System.Runtime.InteropServices.ComTypes.FORMATETC@,System.Runtime.InteropServices.ComTypes.STGMEDIUM@,System.Boolean)</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="pFormatetcIn" Type="System.Runtime.InteropServices.ComTypes.FORMATETC" RefType="ref" Index="0" FrameworkAlternate="netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="pmedium" Type="System.Runtime.InteropServices.ComTypes.STGMEDIUM" RefType="ref" Index="1" FrameworkAlternate="netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="fRelease" Type="System.Boolean" Index="2" FrameworkAlternate="netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="pFormatetcIn"><span data-ttu-id="9dccb-542">由引用传递的 <see cref="T:System.Runtime.InteropServices.ComTypes.FORMATETC" /> 结构，该结构定义数据对象在解释存储介质中包含的数据时所使用的格式。</span><span class="sxs-lookup"><span data-stu-id="9dccb-542">A <see cref="T:System.Runtime.InteropServices.ComTypes.FORMATETC" /> structure, passed by reference, that defines the format used by the data object when interpreting the data contained in the storage medium.</span></span></param>
        <param name="pmedium"><span data-ttu-id="9dccb-543">由引用传递的 <see cref="T:System.Runtime.InteropServices.ComTypes.STGMEDIUM" /> 结构，该结构定义其中正在传递数据的存储介质。</span><span class="sxs-lookup"><span data-stu-id="9dccb-543">A <see cref="T:System.Runtime.InteropServices.ComTypes.STGMEDIUM" /> structure, passed by reference, that defines the storage medium in which the data is being passed.</span></span></param>
        <param name="fRelease"><span data-ttu-id="9dccb-544"><see langword="true" /> 指定调用的数据对象，该对象实现 <see cref="M:System.Runtime.InteropServices.ComTypes.IDataObject.SetData(System.Runtime.InteropServices.ComTypes.FORMATETC@,System.Runtime.InteropServices.ComTypes.STGMEDIUM@,System.Boolean)" />，并在调用返回后拥有存储介质。</span><span class="sxs-lookup"><span data-stu-id="9dccb-544"><see langword="true" /> to specify that the data object called, which implements <see cref="M:System.Runtime.InteropServices.ComTypes.IDataObject.SetData(System.Runtime.InteropServices.ComTypes.FORMATETC@,System.Runtime.InteropServices.ComTypes.STGMEDIUM@,System.Boolean)" />, owns the storage medium after the call returns.</span></span> <span data-ttu-id="9dccb-545">这意味着，数据对象在使用介质后，必须调用 <see langword="ReleaseStgMedium" /> 函数来释放该介质。</span><span class="sxs-lookup"><span data-stu-id="9dccb-545">This means that the data object must free the medium after it has been used by calling the <see langword="ReleaseStgMedium" /> function.</span></span> <span data-ttu-id="9dccb-546">如果为 <see langword="false" />，则指定调用方保留存储介质的所有权，所调用的数据对象只能在调用期间使用存储介质。</span><span class="sxs-lookup"><span data-stu-id="9dccb-546"><see langword="false" /> to specify that the caller retains ownership of the storage medium, and the data object called uses the storage medium for the duration of the call only.</span></span></param>
        <summary><span data-ttu-id="9dccb-547">将数据传输至实现此方法的对象。</span><span class="sxs-lookup"><span data-stu-id="9dccb-547">Transfers data to the object that implements this method.</span></span> <span data-ttu-id="9dccb-548">此方法由包含数据源的对象调用。</span><span class="sxs-lookup"><span data-stu-id="9dccb-548">This method is called by an object that contains a data source.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="9dccb-549">此成员是显式接口成员的实现。</span><span class="sxs-lookup"><span data-stu-id="9dccb-549">This member is an explicit interface member implementation.</span></span> <span data-ttu-id="9dccb-550">它只能在 <xref:System.Windows.Forms.DataObject> 被强制转换为 <xref:System.Runtime.InteropServices.ComTypes.IDataObject> 接口时使用。</span><span class="sxs-lookup"><span data-stu-id="9dccb-550">It can be used only when the <xref:System.Windows.Forms.DataObject> is cast to an <xref:System.Runtime.InteropServices.ComTypes.IDataObject> interface.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.NotImplementedException"><span data-ttu-id="9dccb-551">此方法不支持基础数据对象的类型。</span><span class="sxs-lookup"><span data-stu-id="9dccb-551">This method does not support the type of the underlying data object.</span></span></exception>
        <permission cref="T:System.Security.Permissions.SecurityPermission"><span data-ttu-id="9dccb-552">用于调用非托管代码。</span><span class="sxs-lookup"><span data-stu-id="9dccb-552">for calling unmanaged code.</span></span> <span data-ttu-id="9dccb-553">关联的枚举:<see cref="F:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode" /></span><span class="sxs-lookup"><span data-stu-id="9dccb-553">Associated enumeration: <see cref="F:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode" /></span></span></permission>
      </Docs>
    </Member>
  </Members>
</Type>