<Type Name="AutomationInteropProvider" FullName="System.Windows.Automation.Provider.AutomationInteropProvider">
  <Metadata><Meta Name="ms.openlocfilehash" Value="8347ecd651c253d65e23103ecc289019450c98c1" /><Meta Name="ms.sourcegitcommit" Value="055a4a82a0b08bfbdc21bd1347fb71f7fe2c099e" /><Meta Name="ms.translationtype" Value="MT" /><Meta Name="ms.contentlocale" Value="zh-CN" /><Meta Name="ms.lasthandoff" Value="08/15/2019" /><Meta Name="ms.locfileid" Value="69225683" /></Metadata><TypeSignature Language="C#" Value="public static class AutomationInteropProvider" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi abstract sealed beforefieldinit AutomationInteropProvider extends System.Object" />
  <TypeSignature Language="DocId" Value="T:System.Windows.Automation.Provider.AutomationInteropProvider" />
  <TypeSignature Language="VB.NET" Value="Public Class AutomationInteropProvider" />
  <TypeSignature Language="C++ CLI" Value="public ref class AutomationInteropProvider abstract sealed" />
  <TypeSignature Language="F#" Value="type AutomationInteropProvider = class" />
  <AssemblyInfo>
    <AssemblyName>UIAutomationProvider</AssemblyName>
    <AssemblyVersion>3.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Object</BaseTypeName>
  </Base>
  <Interfaces />
  <Docs>
    <summary><span data-ttu-id="21801-101">为 UI 自动化提供程序和 UI 自动化客户端应用程序之间的通信提供支持。</span><span class="sxs-lookup"><span data-stu-id="21801-101">Provides support for communication between UI Automation providers and UI Automation client applications.</span></span></summary>
    <remarks>To be added.</remarks>
  </Docs>
  <Members>
    <Member MemberName="AppendRuntimeId">
      <MemberSignature Language="C#" Value="public const int AppendRuntimeId = 3;" />
      <MemberSignature Language="ILAsm" Value=".field public static literal int32 AppendRuntimeId = (3)" />
      <MemberSignature Language="DocId" Value="F:System.Windows.Automation.Provider.AutomationInteropProvider.AppendRuntimeId" />
      <MemberSignature Language="VB.NET" Value="Public Const AppendRuntimeId As Integer  = 3" />
      <MemberSignature Language="C++ CLI" Value="public: int AppendRuntimeId = 3;" />
      <MemberSignature Language="F#" Value="val mutable AppendRuntimeId : int" Usage="System.Windows.Automation.Provider.AutomationInteropProvider.AppendRuntimeId" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>UIAutomationProvider</AssemblyName>
        <AssemblyVersion>3.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <MemberValue>3</MemberValue>
      <Docs>
        <summary><span data-ttu-id="21801-102">包含一个值，当作为由 UI 自动化提供程序传递到 <see cref="M:System.Windows.Automation.Provider.IRawElementProviderFragment.GetRuntimeId" /> 的数组的第一个元素返回时，指示该 ID 是不完整的，且应该追加到基本提供程序所提供的 ID。</span><span class="sxs-lookup"><span data-stu-id="21801-102">Contains a value that, when returned as the first element of the array passed by the UI Automation provider to <see cref="M:System.Windows.Automation.Provider.IRawElementProviderFragment.GetRuntimeId" />, indicates that the ID is partial and should be appended to the ID provided by the base provider.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21801-103">此字段通常用于在的实现<xref:System.Windows.Automation.Provider.IRawElementProviderFragment.GetRuntimeId%2A>中, 对于不在窗口中直接承载的片段中的元素。</span><span class="sxs-lookup"><span data-stu-id="21801-103">This field is typically used in the implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.GetRuntimeId%2A> for elements in a fragment that are not directly hosted in a window.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="21801-104">下面的示例是列表项的<xref:System.Windows.Automation.Provider.IRawElementProviderFragment.GetRuntimeId%2A?displayProperty=nameWithType>的实现。</span><span class="sxs-lookup"><span data-stu-id="21801-104">The following example is an implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.GetRuntimeId%2A?displayProperty=nameWithType> for a list item.</span></span>  
  
 [!code-csharp[UIAFragmentProvider_snip#101](~/samples/snippets/csharp/VS_Snippets_Wpf/UIAFragmentProvider_snip/CSharp/ListItemFragment.cs#101)]
 [!code-vb[UIAFragmentProvider_snip#101](~/samples/snippets/visualbasic/VS_Snippets_Wpf/UIAFragmentProvider_snip/VisualBasic/ListItemFragment.vb#101)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="ClientsAreListening">
      <MemberSignature Language="C#" Value="public static bool ClientsAreListening { get; }" />
      <MemberSignature Language="ILAsm" Value=".property bool ClientsAreListening" />
      <MemberSignature Language="DocId" Value="P:System.Windows.Automation.Provider.AutomationInteropProvider.ClientsAreListening" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly Property ClientsAreListening As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static property bool ClientsAreListening { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.ClientsAreListening : bool" Usage="System.Windows.Automation.Provider.AutomationInteropProvider.ClientsAreListening" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>UIAutomationProvider</AssemblyName>
        <AssemblyVersion>3.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="21801-105">获取一个值，该值指定是否有任何 UI 自动化客户端应用程序订阅 [!INCLUDE[TLA2#tla_uiautomation](~/includes/tla2sharptla-uiautomation-md.md)] 事件。</span><span class="sxs-lookup"><span data-stu-id="21801-105">Gets a value that specifies whether any UI Automation client application is subscribed to [!INCLUDE[TLA2#tla_uiautomation](~/includes/tla2sharptla-uiautomation-md.md)] events.</span></span></summary>
        <value><span data-ttu-id="21801-106">如果客户端订阅事件，则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="21801-106"><see langword="true" /> if a client is subscribed to events; otherwise <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Examples  
 [!code-csharp[UIAFragmentProvider_snip#122](~/samples/snippets/csharp/VS_Snippets_Wpf/UIAFragmentProvider_snip/CSharp/ListFragment.cs#122)]
 [!code-vb[UIAFragmentProvider_snip#122](~/samples/snippets/visualbasic/VS_Snippets_Wpf/UIAFragmentProvider_snip/VisualBasic/ListFragment.vb#122)]  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/9fe2f01b-f7d8-49a8-a185-d4472b9976c0"><span data-ttu-id="21801-107">从 UI 自动化提供程序中引发事件</span><span class="sxs-lookup"><span data-stu-id="21801-107">Raise Events from a UI Automation Provider</span></span></related>
        <related type="Article" href="https://msdn.microsoft.com/library/69eebd8b-39ed-40e7-93cc-4457c4caf746"><span data-ttu-id="21801-108">UI 自动化事件概述</span><span class="sxs-lookup"><span data-stu-id="21801-108">UI Automation Events Overview</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="HostProviderFromHandle">
      <MemberSignature Language="C#" Value="public static System.Windows.Automation.Provider.IRawElementProviderSimple HostProviderFromHandle (IntPtr hwnd);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Windows.Automation.Provider.IRawElementProviderSimple HostProviderFromHandle(native int hwnd) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle(System.IntPtr)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function HostProviderFromHandle (hwnd As IntPtr) As IRawElementProviderSimple" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Windows::Automation::Provider::IRawElementProviderSimple ^ HostProviderFromHandle(IntPtr hwnd);" />
      <MemberSignature Language="F#" Value="static member HostProviderFromHandle : nativeint -&gt; System.Windows.Automation.Provider.IRawElementProviderSimple" Usage="System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle hwnd" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>UIAutomationProvider</AssemblyName>
        <AssemblyVersion>3.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Windows.Automation.Provider.IRawElementProviderSimple</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="hwnd" Type="System.IntPtr" />
      </Parameters>
      <Docs>
        <param name="hwnd"><span data-ttu-id="21801-109">窗口的句柄。</span><span class="sxs-lookup"><span data-stu-id="21801-109">The handle of the window.</span></span></param>
        <summary><span data-ttu-id="21801-110">返回表示指定的窗口的 UI 自动化提供程序。</span><span class="sxs-lookup"><span data-stu-id="21801-110">Returns a UI Automation provider that represents the specified window.</span></span></summary>
        <returns><span data-ttu-id="21801-111">指定窗口的原始元素提供程序。</span><span class="sxs-lookup"><span data-stu-id="21801-111">The raw element provider for the specified window.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21801-112">此方法返回的接口只能传递回[!INCLUDE[TLA2#tla_uiautomation](~/includes/tla2sharptla-uiautomation-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="21801-112">The interface returned by this method can only be passed back to [!INCLUDE[TLA2#tla_uiautomation](~/includes/tla2sharptla-uiautomation-md.md)].</span></span> <span data-ttu-id="21801-113">尝试调用接口上的方法将引发异常。</span><span class="sxs-lookup"><span data-stu-id="21801-113">Attempting to call a method on the interface will raise an exception.</span></span>  
  
   
  
## Examples  
 [!code-csharp[UIAFragmentProvider_snip#121](~/samples/snippets/csharp/VS_Snippets_Wpf/UIAFragmentProvider_snip/CSharp/ListFragment.cs#121)]
 [!code-vb[UIAFragmentProvider_snip#121](~/samples/snippets/visualbasic/VS_Snippets_Wpf/UIAFragmentProvider_snip/VisualBasic/ListFragment.vb#121)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="InvalidateLimit">
      <MemberSignature Language="C#" Value="public const int InvalidateLimit = 20;" />
      <MemberSignature Language="ILAsm" Value=".field public static literal int32 InvalidateLimit = (20)" />
      <MemberSignature Language="DocId" Value="F:System.Windows.Automation.Provider.AutomationInteropProvider.InvalidateLimit" />
      <MemberSignature Language="VB.NET" Value="Public Const InvalidateLimit As Integer  = 20" />
      <MemberSignature Language="C++ CLI" Value="public: int InvalidateLimit = 20;" />
      <MemberSignature Language="F#" Value="val mutable InvalidateLimit : int" Usage="System.Windows.Automation.Provider.AutomationInteropProvider.InvalidateLimit" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>UIAutomationProvider</AssemblyName>
        <AssemblyVersion>3.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <MemberValue>20</MemberValue>
      <Docs>
        <summary><span data-ttu-id="21801-114">指定在进行批处理之前要发送的最大事件数。</span><span class="sxs-lookup"><span data-stu-id="21801-114">Specifies the maximum number of events to send before batching.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21801-115">此值确定是否为个别事件 ( <xref:System.Windows.Automation.StructureChangeType.ChildAdded>如) 或大容量事件<xref:System.Windows.Automation.StructureChangeType.ChildrenBulkAdded>(例如) 提供通知。</span><span class="sxs-lookup"><span data-stu-id="21801-115">This value determines whether notification is given of individual events such as <xref:System.Windows.Automation.StructureChangeType.ChildAdded> or of bulk events such as <xref:System.Windows.Automation.StructureChangeType.ChildrenBulkAdded>.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="ItemsInvalidateLimit">
      <MemberSignature Language="C#" Value="public const int ItemsInvalidateLimit = 5;" />
      <MemberSignature Language="ILAsm" Value=".field public static literal int32 ItemsInvalidateLimit = (5)" />
      <MemberSignature Language="DocId" Value="F:System.Windows.Automation.Provider.AutomationInteropProvider.ItemsInvalidateLimit" />
      <MemberSignature Language="VB.NET" Value="Public Const ItemsInvalidateLimit As Integer  = 5" />
      <MemberSignature Language="C++ CLI" Value="public: int ItemsInvalidateLimit = 5;" />
      <MemberSignature Language="F#" Value="val mutable ItemsInvalidateLimit : int" Usage="System.Windows.Automation.Provider.AutomationInteropProvider.ItemsInvalidateLimit" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>UIAutomationProvider</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <MemberValue>5</MemberValue>
      <Docs>
        <summary><span data-ttu-id="21801-116">在批处理容器中的项之前要发送的事件的最大数目。</span><span class="sxs-lookup"><span data-stu-id="21801-116">The maximum number of events to send before batching for items in containers.</span></span></summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="RaiseAutomationEvent">
      <MemberSignature Language="C#" Value="public static void RaiseAutomationEvent (System.Windows.Automation.AutomationEvent eventId, System.Windows.Automation.Provider.IRawElementProviderSimple provider, System.Windows.Automation.AutomationEventArgs e);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void RaiseAutomationEvent(class System.Windows.Automation.AutomationEvent eventId, class System.Windows.Automation.Provider.IRawElementProviderSimple provider, class System.Windows.Automation.AutomationEventArgs e) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Automation.Provider.AutomationInteropProvider.RaiseAutomationEvent(System.Windows.Automation.AutomationEvent,System.Windows.Automation.Provider.IRawElementProviderSimple,System.Windows.Automation.AutomationEventArgs)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub RaiseAutomationEvent (eventId As AutomationEvent, provider As IRawElementProviderSimple, e As AutomationEventArgs)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void RaiseAutomationEvent(System::Windows::Automation::AutomationEvent ^ eventId, System::Windows::Automation::Provider::IRawElementProviderSimple ^ provider, System::Windows::Automation::AutomationEventArgs ^ e);" />
      <MemberSignature Language="F#" Value="static member RaiseAutomationEvent : System.Windows.Automation.AutomationEvent * System.Windows.Automation.Provider.IRawElementProviderSimple * System.Windows.Automation.AutomationEventArgs -&gt; unit" Usage="System.Windows.Automation.Provider.AutomationInteropProvider.RaiseAutomationEvent (eventId, provider, e)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>UIAutomationProvider</AssemblyName>
        <AssemblyVersion>3.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="eventId" Type="System.Windows.Automation.AutomationEvent" />
        <Parameter Name="provider" Type="System.Windows.Automation.Provider.IRawElementProviderSimple" />
        <Parameter Name="e" Type="System.Windows.Automation.AutomationEventArgs" />
      </Parameters>
      <Docs>
        <param name="eventId"><span data-ttu-id="21801-117">事件标识符。</span><span class="sxs-lookup"><span data-stu-id="21801-117">The event identifier.</span></span></param>
        <param name="provider"><span data-ttu-id="21801-118">与该事件关联的元素。</span><span class="sxs-lookup"><span data-stu-id="21801-118">The element associated with the event.</span></span></param>
        <param name="e"><span data-ttu-id="21801-119">有关事件的信息。</span><span class="sxs-lookup"><span data-stu-id="21801-119">Information about the event.</span></span></param>
        <summary><span data-ttu-id="21801-120">引发模式事件或自定义事件。</span><span class="sxs-lookup"><span data-stu-id="21801-120">Raises a pattern event or a custom event.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21801-121">模式事件不应仅由模式实现引发。</span><span class="sxs-lookup"><span data-stu-id="21801-121">Pattern events should not be raised just by a pattern implementation.</span></span> <span data-ttu-id="21801-122">例如, <xref:System.Windows.Automation.InvokePatternIdentifiers.InvokedEvent>只要通过<xref:System.Windows.Automation.InvokePattern.Invoke%2A>或通过鼠标或键盘输入调用控件, 就会引发。</span><span class="sxs-lookup"><span data-stu-id="21801-122">For example, an <xref:System.Windows.Automation.InvokePatternIdentifiers.InvokedEvent> should be raised whenever the control is invoked, either through <xref:System.Windows.Automation.InvokePattern.Invoke%2A> or through mouse or keyboard input.</span></span> <span data-ttu-id="21801-123">通过这种方式, 可以向客户端通知系统事件。</span><span class="sxs-lookup"><span data-stu-id="21801-123">In this way, clients can be informed about system events.</span></span>  
  
   
  
## Examples  
 [!code-csharp[UIAFragmentProvider_snip#122](~/samples/snippets/csharp/VS_Snippets_Wpf/UIAFragmentProvider_snip/CSharp/ListFragment.cs#122)]
 [!code-vb[UIAFragmentProvider_snip#122](~/samples/snippets/visualbasic/VS_Snippets_Wpf/UIAFragmentProvider_snip/VisualBasic/ListFragment.vb#122)]  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/9fe2f01b-f7d8-49a8-a185-d4472b9976c0"><span data-ttu-id="21801-124">从 UI 自动化提供程序中引发事件</span><span class="sxs-lookup"><span data-stu-id="21801-124">Raise Events from a UI Automation Provider</span></span></related>
        <related type="Article" href="https://msdn.microsoft.com/library/69eebd8b-39ed-40e7-93cc-4457c4caf746"><span data-ttu-id="21801-125">UI 自动化事件概述</span><span class="sxs-lookup"><span data-stu-id="21801-125">UI Automation Events Overview</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="RaiseAutomationPropertyChangedEvent">
      <MemberSignature Language="C#" Value="public static void RaiseAutomationPropertyChangedEvent (System.Windows.Automation.Provider.IRawElementProviderSimple element, System.Windows.Automation.AutomationPropertyChangedEventArgs e);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void RaiseAutomationPropertyChangedEvent(class System.Windows.Automation.Provider.IRawElementProviderSimple element, class System.Windows.Automation.AutomationPropertyChangedEventArgs e) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Automation.Provider.AutomationInteropProvider.RaiseAutomationPropertyChangedEvent(System.Windows.Automation.Provider.IRawElementProviderSimple,System.Windows.Automation.AutomationPropertyChangedEventArgs)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub RaiseAutomationPropertyChangedEvent (element As IRawElementProviderSimple, e As AutomationPropertyChangedEventArgs)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void RaiseAutomationPropertyChangedEvent(System::Windows::Automation::Provider::IRawElementProviderSimple ^ element, System::Windows::Automation::AutomationPropertyChangedEventArgs ^ e);" />
      <MemberSignature Language="F#" Value="static member RaiseAutomationPropertyChangedEvent : System.Windows.Automation.Provider.IRawElementProviderSimple * System.Windows.Automation.AutomationPropertyChangedEventArgs -&gt; unit" Usage="System.Windows.Automation.Provider.AutomationInteropProvider.RaiseAutomationPropertyChangedEvent (element, e)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>UIAutomationProvider</AssemblyName>
        <AssemblyVersion>3.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="element" Type="System.Windows.Automation.Provider.IRawElementProviderSimple" />
        <Parameter Name="e" Type="System.Windows.Automation.AutomationPropertyChangedEventArgs" />
      </Parameters>
      <Docs>
        <param name="element"><span data-ttu-id="21801-126">与该事件关联的元素。</span><span class="sxs-lookup"><span data-stu-id="21801-126">The element associated with the event.</span></span></param>
        <param name="e"><span data-ttu-id="21801-127">有关事件的信息。</span><span class="sxs-lookup"><span data-stu-id="21801-127">Information about the event.</span></span></param>
        <summary><span data-ttu-id="21801-128">[!INCLUDE[TLA2#tla_uiautomation](~/includes/tla2sharptla-uiautomation-md.md)] 属性更改时引发事件。</span><span class="sxs-lookup"><span data-stu-id="21801-128">Raises an event when a [!INCLUDE[TLA2#tla_uiautomation](~/includes/tla2sharptla-uiautomation-md.md)] property has changed.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Examples  
 [!code-csharp[UIAFragmentProvider_snip#123](~/samples/snippets/csharp/VS_Snippets_Wpf/UIAFragmentProvider_snip/CSharp/ListFragment.cs#123)]
 [!code-vb[UIAFragmentProvider_snip#123](~/samples/snippets/visualbasic/VS_Snippets_Wpf/UIAFragmentProvider_snip/VisualBasic/ListFragment.vb#123)]  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/9fe2f01b-f7d8-49a8-a185-d4472b9976c0"><span data-ttu-id="21801-129">从 UI 自动化提供程序中引发事件</span><span class="sxs-lookup"><span data-stu-id="21801-129">Raise Events from a UI Automation Provider</span></span></related>
        <related type="Article" href="https://msdn.microsoft.com/library/69eebd8b-39ed-40e7-93cc-4457c4caf746"><span data-ttu-id="21801-130">UI 自动化事件概述</span><span class="sxs-lookup"><span data-stu-id="21801-130">UI Automation Events Overview</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="RaiseStructureChangedEvent">
      <MemberSignature Language="C#" Value="public static void RaiseStructureChangedEvent (System.Windows.Automation.Provider.IRawElementProviderSimple provider, System.Windows.Automation.StructureChangedEventArgs e);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void RaiseStructureChangedEvent(class System.Windows.Automation.Provider.IRawElementProviderSimple provider, class System.Windows.Automation.StructureChangedEventArgs e) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Automation.Provider.AutomationInteropProvider.RaiseStructureChangedEvent(System.Windows.Automation.Provider.IRawElementProviderSimple,System.Windows.Automation.StructureChangedEventArgs)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub RaiseStructureChangedEvent (provider As IRawElementProviderSimple, e As StructureChangedEventArgs)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void RaiseStructureChangedEvent(System::Windows::Automation::Provider::IRawElementProviderSimple ^ provider, System::Windows::Automation::StructureChangedEventArgs ^ e);" />
      <MemberSignature Language="F#" Value="static member RaiseStructureChangedEvent : System.Windows.Automation.Provider.IRawElementProviderSimple * System.Windows.Automation.StructureChangedEventArgs -&gt; unit" Usage="System.Windows.Automation.Provider.AutomationInteropProvider.RaiseStructureChangedEvent (provider, e)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>UIAutomationProvider</AssemblyName>
        <AssemblyVersion>3.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="provider" Type="System.Windows.Automation.Provider.IRawElementProviderSimple" />
        <Parameter Name="e" Type="System.Windows.Automation.StructureChangedEventArgs" />
      </Parameters>
      <Docs>
        <param name="provider"><span data-ttu-id="21801-131">与该事件关联的元素。</span><span class="sxs-lookup"><span data-stu-id="21801-131">The element associated with the event.</span></span></param>
        <param name="e"><span data-ttu-id="21801-132">有关事件的信息。</span><span class="sxs-lookup"><span data-stu-id="21801-132">Information about the event.</span></span></param>
        <summary><span data-ttu-id="21801-133">[!INCLUDE[TLA2#tla_uiautomation](~/includes/tla2sharptla-uiautomation-md.md)] 树更改时引发事件。</span><span class="sxs-lookup"><span data-stu-id="21801-133">Raises an event when the [!INCLUDE[TLA2#tla_uiautomation](~/includes/tla2sharptla-uiautomation-md.md)] tree has changed.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="21801-134">树结构中更改的一个示例是在列表框中添加或删除子元素, 或在树视图中展开或折叠子元素。</span><span class="sxs-lookup"><span data-stu-id="21801-134">An example of a change in the tree structure is child elements being added to or removed from a list box, or being expanded or collapsed in a tree view.</span></span>  
  
 <span data-ttu-id="21801-135">删除子元素时, 元素或其容器的运行时标识符将传递到<xref:System.Windows.Automation.StructureChangedEventArgs>构造函数。</span><span class="sxs-lookup"><span data-stu-id="21801-135">When a child element is removed, the runtime identifier of either the element, or of its container, is passed to the <xref:System.Windows.Automation.StructureChangedEventArgs> constructor.</span></span> <span data-ttu-id="21801-136">但在的当前版本[!INCLUDE[TLA2#tla_uiautomation](~/includes/tla2sharptla-uiautomation-md.md)]中, 提供程序的实例无法找到其运行时标识符。</span><span class="sxs-lookup"><span data-stu-id="21801-136">In the current version of [!INCLUDE[TLA2#tla_uiautomation](~/includes/tla2sharptla-uiautomation-md.md)], however, there is no easy way for an instance of a provider to discover its runtime identifier.</span></span> <span data-ttu-id="21801-137">方法通常返回一个数组, 该数组<xref:System.Windows.Automation.Provider.AutomationInteropProvider.AppendRuntimeId>包含一个[!INCLUDE[TLA2#tla_uiautomation](~/includes/tla2sharptla-uiautomation-md.md)]幻数, 指示系统为控件的每个实例创建唯一标识符。 <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.GetRuntimeId%2A></span><span class="sxs-lookup"><span data-stu-id="21801-137">The <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.GetRuntimeId%2A> method normally returns an array that contains <xref:System.Windows.Automation.Provider.AutomationInteropProvider.AppendRuntimeId>, a magic number that instructs the [!INCLUDE[TLA2#tla_uiautomation](~/includes/tla2sharptla-uiautomation-md.md)] system to create a unique identifer for every instance of the control.</span></span> <span data-ttu-id="21801-138">提供的原始值不<xref:System.Windows.Automation.Provider.IRawElementProviderFragment.GetRuntimeId%2A>应在事件中使用, 因为它对客户端无意义, 并且不能用于标识特定的实例。</span><span class="sxs-lookup"><span data-stu-id="21801-138">The raw value provided by <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.GetRuntimeId%2A> should not be used in events, because it is meaningless to clients and cannot be used to identify a specific instance.</span></span>  
  
 <span data-ttu-id="21801-139">由于此限制, 类型<xref:System.Windows.Automation.StructureChangeType.ChildAdded>为和的事件并<xref:System.Windows.Automation.StructureChangeType.ChildRemoved>不是很有用。</span><span class="sxs-lookup"><span data-stu-id="21801-139">Because of this limitation, events of type <xref:System.Windows.Automation.StructureChangeType.ChildAdded> and <xref:System.Windows.Automation.StructureChangeType.ChildRemoved> are not very useful.</span></span> <span data-ttu-id="21801-140">作为替代方法, 请始终<xref:System.Windows.Automation.StructureChangeType.ChildrenBulkAdded>使用<xref:System.Windows.Automation.StructureChangeType.ChildrenBulkRemoved>和, 传递0作为运行时标识符。</span><span class="sxs-lookup"><span data-stu-id="21801-140">As an alternative, always use <xref:System.Windows.Automation.StructureChangeType.ChildrenBulkAdded> and <xref:System.Windows.Automation.StructureChangeType.ChildrenBulkRemoved>, passing 0 as the runtime identifer.</span></span> <span data-ttu-id="21801-141">不能使用`null`, 因为这会引发异常。</span><span class="sxs-lookup"><span data-stu-id="21801-141">You cannot use `null`, as this will raise an exception.</span></span> <span data-ttu-id="21801-142">将通知客户端已在容器中进行了更改 (由`sender`传递到的<xref:System.Windows.Automation.StructureChangedEventHandler>参数标识), 而无需特别通知添加或删除了哪些子项。</span><span class="sxs-lookup"><span data-stu-id="21801-142">Clients will be notified that a change has been made in the container (identified by the `sender` parameter passed to the <xref:System.Windows.Automation.StructureChangedEventHandler>), without specific notice of what children have been added or removed.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="21801-143">下面的示例演示如何在自定义列表框中添加或移除子级时引发事件。</span><span class="sxs-lookup"><span data-stu-id="21801-143">The following example shows how to raise an event when children are added to, or removed from, a custom list box.</span></span>  
  
 [!code-csharp[FragmentProvider#101](~/samples/snippets/csharp/VS_Snippets_Wpf/FragmentProvider/CSharp/ListFragment.cs#101)]
 [!code-vb[FragmentProvider#101](~/samples/snippets/visualbasic/VS_Snippets_Wpf/FragmentProvider/VisualBasic/ListFragment.vb#101)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Windows.Automation.StructureChangedEventArgs.#ctor(System.Windows.Automation.StructureChangeType,System.Int32[])" />
        <related type="Article" href="https://msdn.microsoft.com/library/69eebd8b-39ed-40e7-93cc-4457c4caf746"><span data-ttu-id="21801-144">UI 自动化事件概述</span><span class="sxs-lookup"><span data-stu-id="21801-144">UI Automation Events Overview</span></span></related>
        <related type="Article" href="https://msdn.microsoft.com/library/9fe2f01b-f7d8-49a8-a185-d4472b9976c0"><span data-ttu-id="21801-145">从 UI 自动化提供程序中引发事件</span><span class="sxs-lookup"><span data-stu-id="21801-145">Raise Events from a UI Automation Provider</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="ReturnRawElementProvider">
      <MemberSignature Language="C#" Value="public static IntPtr ReturnRawElementProvider (IntPtr hwnd, IntPtr wParam, IntPtr lParam, System.Windows.Automation.Provider.IRawElementProviderSimple el);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig native int ReturnRawElementProvider(native int hwnd, native int wParam, native int lParam, class System.Windows.Automation.Provider.IRawElementProviderSimple el) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Automation.Provider.AutomationInteropProvider.ReturnRawElementProvider(System.IntPtr,System.IntPtr,System.IntPtr,System.Windows.Automation.Provider.IRawElementProviderSimple)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function ReturnRawElementProvider (hwnd As IntPtr, wParam As IntPtr, lParam As IntPtr, el As IRawElementProviderSimple) As IntPtr" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static IntPtr ReturnRawElementProvider(IntPtr hwnd, IntPtr wParam, IntPtr lParam, System::Windows::Automation::Provider::IRawElementProviderSimple ^ el);" />
      <MemberSignature Language="F#" Value="static member ReturnRawElementProvider : nativeint * nativeint * nativeint * System.Windows.Automation.Provider.IRawElementProviderSimple -&gt; nativeint" Usage="System.Windows.Automation.Provider.AutomationInteropProvider.ReturnRawElementProvider (hwnd, wParam, lParam, el)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>UIAutomationProvider</AssemblyName>
        <AssemblyVersion>3.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IntPtr</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="hwnd" Type="System.IntPtr" />
        <Parameter Name="wParam" Type="System.IntPtr" />
        <Parameter Name="lParam" Type="System.IntPtr" />
        <Parameter Name="el" Type="System.Windows.Automation.Provider.IRawElementProviderSimple" />
      </Parameters>
      <Docs>
        <param name="hwnd"><span data-ttu-id="21801-146">元素窗口的句柄。</span><span class="sxs-lookup"><span data-stu-id="21801-146">Handle of the element's window.</span></span></param>
        <param name="wParam"><span data-ttu-id="21801-147"><see langword="WM_GETOBJECT" /> 消息的 <see langword="wParam" /> 成员。</span><span class="sxs-lookup"><span data-stu-id="21801-147">The <see langword="wParam" /> member of the <see langword="WM_GETOBJECT" /> message.</span></span></param>
        <param name="lParam"><span data-ttu-id="21801-148"><see langword="WM_GETOBJECT" /> 消息的 <see langword="lParam" /> 成员。</span><span class="sxs-lookup"><span data-stu-id="21801-148">The <see langword="lParam" /> member of the <see langword="WM_GETOBJECT" /> message.</span></span></param>
        <param name="el"><span data-ttu-id="21801-149">元素的 UI 自动化提供程序。</span><span class="sxs-lookup"><span data-stu-id="21801-149">The UI Automation provider for the element.</span></span></param>
        <summary><span data-ttu-id="21801-150">返回响应 <see langword="WM_GETOBJECT" /> 消息的元素的 UI 自动化提供程序。</span><span class="sxs-lookup"><span data-stu-id="21801-150">Returns the UI automation provider for an element in response to a <see langword="WM_GETOBJECT" /> message.</span></span></summary>
        <returns><span data-ttu-id="21801-151">将消息传递给基窗口过程之前应分配给 <see cref="P:System.Windows.Forms.Message.Result" /> 的数据的指针。</span><span class="sxs-lookup"><span data-stu-id="21801-151">A pointer to data that should be assigned to <see cref="P:System.Windows.Forms.Message.Result" /> before passing the message to the base window procedure.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Examples  
 [!code-csharp[UIAFragmentProvider_snip#116](~/samples/snippets/csharp/VS_Snippets_Wpf/UIAFragmentProvider_snip/CSharp/ListFragment.cs#116)]
 [!code-vb[UIAFragmentProvider_snip#116](~/samples/snippets/visualbasic/VS_Snippets_Wpf/UIAFragmentProvider_snip/VisualBasic/ListFragment.vb#116)]  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/55d419c0-2201-4101-90c9-2888df4dbb47"><span data-ttu-id="21801-152">公开 UI 自动化提供程序</span><span class="sxs-lookup"><span data-stu-id="21801-152">Expose a UI Automation Provider</span></span></related>
        <related type="Article" href="https://msdn.microsoft.com/library/6acc6d08-bd67-4e2e-915c-9c1d34eb86fe"><span data-ttu-id="21801-153">服务器端 UI 自动化提供程序实现</span><span class="sxs-lookup"><span data-stu-id="21801-153">Server-side UI Automation Provider Implementation</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="RootObjectId">
      <MemberSignature Language="C#" Value="public const int RootObjectId = -25;" />
      <MemberSignature Language="ILAsm" Value=".field public static literal int32 RootObjectId = (-25)" />
      <MemberSignature Language="DocId" Value="F:System.Windows.Automation.Provider.AutomationInteropProvider.RootObjectId" />
      <MemberSignature Language="VB.NET" Value="Public Const RootObjectId As Integer  = -25" />
      <MemberSignature Language="C++ CLI" Value="public: int RootObjectId = -25;" />
      <MemberSignature Language="F#" Value="val mutable RootObjectId : int" Usage="System.Windows.Automation.Provider.AutomationInteropProvider.RootObjectId" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>UIAutomationProvider</AssemblyName>
        <AssemblyVersion>3.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <MemberValue>-25</MemberValue>
      <Docs>
        <summary><span data-ttu-id="21801-154">包含一个值，该值用在 <see langword="lParam" /> 消息的 <see langword="WM_GETOBJECT" /> 成员中，指出服务器应该返回一个对根原始元素提供程序的引用。</span><span class="sxs-lookup"><span data-stu-id="21801-154">Contains a value used in the <see langword="lParam" /> member of a <see langword="WM_GETOBJECT" /> message, indicating that the server should return a reference to the root raw element provider.</span></span></summary>
        <remarks>To be added.</remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/55d419c0-2201-4101-90c9-2888df4dbb47"><span data-ttu-id="21801-155">公开 UI 自动化提供程序</span><span class="sxs-lookup"><span data-stu-id="21801-155">Expose a UI Automation Provider</span></span></related>
      </Docs>
    </Member>
  </Members>
</Type>
