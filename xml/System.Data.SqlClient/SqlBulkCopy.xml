<Type Name="SqlBulkCopy" FullName="System.Data.SqlClient.SqlBulkCopy">
  <Metadata><Meta Name="ms.openlocfilehash" Value="4caaf2e6bb3af18f4c4cf0168456a2dbe1ee0d16" /><Meta Name="ms.sourcegitcommit" Value="055a4a82a0b08bfbdc21bd1347fb71f7fe2c099e" /><Meta Name="ms.translationtype" Value="MT" /><Meta Name="ms.contentlocale" Value="zh-CN" /><Meta Name="ms.lasthandoff" Value="08/15/2019" /><Meta Name="ms.locfileid" Value="69123647" /></Metadata><TypeSignature Language="C#" Value="public sealed class SqlBulkCopy : IDisposable" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi sealed beforefieldinit SqlBulkCopy extends System.Object implements class System.IDisposable" />
  <TypeSignature Language="DocId" Value="T:System.Data.SqlClient.SqlBulkCopy" />
  <TypeSignature Language="VB.NET" Value="Public NotInheritable Class SqlBulkCopy&#xA;Implements IDisposable" />
  <TypeSignature Language="C++ CLI" Value="public ref class SqlBulkCopy sealed : IDisposable" />
  <TypeSignature Language="F#" Value="type SqlBulkCopy = class&#xA;    interface IDisposable" />
  <AssemblyInfo>
    <AssemblyName>System.Data.SqlClient</AssemblyName>
    <AssemblyVersion>4.1.0.0</AssemblyVersion>
    <AssemblyVersion>4.2.0.0</AssemblyVersion>
    <AssemblyVersion>4.4.0.0</AssemblyVersion>
    <AssemblyVersion>4.5.0.0</AssemblyVersion>
    <AssemblyVersion>4.6.0.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>System.Data</AssemblyName>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
    <AssemblyVersion>2.0.5.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>netstandard</AssemblyName>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Object</BaseTypeName>
  </Base>
  <Interfaces>
    <Interface>
      <InterfaceName>System.IDisposable</InterfaceName>
    </Interface>
  </Interfaces>
  <Docs>
    <summary><span data-ttu-id="311f5-101">使您可以用其他源的数据有效批量加载 SQL Server 表。</span><span class="sxs-lookup"><span data-stu-id="311f5-101">Lets you efficiently bulk load a SQL Server table with data from another source.</span></span></summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="311f5-102">Microsoft SQL Server 包含一个用于将数据从一个表移到另一个表的常用命令提示实用工具, 无论是在单个服务器上还是在服务器之间。</span><span class="sxs-lookup"><span data-stu-id="311f5-102">Microsoft SQL Server includes a popular command-prompt utility named **bcp** for moving data from one table to another, whether on a single server or between servers.</span></span> <span data-ttu-id="311f5-103"><xref:System.Data.SqlClient.SqlBulkCopy>类可让你编写提供类似功能的托管代码解决方案。</span><span class="sxs-lookup"><span data-stu-id="311f5-103">The <xref:System.Data.SqlClient.SqlBulkCopy> class lets you write managed code solutions that provide similar functionality.</span></span> <span data-ttu-id="311f5-104">还可以通过其他方式将数据加载到 SQL Server 表中 (例如 INSERT 语句), 但<xref:System.Data.SqlClient.SqlBulkCopy>在它们之间提供显著的性能优势。</span><span class="sxs-lookup"><span data-stu-id="311f5-104">There are other ways to load data into a SQL Server table (INSERT statements, for example), but <xref:System.Data.SqlClient.SqlBulkCopy> offers a significant performance advantage over them.</span></span>  
  
 <span data-ttu-id="311f5-105"><xref:System.Data.SqlClient.SqlBulkCopy> 类只能用于向 SQL Server 表中写入数据。</span><span class="sxs-lookup"><span data-stu-id="311f5-105">The <xref:System.Data.SqlClient.SqlBulkCopy> class can be used to write data only to SQL Server tables.</span></span> <span data-ttu-id="311f5-106">但是, 数据源不限于 SQL Server;可以使用任何数据源, 只要可将数据加载到<xref:System.Data.DataTable>实例或<xref:System.Data.IDataReader>使用实例进行读取。</span><span class="sxs-lookup"><span data-stu-id="311f5-106">However, the data source is not limited to SQL Server; any data source can be used, as long as the data can be loaded to a <xref:System.Data.DataTable> instance or read with a <xref:System.Data.IDataReader> instance.</span></span>  
  
 <span data-ttu-id="311f5-107"><xref:System.Data.SqlClient.SqlBulkCopy>将类型<xref:System.Data.DataTable> <xref:System.Data.SqlTypes.SqlDateTime>的列大容量加载到 SQL Server 列时将失败, 其类型为 SQL Server 2008 中添加的日期/时间类型之一。</span><span class="sxs-lookup"><span data-stu-id="311f5-107"><xref:System.Data.SqlClient.SqlBulkCopy> will fail when bulk loading a <xref:System.Data.DataTable> column of type <xref:System.Data.SqlTypes.SqlDateTime> into a SQL Server column whose type is one of the date/time types added in SQL Server 2008.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="311f5-108">以下控制台应用程序演示如何使用 <xref:System.Data.SqlClient.SqlBulkCopy> 类加载数据。</span><span class="sxs-lookup"><span data-stu-id="311f5-108">The following console application demonstrates how to load data using the <xref:System.Data.SqlClient.SqlBulkCopy> class.</span></span> <span data-ttu-id="311f5-109">在此示例中, <xref:System.Data.SqlClient.SqlDataReader>用于将数据从 SQL Server **AdventureWorks**数据库中的**Product**表复制到同一个数据库中的类似表。</span><span class="sxs-lookup"><span data-stu-id="311f5-109">In this example, a <xref:System.Data.SqlClient.SqlDataReader> is used to copy data from the **Production.Product** table in the SQL Server **AdventureWorks** database to a similar table in the same database.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="311f5-110">除非已按照[大容量复制示例设置](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md)中所述创建了工作表, 否则此示例将不会运行。</span><span class="sxs-lookup"><span data-stu-id="311f5-110">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="311f5-111">提供此代码是为了演示仅使用**SqlBulkCopy**的语法。</span><span class="sxs-lookup"><span data-stu-id="311f5-111">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="311f5-112">如果源表和目标表位于同一个 SQL Server 实例中, 则使用 transact-sql `INSERT … SELECT`语句复制数据会更加简单快捷。</span><span class="sxs-lookup"><span data-stu-id="311f5-112">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks BulkCopy.Single#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks BulkCopy.Single/CS/source.cs#1)]
 [!code-vb[DataWorks BulkCopy.Single#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks BulkCopy.Single/VB/source.vb#1)]  
  
 ]]></format>
    </remarks>
    <related type="Article" href="https://msdn.microsoft.com/library/83a7a0d2-8018-4354-97b9-0b1d99f8342b"><span data-ttu-id="311f5-113">执行大容量复制操作</span><span class="sxs-lookup"><span data-stu-id="311f5-113">Performing Bulk Copy Operations</span></span></related>
    <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="311f5-114">ADO.NET 概述</span><span class="sxs-lookup"><span data-stu-id="311f5-114">ADO.NET Overview</span></span></related>
  </Docs>
  <Members>
    <MemberGroup MemberName=".ctor">
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="311f5-115">初始化 <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> 类的新实例。</span><span class="sxs-lookup"><span data-stu-id="311f5-115">Initializes a new instance of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> class.</span></span></summary>
        <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="311f5-116">ADO.NET 概述</span><span class="sxs-lookup"><span data-stu-id="311f5-116">ADO.NET Overview</span></span></related>
      </Docs>
    </MemberGroup>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public SqlBulkCopy (System.Data.SqlClient.SqlConnection connection);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(class System.Data.SqlClient.SqlConnection connection) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (connection As SqlConnection)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; SqlBulkCopy(System::Data::SqlClient::SqlConnection ^ connection);" />
      <MemberSignature Language="F#" Value="new System.Data.SqlClient.SqlBulkCopy : System.Data.SqlClient.SqlConnection -&gt; System.Data.SqlClient.SqlBulkCopy" Usage="new System.Data.SqlClient.SqlBulkCopy connection" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="connection" Type="System.Data.SqlClient.SqlConnection" />
      </Parameters>
      <Docs>
        <param name="connection"><span data-ttu-id="311f5-117">将用于执行批量复制操作的已经打开的 <see cref="T:System.Data.SqlClient.SqlConnection" /> 实例。</span><span class="sxs-lookup"><span data-stu-id="311f5-117">The already open <see cref="T:System.Data.SqlClient.SqlConnection" /> instance that will be used to perform the bulk copy operation.</span></span> <span data-ttu-id="311f5-118">如果连接字符串不使用 <see langword="Integrated Security = true" />，可以使用 <see cref="T:System.Data.SqlClient.SqlCredential" /> 来通过用户 ID 和密码比在连接字符串的文本中指定用户 ID 和密码更安全。</span><span class="sxs-lookup"><span data-stu-id="311f5-118">If your connection string does not use <see langword="Integrated Security = true" />, you can use <see cref="T:System.Data.SqlClient.SqlCredential" /> to pass the user ID and password more securely than by specifying the user ID and password as text in the connection string.</span></span></param>
        <summary><span data-ttu-id="311f5-119">使用 <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> 的指定打开实例初始化 <see cref="T:System.Data.SqlClient.SqlConnection" /> 类的新实例。</span><span class="sxs-lookup"><span data-stu-id="311f5-119">Initializes a new instance of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> class using the specified open instance of <see cref="T:System.Data.SqlClient.SqlConnection" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="311f5-120">由于在初始化<xref:System.Data.SqlClient.SqlBulkCopy>实例时连接已打开, 因此在<xref:System.Data.SqlClient.SqlBulkCopy>实例关闭后, 连接保持打开状态。</span><span class="sxs-lookup"><span data-stu-id="311f5-120">Because the connection is already open when the <xref:System.Data.SqlClient.SqlBulkCopy> instance is initialized, the connection remains open after the <xref:System.Data.SqlClient.SqlBulkCopy> instance is closed.</span></span>  
  
 <span data-ttu-id="311f5-121">如果参数为 null <xref:System.ArgumentNullException> , 则引发。 `connection`</span><span class="sxs-lookup"><span data-stu-id="311f5-121">If the `connection` argument is null, an <xref:System.ArgumentNullException> is thrown.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="311f5-122">下面的控制台应用程序演示如何使用已打开的连接大容量加载数据。</span><span class="sxs-lookup"><span data-stu-id="311f5-122">The following console application demonstrates how to bulk load data using a connection that is already open.</span></span> <span data-ttu-id="311f5-123">在此示例中, <xref:System.Data.SqlClient.SqlDataReader>用于将数据从 SQL Server **AdventureWorks**数据库中的**Product**表复制到同一个数据库中的类似表。</span><span class="sxs-lookup"><span data-stu-id="311f5-123">In this example, a <xref:System.Data.SqlClient.SqlDataReader> is used to copy data from the **Production.Product** table in the SQL Server **AdventureWorks** database to a similar table in the same database.</span></span> <span data-ttu-id="311f5-124">此示例只为了方便本文演示。</span><span class="sxs-lookup"><span data-stu-id="311f5-124">This example is for demonstration purposes only.</span></span> <span data-ttu-id="311f5-125">在生产应用程序`SqlBulkCopy`中, 不能使用将数据从一个表移到同一个数据库中的另一个表。</span><span class="sxs-lookup"><span data-stu-id="311f5-125">You would not use `SqlBulkCopy` to move data from one table to another in the same database in a production application.</span></span> <span data-ttu-id="311f5-126">请注意, 源数据不必位于 SQL Server 上;可以使用任何可读取到或已<xref:System.Data.IDataReader>加载到的<xref:System.Data.DataTable>数据源。</span><span class="sxs-lookup"><span data-stu-id="311f5-126">Note that the source data does not have to be located on SQL Server; you can use any data source that can be read to an <xref:System.Data.IDataReader> or loaded to a <xref:System.Data.DataTable>.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="311f5-127">除非已按照[大容量复制示例设置](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md)中所述创建了工作表, 否则此示例将不会运行。</span><span class="sxs-lookup"><span data-stu-id="311f5-127">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="311f5-128">提供此代码是为了演示仅使用**SqlBulkCopy**的语法。</span><span class="sxs-lookup"><span data-stu-id="311f5-128">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="311f5-129">如果源表和目标表位于同一个 SQL Server 实例中, 则使用 transact-sql `INSERT … SELECT`语句复制数据会更加简单快捷。</span><span class="sxs-lookup"><span data-stu-id="311f5-129">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks BulkCopy.Single#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks BulkCopy.Single/CS/source.cs#1)]
 [!code-vb[DataWorks BulkCopy.Single#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks BulkCopy.Single/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/83a7a0d2-8018-4354-97b9-0b1d99f8342b"><span data-ttu-id="311f5-130">执行大容量复制操作</span><span class="sxs-lookup"><span data-stu-id="311f5-130">Performing Bulk Copy Operations</span></span></related>
        <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="311f5-131">ADO.NET 概述</span><span class="sxs-lookup"><span data-stu-id="311f5-131">ADO.NET Overview</span></span></related>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public SqlBulkCopy (string connectionString);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string connectionString) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (connectionString As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; SqlBulkCopy(System::String ^ connectionString);" />
      <MemberSignature Language="F#" Value="new System.Data.SqlClient.SqlBulkCopy : string -&gt; System.Data.SqlClient.SqlBulkCopy" Usage="new System.Data.SqlClient.SqlBulkCopy connectionString" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="connectionString" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="connectionString"><span data-ttu-id="311f5-132">定义将打开的且由 <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> 实例使用的连接的字符串。</span><span class="sxs-lookup"><span data-stu-id="311f5-132">The string defining the connection that will be opened for use by the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> instance.</span></span> <span data-ttu-id="311f5-133">如果连接字符串不使用 <see langword="Integrated Security = true" />，可以使用 <see cref="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection)" /> 或 <see cref="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection,System.Data.SqlClient.SqlBulkCopyOptions,System.Data.SqlClient.SqlTransaction)" /> 和 <see cref="T:System.Data.SqlClient.SqlCredential" /> 来通过用户 ID 和密码比在连接字符串的文本中指定用户 ID 和密码更安全。</span><span class="sxs-lookup"><span data-stu-id="311f5-133">If your connection string does not use <see langword="Integrated Security = true" />, you can use <see cref="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection)" /> or <see cref="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection,System.Data.SqlClient.SqlBulkCopyOptions,System.Data.SqlClient.SqlTransaction)" /> and <see cref="T:System.Data.SqlClient.SqlCredential" /> to pass the user ID and password more securely than by specifying the user ID and password as text in the connection string.</span></span></param>
        <summary><span data-ttu-id="311f5-134">基于提供的 <paramref name="connectionString" /> 初始化和打开 <see cref="T:System.Data.SqlClient.SqlConnection" /> 的新实例。</span><span class="sxs-lookup"><span data-stu-id="311f5-134">Initializes and opens a new instance of <see cref="T:System.Data.SqlClient.SqlConnection" /> based on the supplied <paramref name="connectionString" />.</span></span> <span data-ttu-id="311f5-135">此构造函数使用 <see cref="T:System.Data.SqlClient.SqlConnection" /> 来初始化 <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> 类的新实例。</span><span class="sxs-lookup"><span data-stu-id="311f5-135">The constructor uses the <see cref="T:System.Data.SqlClient.SqlConnection" /> to initialize a new instance of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> class.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="311f5-136">在大容量复制操作结束时, 连接会自动关闭。</span><span class="sxs-lookup"><span data-stu-id="311f5-136">The connection is automatically closed at the end of the bulk copy operation.</span></span>  
  
 <span data-ttu-id="311f5-137">如果`connectionString`为 null <xref:System.ArgumentNullException> , 则引发。</span><span class="sxs-lookup"><span data-stu-id="311f5-137">If `connectionString` is null, an <xref:System.ArgumentNullException> is thrown.</span></span> <span data-ttu-id="311f5-138">如果`connectionString`为空字符串<xref:System.ArgumentException> , 则会引发。</span><span class="sxs-lookup"><span data-stu-id="311f5-138">If `connectionString` is an empty string, an <xref:System.ArgumentException> is thrown.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="311f5-139">下面的控制台应用程序演示如何使用指定为字符串的连接大容量加载数据。</span><span class="sxs-lookup"><span data-stu-id="311f5-139">The following console application demonstrates how to bulk load data by using a connection specified as a string.</span></span> <span data-ttu-id="311f5-140"><xref:System.Data.SqlClient.SqlBulkCopy>实例关闭时, 连接会自动关闭。</span><span class="sxs-lookup"><span data-stu-id="311f5-140">The connection is automatically closed when the <xref:System.Data.SqlClient.SqlBulkCopy> instance is closed.</span></span>  
  
 <span data-ttu-id="311f5-141">在此示例中, 首先将源数据从 SQL Server 表<xref:System.Data.SqlClient.SqlDataReader>读入实例。</span><span class="sxs-lookup"><span data-stu-id="311f5-141">In this example, the source data is first read from a SQL Server table to a <xref:System.Data.SqlClient.SqlDataReader> instance.</span></span> <span data-ttu-id="311f5-142">源数据不必位于 SQL Server 上;可以使用任何可读取到或已<xref:System.Data.IDataReader>加载到的<xref:System.Data.DataTable>数据源。</span><span class="sxs-lookup"><span data-stu-id="311f5-142">The source data does not have to be located on SQL Server; you can use any data source that can be read to an <xref:System.Data.IDataReader> or loaded to a <xref:System.Data.DataTable>.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="311f5-143">除非已按照[大容量复制示例设置](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md)中所述创建了工作表, 否则此示例将不会运行。</span><span class="sxs-lookup"><span data-stu-id="311f5-143">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="311f5-144">提供此代码是为了演示仅使用**SqlBulkCopy**的语法。</span><span class="sxs-lookup"><span data-stu-id="311f5-144">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="311f5-145">如果源表和目标表位于同一个 SQL Server 实例中, 则使用 transact-sql `INSERT … SELECT`语句复制数据会更加简单快捷。</span><span class="sxs-lookup"><span data-stu-id="311f5-145">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.ConnectionString#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.ConnectionString/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.ConnectionString#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.ConnectionString/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/83a7a0d2-8018-4354-97b9-0b1d99f8342b"><span data-ttu-id="311f5-146">SQL Server 中的批量复制操作</span><span class="sxs-lookup"><span data-stu-id="311f5-146">Bulk Copy Operations in SQL Server</span></span></related>
        <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="311f5-147">ADO.NET 概述</span><span class="sxs-lookup"><span data-stu-id="311f5-147">ADO.NET Overview</span></span></related>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public SqlBulkCopy (string connectionString, System.Data.SqlClient.SqlBulkCopyOptions copyOptions);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string connectionString, valuetype System.Data.SqlClient.SqlBulkCopyOptions copyOptions) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.String,System.Data.SqlClient.SqlBulkCopyOptions)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (connectionString As String, copyOptions As SqlBulkCopyOptions)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; SqlBulkCopy(System::String ^ connectionString, System::Data::SqlClient::SqlBulkCopyOptions copyOptions);" />
      <MemberSignature Language="F#" Value="new System.Data.SqlClient.SqlBulkCopy : string * System.Data.SqlClient.SqlBulkCopyOptions -&gt; System.Data.SqlClient.SqlBulkCopy" Usage="new System.Data.SqlClient.SqlBulkCopy (connectionString, copyOptions)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="connectionString" Type="System.String" />
        <Parameter Name="copyOptions" Type="System.Data.SqlClient.SqlBulkCopyOptions" />
      </Parameters>
      <Docs>
        <param name="connectionString"><span data-ttu-id="311f5-148">定义将打开的且由 <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> 实例使用的连接的字符串。</span><span class="sxs-lookup"><span data-stu-id="311f5-148">The string defining the connection that will be opened for use by the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> instance.</span></span> <span data-ttu-id="311f5-149">如果连接字符串不使用 <see langword="Integrated Security = true" />，可以使用 <see cref="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection)" /> 或 <see cref="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection,System.Data.SqlClient.SqlBulkCopyOptions,System.Data.SqlClient.SqlTransaction)" /> 和 <see cref="T:System.Data.SqlClient.SqlCredential" /> 来通过用户 ID 和密码比在连接字符串的文本中指定用户 ID 和密码更安全。</span><span class="sxs-lookup"><span data-stu-id="311f5-149">If your connection string does not use <see langword="Integrated Security = true" />, you can use <see cref="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection)" /> or <see cref="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection,System.Data.SqlClient.SqlBulkCopyOptions,System.Data.SqlClient.SqlTransaction)" /> and <see cref="T:System.Data.SqlClient.SqlCredential" /> to pass the user ID and password more securely than by specifying the user ID and password as text in the connection string.</span></span></param>
        <param name="copyOptions"><span data-ttu-id="311f5-150"><see cref="T:System.Data.SqlClient.SqlBulkCopyOptions" /> 枚举中的值的组合，可确定将哪些数据源行复制到目标表中。</span><span class="sxs-lookup"><span data-stu-id="311f5-150">A combination of values from the <see cref="T:System.Data.SqlClient.SqlBulkCopyOptions" /> enumeration that determines which data source rows are copied to the destination table.</span></span></param>
        <summary><span data-ttu-id="311f5-151">基于提供的 <paramref name="connectionString" /> 初始化和打开 <see cref="T:System.Data.SqlClient.SqlConnection" /> 的新实例。</span><span class="sxs-lookup"><span data-stu-id="311f5-151">Initializes and opens a new instance of <see cref="T:System.Data.SqlClient.SqlConnection" /> based on the supplied <paramref name="connectionString" />.</span></span> <span data-ttu-id="311f5-152">此构造函数使用此 <see cref="T:System.Data.SqlClient.SqlConnection" /> 来初始化 <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> 类的新实例。</span><span class="sxs-lookup"><span data-stu-id="311f5-152">The constructor uses that <see cref="T:System.Data.SqlClient.SqlConnection" /> to initialize a new instance of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> class.</span></span> <span data-ttu-id="311f5-153"><see cref="T:System.Data.SqlClient.SqlConnection" /> 实例的行为取决于 <paramref name="copyOptions" /> 参数中提供的选项。</span><span class="sxs-lookup"><span data-stu-id="311f5-153">The <see cref="T:System.Data.SqlClient.SqlConnection" /> instance behaves according to options supplied in the <paramref name="copyOptions" /> parameter.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="311f5-154">你可以在<xref:System.Data.SqlClient.SqlBulkCopyOptions>主题中获取有关所有大容量复制选项的详细信息。</span><span class="sxs-lookup"><span data-stu-id="311f5-154">You can obtain detailed information about all the bulk copy options in the <xref:System.Data.SqlClient.SqlBulkCopyOptions> topic.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="311f5-155">下面的控制台应用程序演示如何使用指定为字符串的连接执行大容量加载。</span><span class="sxs-lookup"><span data-stu-id="311f5-155">The following console application demonstrates how to perform a bulk load by using a connection specified as a string.</span></span> <span data-ttu-id="311f5-156">在加载目标表时, 选项设置为使用源表的 "标识" 列中的值。</span><span class="sxs-lookup"><span data-stu-id="311f5-156">An option is set to use the value in the identity column of the source table when you load the destination table.</span></span> <span data-ttu-id="311f5-157">在此示例中, 首先将源数据从 SQL Server 表<xref:System.Data.SqlClient.SqlDataReader>读入实例。</span><span class="sxs-lookup"><span data-stu-id="311f5-157">In this example, the source data is first read from a SQL Server table to a <xref:System.Data.SqlClient.SqlDataReader> instance.</span></span> <span data-ttu-id="311f5-158">源表和目标表每个都包含一个标识列。</span><span class="sxs-lookup"><span data-stu-id="311f5-158">The source table and destination table each include an Identity column.</span></span> <span data-ttu-id="311f5-159">默认情况下, 在目标表中为添加的每个行生成**标识**列的新值。</span><span class="sxs-lookup"><span data-stu-id="311f5-159">By default, a new value for the **Identity** column is generated in the destination table for each row added.</span></span> <span data-ttu-id="311f5-160">在此示例中, 当打开连接时, 将设置一个选项, 该选项强制大容量加载进程改为使用源表中的**标识**值。</span><span class="sxs-lookup"><span data-stu-id="311f5-160">In this example, an option is set when the connection is opened that forces the bulk load process to use the **Identity** values from the source table instead.</span></span> <span data-ttu-id="311f5-161">若要查看选项如何更改大容量加载的工作方式, 请运行包含 dbo 的示例 **。BulkCopyDemoMatchingColumns**表为空。</span><span class="sxs-lookup"><span data-stu-id="311f5-161">To see how the option changes the way the bulk load works, run the sample with the **dbo.BulkCopyDemoMatchingColumns** table empty.</span></span> <span data-ttu-id="311f5-162">从源加载所有行。</span><span class="sxs-lookup"><span data-stu-id="311f5-162">All rows load from the source.</span></span> <span data-ttu-id="311f5-163">然后再次运行该示例而不清空该表。</span><span class="sxs-lookup"><span data-stu-id="311f5-163">Then run the sample again without emptying the table.</span></span> <span data-ttu-id="311f5-164">引发异常, 并且代码向控制台写入一条消息, 通知您由于 primary key 约束冲突而未添加行。</span><span class="sxs-lookup"><span data-stu-id="311f5-164">An exception is thrown and the code writes a message to the console notifying you that rows weren't added because of primary key constraint violations.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="311f5-165">除非已按照[大容量复制示例设置](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md)中所述创建了工作表, 否则此示例将不会运行。</span><span class="sxs-lookup"><span data-stu-id="311f5-165">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="311f5-166">提供此代码是为了演示仅使用**SqlBulkCopy**的语法。</span><span class="sxs-lookup"><span data-stu-id="311f5-166">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="311f5-167">如果源表和目标表位于同一个 SQL Server 实例中, 则使用 transact-sql `INSERT … SELECT`语句复制数据会更加简单快捷。</span><span class="sxs-lookup"><span data-stu-id="311f5-167">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.KeepIdentity#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.KeepIdentity/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.KeepIdentity#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.KeepIdentity/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/83a7a0d2-8018-4354-97b9-0b1d99f8342b"><span data-ttu-id="311f5-168">执行大容量复制操作</span><span class="sxs-lookup"><span data-stu-id="311f5-168">Performing Bulk Copy Operations</span></span></related>
        <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="311f5-169">ADO.NET 概述</span><span class="sxs-lookup"><span data-stu-id="311f5-169">ADO.NET Overview</span></span></related>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public SqlBulkCopy (System.Data.SqlClient.SqlConnection connection, System.Data.SqlClient.SqlBulkCopyOptions copyOptions, System.Data.SqlClient.SqlTransaction externalTransaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(class System.Data.SqlClient.SqlConnection connection, valuetype System.Data.SqlClient.SqlBulkCopyOptions copyOptions, class System.Data.SqlClient.SqlTransaction externalTransaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection,System.Data.SqlClient.SqlBulkCopyOptions,System.Data.SqlClient.SqlTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (connection As SqlConnection, copyOptions As SqlBulkCopyOptions, externalTransaction As SqlTransaction)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; SqlBulkCopy(System::Data::SqlClient::SqlConnection ^ connection, System::Data::SqlClient::SqlBulkCopyOptions copyOptions, System::Data::SqlClient::SqlTransaction ^ externalTransaction);" />
      <MemberSignature Language="F#" Value="new System.Data.SqlClient.SqlBulkCopy : System.Data.SqlClient.SqlConnection * System.Data.SqlClient.SqlBulkCopyOptions * System.Data.SqlClient.SqlTransaction -&gt; System.Data.SqlClient.SqlBulkCopy" Usage="new System.Data.SqlClient.SqlBulkCopy (connection, copyOptions, externalTransaction)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="connection" Type="System.Data.SqlClient.SqlConnection" />
        <Parameter Name="copyOptions" Type="System.Data.SqlClient.SqlBulkCopyOptions" />
        <Parameter Name="externalTransaction" Type="System.Data.SqlClient.SqlTransaction" />
      </Parameters>
      <Docs>
        <param name="connection"><span data-ttu-id="311f5-170">将用于执行批量复制操作的已经打开的 <see cref="T:System.Data.SqlClient.SqlConnection" /> 实例。</span><span class="sxs-lookup"><span data-stu-id="311f5-170">The already open <see cref="T:System.Data.SqlClient.SqlConnection" /> instance that will be used to perform the bulk copy.</span></span> <span data-ttu-id="311f5-171">如果连接字符串不使用 <see langword="Integrated Security = true" />，则可以使用 <see cref="T:System.Data.SqlClient.SqlCredential" /> 来传递用户 ID 和密码，这比将用户 ID 和密码指定为连接字符串中的文本更安全。</span><span class="sxs-lookup"><span data-stu-id="311f5-171">If your connection string does not use <see langword="Integrated Security = true" />, you can use <see cref="T:System.Data.SqlClient.SqlCredential" /> to pass the user ID and password more securely than by specifying the user ID and password as text in the connection string.</span></span></param>
        <param name="copyOptions"><span data-ttu-id="311f5-172"><see cref="T:System.Data.SqlClient.SqlBulkCopyOptions" /> 枚举中的值的组合，可确定将哪些数据源行复制到目标表中。</span><span class="sxs-lookup"><span data-stu-id="311f5-172">A combination of values from the <see cref="T:System.Data.SqlClient.SqlBulkCopyOptions" /> enumeration that determines which data source rows are copied to the destination table.</span></span></param>
        <param name="externalTransaction"><span data-ttu-id="311f5-173">现有的 <see cref="T:System.Data.SqlClient.SqlTransaction" /> 实例，批量复制操作将在该实例下进行。</span><span class="sxs-lookup"><span data-stu-id="311f5-173">An existing <see cref="T:System.Data.SqlClient.SqlTransaction" /> instance under which the bulk copy will occur.</span></span></param>
        <summary><span data-ttu-id="311f5-174">使用提供的 <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> 的现有打开实例初始化 <see cref="T:System.Data.SqlClient.SqlConnection" /> 类的新实例。</span><span class="sxs-lookup"><span data-stu-id="311f5-174">Initializes a new instance of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> class using the supplied existing open instance of <see cref="T:System.Data.SqlClient.SqlConnection" />.</span></span> <span data-ttu-id="311f5-175"><see cref="T:System.Data.SqlClient.SqlBulkCopy" /> 实例的行为取决于 <paramref name="copyOptions" /> 参数中提供的选项。</span><span class="sxs-lookup"><span data-stu-id="311f5-175">The <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> instance behaves according to options supplied in the <paramref name="copyOptions" /> parameter.</span></span> <span data-ttu-id="311f5-176">如果提供非空 <see cref="T:System.Data.SqlClient.SqlTransaction" />，则复制操作将在该事务中执行。</span><span class="sxs-lookup"><span data-stu-id="311f5-176">If a non-null <see cref="T:System.Data.SqlClient.SqlTransaction" /> is supplied, the copy operations will be performed within that transaction.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="311f5-177">如果选项包括`UseInternalTransaction` `externalTransaction`并且参数不为 null, 则会引发**InvalidArgumentException** 。</span><span class="sxs-lookup"><span data-stu-id="311f5-177">If options include `UseInternalTransaction` and the `externalTransaction` argument is not null, an **InvalidArgumentException** is thrown.</span></span>  
  
 <span data-ttu-id="311f5-178">有关演示如何在事务中`SqlBulkCopy`使用的示例, 请参阅[事务和大容量复制操作](~/docs/framework/data/adonet/sql/transaction-and-bulk-copy-operations.md)。</span><span class="sxs-lookup"><span data-stu-id="311f5-178">For examples demonstrating how to use `SqlBulkCopy` in a transaction, see [Transaction and Bulk Copy Operations](~/docs/framework/data/adonet/sql/transaction-and-bulk-copy-operations.md).</span></span>  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/83a7a0d2-8018-4354-97b9-0b1d99f8342b"><span data-ttu-id="311f5-179">执行大容量复制操作</span><span class="sxs-lookup"><span data-stu-id="311f5-179">Performing Bulk Copy Operations</span></span></related>
        <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="311f5-180">ADO.NET 概述</span><span class="sxs-lookup"><span data-stu-id="311f5-180">ADO.NET Overview</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="BatchSize">
      <MemberSignature Language="C#" Value="public int BatchSize { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 BatchSize" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlBulkCopy.BatchSize" />
      <MemberSignature Language="VB.NET" Value="Public Property BatchSize As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property int BatchSize { int get(); void set(int value); };" />
      <MemberSignature Language="F#" Value="member this.BatchSize : int with get, set" Usage="System.Data.SqlClient.SqlBulkCopy.BatchSize" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="311f5-181">每一批次中的行数。</span><span class="sxs-lookup"><span data-stu-id="311f5-181">Number of rows in each batch.</span></span> <span data-ttu-id="311f5-182">在每一批次结束时，将该批次中的行发送到服务器。</span><span class="sxs-lookup"><span data-stu-id="311f5-182">At the end of each batch, the rows in the batch are sent to the server.</span></span></summary>
        <value><span data-ttu-id="311f5-183"><see cref="P:System.Data.SqlClient.SqlBulkCopy.BatchSize" /> 属性的整数值；或者如果未设置任何值，则为零。</span><span class="sxs-lookup"><span data-stu-id="311f5-183">The integer value of the <see cref="P:System.Data.SqlClient.SqlBulkCopy.BatchSize" /> property, or zero if no value has been set.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="311f5-184">当已处理行或<xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A>没有更多的行要发送到目标数据源时, 批处理完成。</span><span class="sxs-lookup"><span data-stu-id="311f5-184">A batch is complete when <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> rows have been processed or there are no more rows to send to the destination data source.</span></span>  
  
 <span data-ttu-id="311f5-185">零 (默认值) 指示每个<xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A>操作都是一个批处理。</span><span class="sxs-lookup"><span data-stu-id="311f5-185">Zero (the default) indicates that each <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> operation is a single batch.</span></span>  
  
 <span data-ttu-id="311f5-186">如果在未使用 "有效" <xref:System.Data.SqlClient.SqlBulkCopyOptions.UseInternalTransaction>选项的情况下声明<xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> 实例,则会一次向服务器行发送行,但不会执行与事务相关的操作。<xref:System.Data.SqlClient.SqlBulkCopy></span><span class="sxs-lookup"><span data-stu-id="311f5-186">If the <xref:System.Data.SqlClient.SqlBulkCopy> instance has been declared without the <xref:System.Data.SqlClient.SqlBulkCopyOptions.UseInternalTransaction> option in effect, rows are sent to the server <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> rows at a time, but no transaction-related action is taken.</span></span> <span data-ttu-id="311f5-187">如果<xref:System.Data.SqlClient.SqlBulkCopyOptions.UseInternalTransaction>有效, 则每批行都作为单独的事务插入。</span><span class="sxs-lookup"><span data-stu-id="311f5-187">If <xref:System.Data.SqlClient.SqlBulkCopyOptions.UseInternalTransaction> is in effect, each batch of rows is inserted as a separate transaction.</span></span>  
  
 <span data-ttu-id="311f5-188">此<xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A>属性可随时设置。</span><span class="sxs-lookup"><span data-stu-id="311f5-188">The <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> property can be set at any time.</span></span> <span data-ttu-id="311f5-189">如果大容量复制已在进行中, 则根据以前的批大小调整当前批的大小。</span><span class="sxs-lookup"><span data-stu-id="311f5-189">If a bulk copy is already in progress, the current batch is sized according to the previous batch size.</span></span> <span data-ttu-id="311f5-190">后续批次使用新的大小。</span><span class="sxs-lookup"><span data-stu-id="311f5-190">Subsequent batches use the new size.</span></span> <span data-ttu-id="311f5-191">如果初始为零并在<xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A>操作已在进行中更改, 则该操作将以单个批处理的方式加载数据。 <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A></span><span class="sxs-lookup"><span data-stu-id="311f5-191">If the <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> is initially zero and changed while a <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> operation is already in progress, that operation loads the data as a single batch.</span></span> <span data-ttu-id="311f5-192">对同一<xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> <xref:System.Data.SqlClient.SqlBulkCopy>实例执行的任何后续操作都将<xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A>使用新的。</span><span class="sxs-lookup"><span data-stu-id="311f5-192">Any subsequent <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> operations on the same <xref:System.Data.SqlClient.SqlBulkCopy> instance use the new <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="311f5-193">下面的控制台应用程序演示如何以批处理50行的方式大容量加载数据。</span><span class="sxs-lookup"><span data-stu-id="311f5-193">The following console application demonstrates how to bulk load data in batches of 50 rows.</span></span> <span data-ttu-id="311f5-194">有关演示如何<xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A>处理事务的示例, 请参阅[事务和大容量复制操作](~/docs/framework/data/adonet/sql/transaction-and-bulk-copy-operations.md)。</span><span class="sxs-lookup"><span data-stu-id="311f5-194">For an example illustrating how <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> works with a transaction, see [Transaction and Bulk Copy Operations](~/docs/framework/data/adonet/sql/transaction-and-bulk-copy-operations.md).</span></span>  
  
 <span data-ttu-id="311f5-195">在此示例中, 首先将源数据从 SQL Server 表<xref:System.Data.SqlClient.SqlDataReader>读入实例。</span><span class="sxs-lookup"><span data-stu-id="311f5-195">In this example, the source data is first read from a SQL Server table to a <xref:System.Data.SqlClient.SqlDataReader> instance.</span></span> <span data-ttu-id="311f5-196">源数据不必位于 SQL Server 上;可以使用任何可读取到或已<xref:System.Data.IDataReader>加载到的<xref:System.Data.DataTable>数据源。</span><span class="sxs-lookup"><span data-stu-id="311f5-196">The source data does not have to be located on SQL Server; you can use any data source that can be read to an <xref:System.Data.IDataReader> or loaded to a <xref:System.Data.DataTable>.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="311f5-197">除非已按照[大容量复制示例设置](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md)中所述创建了工作表, 否则此示例将不会运行。</span><span class="sxs-lookup"><span data-stu-id="311f5-197">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="311f5-198">提供此代码是为了演示仅使用**SqlBulkCopy**的语法。</span><span class="sxs-lookup"><span data-stu-id="311f5-198">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="311f5-199">如果源表和目标表位于同一个 SQL Server 实例中, 则使用 transact-sql `INSERT … SELECT`语句复制数据会更加简单快捷。</span><span class="sxs-lookup"><span data-stu-id="311f5-199">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.BatchSize#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.BatchSize/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.BatchSize#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.BatchSize/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/83a7a0d2-8018-4354-97b9-0b1d99f8342b"><span data-ttu-id="311f5-200">SQL Server 中的批量复制操作</span><span class="sxs-lookup"><span data-stu-id="311f5-200">Bulk Copy Operations in SQL Server</span></span></related>
        <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="311f5-201">ADO.NET 概述</span><span class="sxs-lookup"><span data-stu-id="311f5-201">ADO.NET Overview</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="BulkCopyTimeout">
      <MemberSignature Language="C#" Value="public int BulkCopyTimeout { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 BulkCopyTimeout" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlBulkCopy.BulkCopyTimeout" />
      <MemberSignature Language="VB.NET" Value="Public Property BulkCopyTimeout As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property int BulkCopyTimeout { int get(); void set(int value); };" />
      <MemberSignature Language="F#" Value="member this.BulkCopyTimeout : int with get, set" Usage="System.Data.SqlClient.SqlBulkCopy.BulkCopyTimeout" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="311f5-202">超时之前操作完成所允许的秒数。</span><span class="sxs-lookup"><span data-stu-id="311f5-202">Number of seconds for the operation to complete before it times out.</span></span></summary>
        <value><span data-ttu-id="311f5-203"><see cref="P:System.Data.SqlClient.SqlBulkCopy.BulkCopyTimeout" /> 属性的整数值。</span><span class="sxs-lookup"><span data-stu-id="311f5-203">The integer value of the <see cref="P:System.Data.SqlClient.SqlBulkCopy.BulkCopyTimeout" /> property.</span></span> <span data-ttu-id="311f5-204">默认值为 30 秒。</span><span class="sxs-lookup"><span data-stu-id="311f5-204">The default is 30 seconds.</span></span> <span data-ttu-id="311f5-205">值 0 指示没有限制；批量复制将无限期等待。</span><span class="sxs-lookup"><span data-stu-id="311f5-205">A value of 0 indicates no limit; the bulk copy will wait indefinitely.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="311f5-206">如果操作超时, 则不会提交事务, 并从目标表中删除所有复制的行。</span><span class="sxs-lookup"><span data-stu-id="311f5-206">If the operation does time out, the transaction is not committed and all copied rows are removed from the destination table.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="311f5-207">下面的控制台应用程序演示如何在大容量加载数据时修改超时时间为60秒。</span><span class="sxs-lookup"><span data-stu-id="311f5-207">The following console application demonstrates how to modify the time-out to 60 seconds when bulk loading data.</span></span>  
  
 <span data-ttu-id="311f5-208">在此示例中, 首先将源数据从 SQL Server 表<xref:System.Data.SqlClient.SqlDataReader>读入实例。</span><span class="sxs-lookup"><span data-stu-id="311f5-208">In this example, the source data is first read from a SQL Server table to a <xref:System.Data.SqlClient.SqlDataReader> instance.</span></span> <span data-ttu-id="311f5-209">源数据不必位于 SQL Server 上;可以使用任何可读取到或已<xref:System.Data.IDataReader>加载到的<xref:System.Data.DataTable>数据源。</span><span class="sxs-lookup"><span data-stu-id="311f5-209">The source data does not have to be located on SQL Server; you can use any data source that can be read to an <xref:System.Data.IDataReader> or loaded to a <xref:System.Data.DataTable>.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="311f5-210">除非已按照[大容量复制示例设置](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md)中所述创建了工作表, 否则此示例将不会运行。</span><span class="sxs-lookup"><span data-stu-id="311f5-210">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="311f5-211">提供此代码是为了演示仅使用**SqlBulkCopy**的语法。</span><span class="sxs-lookup"><span data-stu-id="311f5-211">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="311f5-212">如果源表和目标表位于同一个 SQL Server 实例中, 则使用[!INCLUDE[tsql](~/includes/tsql-md.md)] `INSERT … SELECT`语句复制数据会更加简单快捷。</span><span class="sxs-lookup"><span data-stu-id="311f5-212">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a [!INCLUDE[tsql](~/includes/tsql-md.md)]`INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.Timeout#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.Timeout/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.Timeout#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.Timeout/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/83a7a0d2-8018-4354-97b9-0b1d99f8342b"><span data-ttu-id="311f5-213">执行大容量复制操作</span><span class="sxs-lookup"><span data-stu-id="311f5-213">Performing Bulk Copy Operations</span></span></related>
        <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="311f5-214">ADO.NET 概述</span><span class="sxs-lookup"><span data-stu-id="311f5-214">ADO.NET Overview</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="Close">
      <MemberSignature Language="C#" Value="public void Close ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Close() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.Close" />
      <MemberSignature Language="VB.NET" Value="Public Sub Close ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Close();" />
      <MemberSignature Language="F#" Value="member this.Close : unit -&gt; unit" Usage="sqlBulkCopy.Close " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="311f5-215">关闭 <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> 实例。</span><span class="sxs-lookup"><span data-stu-id="311f5-215">Closes the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> instance.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="311f5-216">对<xref:System.Data.SqlClient.SqlBulkCopy.Close%2A> <xref:System.Data.SqlClient.SqlBulkCopy>对象调用时, 其他操作将不会成功。</span><span class="sxs-lookup"><span data-stu-id="311f5-216">After you call a <xref:System.Data.SqlClient.SqlBulkCopy.Close%2A> on the <xref:System.Data.SqlClient.SqlBulkCopy> object, no other operation will succeed.</span></span> <span data-ttu-id="311f5-217">对方法的<xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A>调用将<xref:System.InvalidOperationException>引发。</span><span class="sxs-lookup"><span data-stu-id="311f5-217">Calls to the <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> method will throw an <xref:System.InvalidOperationException>.</span></span>  
  
 <span data-ttu-id="311f5-218">从事件调用<xref:System.InvalidOperationException>方法将导致引发。 <xref:System.Data.SqlClient.SqlBulkCopy.Close%2A> <xref:System.Data.SqlClient.SqlBulkCopy.SqlRowsCopied></span><span class="sxs-lookup"><span data-stu-id="311f5-218">Calling the <xref:System.Data.SqlClient.SqlBulkCopy.Close%2A> method from the <xref:System.Data.SqlClient.SqlBulkCopy.SqlRowsCopied> event causes an <xref:System.InvalidOperationException> to be thrown.</span></span>  
  
 <span data-ttu-id="311f5-219">请注意, <xref:System.Data.SqlClient.SqlBulkCopy>打开实例在`using`块的末尾隐式关闭。</span><span class="sxs-lookup"><span data-stu-id="311f5-219">Note that open <xref:System.Data.SqlClient.SqlBulkCopy> instances are closed implicitly at the end of a `using` block.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="311f5-220">下面的示例使用同一<xref:System.Data.SqlClient.SqlBulkCopy>实例将销售订单及其关联详细信息添加到两个目标表。</span><span class="sxs-lookup"><span data-stu-id="311f5-220">The following example uses the same <xref:System.Data.SqlClient.SqlBulkCopy> instance to add sales orders and their associated details to two destination tables.</span></span> <span data-ttu-id="311f5-221">由于**AdventureWorks**销售订单表很大, 因此该示例只读取某个帐号号下的订单, 并将这些订单和详细信息大容量复制到目标表中。</span><span class="sxs-lookup"><span data-stu-id="311f5-221">Because the **AdventureWorks** sales order tables are large, the sample reads only orders placed by a certain account number and bulk copies those orders and details to the destination tables.</span></span> <span data-ttu-id="311f5-222">此<xref:System.Data.SqlClient.SqlBulkCopy.Close%2A>方法仅在两个大容量复制操作完成后使用。</span><span class="sxs-lookup"><span data-stu-id="311f5-222">The <xref:System.Data.SqlClient.SqlBulkCopy.Close%2A> method is used only after both bulk copy operations are complete.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="311f5-223">除非已按照[大容量复制示例设置](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md)中所述创建了工作表, 否则此示例将不会运行。</span><span class="sxs-lookup"><span data-stu-id="311f5-223">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="311f5-224">提供此代码是为了演示仅使用**SqlBulkCopy**的语法。</span><span class="sxs-lookup"><span data-stu-id="311f5-224">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="311f5-225">如果源表和目标表位于同一个 SQL Server 实例中, 则使用 transact-sql `INSERT … SELECT`语句复制数据会更加简单快捷。</span><span class="sxs-lookup"><span data-stu-id="311f5-225">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.OrdersDetails#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.OrdersDetails/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.OrdersDetails#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.OrdersDetails/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/83a7a0d2-8018-4354-97b9-0b1d99f8342b"><span data-ttu-id="311f5-226">执行大容量复制操作</span><span class="sxs-lookup"><span data-stu-id="311f5-226">Performing Bulk Copy Operations</span></span></related>
        <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="311f5-227">ADO.NET 概述</span><span class="sxs-lookup"><span data-stu-id="311f5-227">ADO.NET Overview</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="ColumnMappings">
      <MemberSignature Language="C#" Value="public System.Data.SqlClient.SqlBulkCopyColumnMappingCollection ColumnMappings { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Data.SqlClient.SqlBulkCopyColumnMappingCollection ColumnMappings" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlBulkCopy.ColumnMappings" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property ColumnMappings As SqlBulkCopyColumnMappingCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Data::SqlClient::SqlBulkCopyColumnMappingCollection ^ ColumnMappings { System::Data::SqlClient::SqlBulkCopyColumnMappingCollection ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.ColumnMappings : System.Data.SqlClient.SqlBulkCopyColumnMappingCollection" Usage="System.Data.SqlClient.SqlBulkCopy.ColumnMappings" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Data.SqlClient.SqlBulkCopyColumnMappingCollection</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="311f5-228">返回 <see cref="T:System.Data.SqlClient.SqlBulkCopyColumnMapping" /> 项的集合。</span><span class="sxs-lookup"><span data-stu-id="311f5-228">Returns a collection of <see cref="T:System.Data.SqlClient.SqlBulkCopyColumnMapping" /> items.</span></span> <span data-ttu-id="311f5-229">列映射定义数据源中的列和目标中的列之间的关系。</span><span class="sxs-lookup"><span data-stu-id="311f5-229">Column mappings define the relationships between columns in the data source and columns in the destination.</span></span></summary>
        <value><span data-ttu-id="311f5-230">列映射集合。</span><span class="sxs-lookup"><span data-stu-id="311f5-230">A collection of column mappings.</span></span> <span data-ttu-id="311f5-231">默认情况下为空集合。</span><span class="sxs-lookup"><span data-stu-id="311f5-231">By default, it is an empty collection.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="311f5-232">如果数据源和目标表具有相同的列数, 并且数据源中每个源列的序号位置与相应目标列的序号位置匹配, 则不需要该<xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A>集合。</span><span class="sxs-lookup"><span data-stu-id="311f5-232">If the data source and the destination table have the same number of columns, and the ordinal position of each source column within the data source matches the ordinal position of the corresponding destination column, the <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> collection is unnecessary.</span></span> <span data-ttu-id="311f5-233">但是, 如果列数不同, 或者序号位置不一致, 则必须使用<xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A>确保将数据复制到正确的列。</span><span class="sxs-lookup"><span data-stu-id="311f5-233">However, if the column counts differ, or the ordinal positions are not consistent, you must use <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> to make sure that data is copied into the correct columns.</span></span>  
  
 <span data-ttu-id="311f5-234">在执行大容量复制操作期间, 可以访问此集合, 但不能对其进行更改。</span><span class="sxs-lookup"><span data-stu-id="311f5-234">During the execution of a bulk copy operation, this collection can be accessed, but it cannot be changed.</span></span> <span data-ttu-id="311f5-235">任何更改尝试都将引发<xref:System.InvalidOperationException>。</span><span class="sxs-lookup"><span data-stu-id="311f5-235">Any attempt to change it will throw an <xref:System.InvalidOperationException>.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Data.SqlClient.SqlBulkCopyColumnMapping" />
        <related type="Article" href="https://msdn.microsoft.com/library/83a7a0d2-8018-4354-97b9-0b1d99f8342b"><span data-ttu-id="311f5-236">执行大容量复制操作</span><span class="sxs-lookup"><span data-stu-id="311f5-236">Performing Bulk Copy Operations</span></span></related>
        <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="311f5-237">ADO.NET 概述</span><span class="sxs-lookup"><span data-stu-id="311f5-237">ADO.NET Overview</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="DestinationTableName">
      <MemberSignature Language="C#" Value="public string DestinationTableName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string DestinationTableName" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" />
      <MemberSignature Language="VB.NET" Value="Public Property DestinationTableName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ DestinationTableName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.DestinationTableName : string with get, set" Usage="System.Data.SqlClient.SqlBulkCopy.DestinationTableName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="311f5-238">服务器上目标表的名称。</span><span class="sxs-lookup"><span data-stu-id="311f5-238">Name of the destination table on the server.</span></span></summary>
        <value><span data-ttu-id="311f5-239"><see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> 属性的字符串值；或者如果未提供任何值，则为 null。</span><span class="sxs-lookup"><span data-stu-id="311f5-239">The string value of the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property, or null if none as been supplied.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="311f5-240">如果<xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A>在调用时<xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A>未设置, <xref:System.ArgumentNullException>则会引发。</span><span class="sxs-lookup"><span data-stu-id="311f5-240">If <xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A> has not been set when <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> is called, an <xref:System.ArgumentNullException> is thrown.</span></span>  
  
 <span data-ttu-id="311f5-241">如果<xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A>在<xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A>操作运行时修改了, 则更改不会影响当前操作。</span><span class="sxs-lookup"><span data-stu-id="311f5-241">If <xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A> is modified while a <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> operation is running, the change does not affect the current operation.</span></span> <span data-ttu-id="311f5-242">新<xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A>值将在下一<xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A>次调用方法时使用。</span><span class="sxs-lookup"><span data-stu-id="311f5-242">The new <xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A> value is used the next time a <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> method is called.</span></span>  
  
 <span data-ttu-id="311f5-243"><xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A>是由三部分组成的名称`<database>.<owningschema>.<name>`()。</span><span class="sxs-lookup"><span data-stu-id="311f5-243"><xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A> is a three-part name (`<database>.<owningschema>.<name>`).</span></span> <span data-ttu-id="311f5-244">如果你选择, 则可以将表名称与数据库和所属架构限定。</span><span class="sxs-lookup"><span data-stu-id="311f5-244">You can qualify the table name with its database and owning schema if you choose.</span></span> <span data-ttu-id="311f5-245">但是, 如果表名使用下划线 ("_") 或任何其他特殊字符, 则必须使用方括号 (`[<database>.<owningschema>.<name_01>]`) 将名称转义。</span><span class="sxs-lookup"><span data-stu-id="311f5-245">However, if the table name uses an underscore ("_") or any other special characters, you must escape the name using surrounding brackets as in (`[<database>.<owningschema>.<name_01>]`).</span></span> <span data-ttu-id="311f5-246">有关详细信息, 请参阅[数据库标识符](/sql/relational-databases/databases/database-identifiers)。</span><span class="sxs-lookup"><span data-stu-id="311f5-246">For more information, see [Database Identifiers](/sql/relational-databases/databases/database-identifiers).</span></span>  
  
 <span data-ttu-id="311f5-247">您可以使用`tempdb..#table` <xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A>属性 (如或`tempdb.<owner>.#table` ) 将数据大容量复制到临时表中。</span><span class="sxs-lookup"><span data-stu-id="311f5-247">You can bulk-copy data to a temporary table by using a value such as `tempdb..#table` or `tempdb.<owner>.#table` for the <xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A> property.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="311f5-248">下面的控制台应用程序演示如何使用已打开的连接大容量加载数据。</span><span class="sxs-lookup"><span data-stu-id="311f5-248">The following console application demonstrates how to bulk load data using a connection that is already open.</span></span> <span data-ttu-id="311f5-249">目标表是**AdventureWorks**数据库中的表。</span><span class="sxs-lookup"><span data-stu-id="311f5-249">The destination table is a table in the **AdventureWorks** database.</span></span>  
  
 <span data-ttu-id="311f5-250">在此示例中, 首先使用连接来将 SQL Server 表<xref:System.Data.SqlClient.SqlDataReader>中的数据读入实例。</span><span class="sxs-lookup"><span data-stu-id="311f5-250">In this example, the connection is first used to read data from a SQL Server table to a <xref:System.Data.SqlClient.SqlDataReader> instance.</span></span> <span data-ttu-id="311f5-251">源数据不必位于 SQL Server 上;可以使用任何可读取到或已<xref:System.Data.IDataReader>加载到的<xref:System.Data.DataTable>数据源。</span><span class="sxs-lookup"><span data-stu-id="311f5-251">The source data does not have to be located on SQL Server; you can use any data source that can be read to an <xref:System.Data.IDataReader> or loaded to a <xref:System.Data.DataTable>.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="311f5-252">除非已按照[大容量复制示例设置](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md)中所述创建了工作表, 否则此示例将不会运行。</span><span class="sxs-lookup"><span data-stu-id="311f5-252">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="311f5-253">提供此代码是为了演示仅使用**SqlBulkCopy**的语法。</span><span class="sxs-lookup"><span data-stu-id="311f5-253">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="311f5-254">如果源表和目标表位于同一个 SQL Server 实例中, 则使用 transact-sql `INSERT … SELECT`语句复制数据会更加简单快捷。</span><span class="sxs-lookup"><span data-stu-id="311f5-254">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.Single#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.Single/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.Single#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.Single/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/83a7a0d2-8018-4354-97b9-0b1d99f8342b"><span data-ttu-id="311f5-255">执行大容量复制操作</span><span class="sxs-lookup"><span data-stu-id="311f5-255">Performing Bulk Copy Operations</span></span></related>
        <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="311f5-256">ADO.NET 概述</span><span class="sxs-lookup"><span data-stu-id="311f5-256">ADO.NET Overview</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="EnableStreaming">
      <MemberSignature Language="C#" Value="public bool EnableStreaming { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool EnableStreaming" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlBulkCopy.EnableStreaming" />
      <MemberSignature Language="VB.NET" Value="Public Property EnableStreaming As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool EnableStreaming { bool get(); void set(bool value); };" />
      <MemberSignature Language="F#" Value="member this.EnableStreaming : bool with get, set" Usage="System.Data.SqlClient.SqlBulkCopy.EnableStreaming" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="311f5-257">启用或禁用 <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> 对象，传输 <see cref="T:System.Data.IDataReader" /> 对象的数据。</span><span class="sxs-lookup"><span data-stu-id="311f5-257">Enables or disables a <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object to stream data from an <see cref="T:System.Data.IDataReader" /> object</span></span></summary>
        <value><span data-ttu-id="311f5-258">如果 <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> 对象可以对 <see cref="T:System.Data.IDataReader" /> 对象的数据进行流处理，则为 <see langword="true" />；否则，为 false。</span><span class="sxs-lookup"><span data-stu-id="311f5-258"><see langword="true" /> if a <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object can stream data from an <see cref="T:System.Data.IDataReader" /> object; otherwise, false.</span></span> <span data-ttu-id="311f5-259">默认值为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="311f5-259">The default is <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="311f5-260">当<xref:System.Data.SqlClient.SqlBulkCopy.EnableStreaming%2A>为<xref:System.Data.IDataReader> <xref:System.Data.IDataReader>时, <xref:System.Data.SqlClient.SqlBulkCopy> 使用<xref:System.Data.CommandBehavior.SequentialAccess>从中读取对象, 并使用流式处理功能优化内存使用。 `true`</span><span class="sxs-lookup"><span data-stu-id="311f5-260">When <xref:System.Data.SqlClient.SqlBulkCopy.EnableStreaming%2A> is `true`, <xref:System.Data.SqlClient.SqlBulkCopy> reads from an <xref:System.Data.IDataReader> object using <xref:System.Data.CommandBehavior.SequentialAccess>, optimizing memory usage by using the <xref:System.Data.IDataReader> streaming capabilities.</span></span> <span data-ttu-id="311f5-261">当该参数设置为 false 时, <xref:System.Data.SqlClient.SqlBulkCopy>类会将该<xref:System.Data.IDataReader>对象返回的所有数据加载到内存中, 然后再将其发送到 SQL Server 或 SQL Azure。</span><span class="sxs-lookup"><span data-stu-id="311f5-261">When it's set to false, the <xref:System.Data.SqlClient.SqlBulkCopy> class loads all the data returned by the <xref:System.Data.IDataReader> object into memory before sending it to SQL Server or SQL Azure.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="NotifyAfter">
      <MemberSignature Language="C#" Value="public int NotifyAfter { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 NotifyAfter" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlBulkCopy.NotifyAfter" />
      <MemberSignature Language="VB.NET" Value="Public Property NotifyAfter As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property int NotifyAfter { int get(); void set(int value); };" />
      <MemberSignature Language="F#" Value="member this.NotifyAfter : int with get, set" Usage="System.Data.SqlClient.SqlBulkCopy.NotifyAfter" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="311f5-262">定义在生成通知事件之前要处理的行数。</span><span class="sxs-lookup"><span data-stu-id="311f5-262">Defines the number of rows to be processed before generating a notification event.</span></span></summary>
        <value><span data-ttu-id="311f5-263"><see cref="P:System.Data.SqlClient.SqlBulkCopy.NotifyAfter" /> 属性的整数值，或者如果未设置该属性，则为零。</span><span class="sxs-lookup"><span data-stu-id="311f5-263">The integer value of the <see cref="P:System.Data.SqlClient.SqlBulkCopy.NotifyAfter" /> property, or zero if the property has not been set.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="311f5-264">此属性设计用于阐释大容量复制操作进度的用户界面组件。</span><span class="sxs-lookup"><span data-stu-id="311f5-264">This property is designed for user interface components that illustrate the progress of a bulk copy operation.</span></span> <span data-ttu-id="311f5-265">它指示生成通知事件之前要处理的行数。</span><span class="sxs-lookup"><span data-stu-id="311f5-265">It indicates the number of rows to be processed before generating a notification event.</span></span> <span data-ttu-id="311f5-266">即使<xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A>正在进行大容量复制操作, 也可以随时设置此属性。</span><span class="sxs-lookup"><span data-stu-id="311f5-266">The <xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A> property can be set at any time, even while a bulk copy operation is underway.</span></span> <span data-ttu-id="311f5-267">在大容量复制操作过程中所做的更改将在下一次通知后生效。</span><span class="sxs-lookup"><span data-stu-id="311f5-267">Changes made during a bulk copy operation take effect after the next notification.</span></span> <span data-ttu-id="311f5-268">新设置适用于在同一实例上的所有后续操作。</span><span class="sxs-lookup"><span data-stu-id="311f5-268">The new setting applies to all subsequent operations on the same instance.</span></span>  
  
 <span data-ttu-id="311f5-269">如果<xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A>设置为小于零的数字<xref:System.ArgumentOutOfRangeException> , 则会引发。</span><span class="sxs-lookup"><span data-stu-id="311f5-269">If <xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A> is set to a number less than zero, an <xref:System.ArgumentOutOfRangeException> is thrown.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="311f5-270">下面的控制台应用程序演示如何使用已打开的连接大容量加载数据。</span><span class="sxs-lookup"><span data-stu-id="311f5-270">The following console application demonstrates how to bulk load data using a connection that is already open.</span></span> <span data-ttu-id="311f5-271">设置<xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A>属性, 以便在将每50行复制到表后调用事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="311f5-271">The <xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A> property is set so that the event handler is called after every 50 rows copied to the table.</span></span>  
  
 <span data-ttu-id="311f5-272">在此示例中, 首先使用连接来将 SQL Server 表<xref:System.Data.SqlClient.SqlDataReader>中的数据读入实例。</span><span class="sxs-lookup"><span data-stu-id="311f5-272">In this example, the connection is first used to read data from a SQL Server table to a <xref:System.Data.SqlClient.SqlDataReader> instance.</span></span> <span data-ttu-id="311f5-273">然后, 打开第二个连接以大容量复制数据。</span><span class="sxs-lookup"><span data-stu-id="311f5-273">Then a second connection is opened to bulk copy the data.</span></span> <span data-ttu-id="311f5-274">请注意, 源数据不必位于 SQL Server 上;可以使用任何可读取到或已<xref:System.Data.IDataReader>加载到的<xref:System.Data.DataTable>数据源。</span><span class="sxs-lookup"><span data-stu-id="311f5-274">Note that the source data does not have to be located on SQL Server; you can use any data source that can be read to an <xref:System.Data.IDataReader> or loaded to a <xref:System.Data.DataTable>.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="311f5-275">除非已按照[大容量复制示例设置](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md)中所述创建了工作表, 否则此示例将不会运行。</span><span class="sxs-lookup"><span data-stu-id="311f5-275">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="311f5-276">提供此代码是为了演示仅使用**SqlBulkCopy**的语法。</span><span class="sxs-lookup"><span data-stu-id="311f5-276">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="311f5-277">如果源表和目标表位于同一个 SQL Server 实例中, 则使用 transact-sql `INSERT … SELECT`语句复制数据会更加简单快捷。</span><span class="sxs-lookup"><span data-stu-id="311f5-277">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.NotifyAfter#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.NotifyAfter/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.NotifyAfter#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.NotifyAfter/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/83a7a0d2-8018-4354-97b9-0b1d99f8342b"><span data-ttu-id="311f5-278">执行大容量复制操作</span><span class="sxs-lookup"><span data-stu-id="311f5-278">Performing Bulk Copy Operations</span></span></related>
        <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="311f5-279">ADO.NET 概述</span><span class="sxs-lookup"><span data-stu-id="311f5-279">ADO.NET Overview</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="SqlRowsCopied">
      <MemberSignature Language="C#" Value="public event System.Data.SqlClient.SqlRowsCopiedEventHandler SqlRowsCopied;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Data.SqlClient.SqlRowsCopiedEventHandler SqlRowsCopied" />
      <MemberSignature Language="DocId" Value="E:System.Data.SqlClient.SqlBulkCopy.SqlRowsCopied" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event SqlRowsCopied As SqlRowsCopiedEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Data::SqlClient::SqlRowsCopiedEventHandler ^ SqlRowsCopied;" />
      <MemberSignature Language="F#" Value="member this.SqlRowsCopied : System.Data.SqlClient.SqlRowsCopiedEventHandler " Usage="member this.SqlRowsCopied : System.Data.SqlClient.SqlRowsCopiedEventHandler " />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Data.SqlClient.SqlRowsCopiedEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="311f5-280">在每次处理完 <see cref="P:System.Data.SqlClient.SqlBulkCopy.NotifyAfter" /> 属性指定的行数时发生。</span><span class="sxs-lookup"><span data-stu-id="311f5-280">Occurs every time that the number of rows specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.NotifyAfter" /> property have been processed.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="311f5-281">请注意, <xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A>和<xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A>的设置是独立的。</span><span class="sxs-lookup"><span data-stu-id="311f5-281">Note that the settings of <xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A> and <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> are independent.</span></span> <span data-ttu-id="311f5-282"><xref:System.Data.SqlClient.SqlBulkCopy.SqlRowsCopied>事件的接收并不意味着所有行都已发送到服务器或已提交。</span><span class="sxs-lookup"><span data-stu-id="311f5-282">Receipt of a <xref:System.Data.SqlClient.SqlBulkCopy.SqlRowsCopied> event does not imply that any rows have been sent to the server or committed.</span></span>  
  
 <span data-ttu-id="311f5-283">不能从此事件调用 SqlBulkCopy (<xref:System.Data.SqlClient.SqlBulkCopy.Close%2A>) 或 SqlConnection。<xref:System.Data.SqlClient.SqlConnection.Close%2A></span><span class="sxs-lookup"><span data-stu-id="311f5-283">You cannot call SqlBulkCopy.Close (<xref:System.Data.SqlClient.SqlBulkCopy.Close%2A>) or SqlConnection.Close (<xref:System.Data.SqlClient.SqlConnection.Close%2A>) from this event.</span></span> <span data-ttu-id="311f5-284">这样做将导致<xref:System.InvalidOperationException>引发, <xref:System.Data.SqlClient.SqlBulkCopy>而对象状态不会更改。</span><span class="sxs-lookup"><span data-stu-id="311f5-284">Doing this will cause an <xref:System.InvalidOperationException> being thrown, and the <xref:System.Data.SqlClient.SqlBulkCopy> object state will not change.</span></span> <span data-ttu-id="311f5-285">如果用户想要从事件中取消操作, <xref:System.Data.SqlClient.SqlRowsCopiedEventArgs.Abort%2A>则可以使用的<xref:System.Data.SqlClient.SqlRowsCopiedEventArgs>属性。</span><span class="sxs-lookup"><span data-stu-id="311f5-285">If the user wants to cancel the operation from the event, the <xref:System.Data.SqlClient.SqlRowsCopiedEventArgs.Abort%2A> property of the <xref:System.Data.SqlClient.SqlRowsCopiedEventArgs> can be used.</span></span> <span data-ttu-id="311f5-286">(有关使用<xref:System.Data.SqlClient.SqlRowsCopiedEventArgs.Abort%2A>属性的示例, 请参阅[事务和大容量复制操作](~/docs/framework/data/adonet/sql/transaction-and-bulk-copy-operations.md)。)</span><span class="sxs-lookup"><span data-stu-id="311f5-286">(See [Transaction and Bulk Copy Operations](~/docs/framework/data/adonet/sql/transaction-and-bulk-copy-operations.md) for examples that use the <xref:System.Data.SqlClient.SqlRowsCopiedEventArgs.Abort%2A> property.)</span></span>  
  
 <span data-ttu-id="311f5-287">在执行大容量复制操作期间, 连接中不支持任何操作 (例如事务活动), 因此, 建议您不要使用<xref:System.Data.SqlClient.SqlBulkCopy.SqlRowsCopied>事件期间使用的相同连接。</span><span class="sxs-lookup"><span data-stu-id="311f5-287">No action, such as transaction activity, is supported in the connection during the execution of the bulk copy operation, and it is recommended that you not use the same connection used during the <xref:System.Data.SqlClient.SqlBulkCopy.SqlRowsCopied> event.</span></span> <span data-ttu-id="311f5-288">但是, 你可以打开其他连接。</span><span class="sxs-lookup"><span data-stu-id="311f5-288">However, you can open a different connection.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="311f5-289">下面的控制台应用程序演示如何使用已打开的连接大容量加载数据。</span><span class="sxs-lookup"><span data-stu-id="311f5-289">The following console application demonstrates how to bulk load data using a connection that is already open.</span></span> <span data-ttu-id="311f5-290">设置<xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A>属性, 以便在将每50行复制到表后调用事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="311f5-290">The <xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A> property is set so that the event handler is called after every 50 rows copied to the table.</span></span>  
  
 <span data-ttu-id="311f5-291">在此示例中, 首先使用连接来将 SQL Server 表<xref:System.Data.SqlClient.SqlDataReader>中的数据读入实例。</span><span class="sxs-lookup"><span data-stu-id="311f5-291">In this example, the connection is first used to read data from a SQL Server table to a <xref:System.Data.SqlClient.SqlDataReader> instance.</span></span> <span data-ttu-id="311f5-292">请注意, 源数据不必位于 SQL Server 上;可以使用任何可读取到或已<xref:System.Data.IDataReader>加载到的<xref:System.Data.DataTable>数据源。</span><span class="sxs-lookup"><span data-stu-id="311f5-292">Note that the source data does not have to be located on SQL Server; you can use any data source that can be read to an <xref:System.Data.IDataReader> or loaded to a <xref:System.Data.DataTable>.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="311f5-293">除非已按照[大容量复制示例设置](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md)中所述创建了工作表, 否则此示例将不会运行。</span><span class="sxs-lookup"><span data-stu-id="311f5-293">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="311f5-294">提供此代码是为了演示仅使用**SqlBulkCopy**的语法。</span><span class="sxs-lookup"><span data-stu-id="311f5-294">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="311f5-295">如果源表和目标表位于同一个 SQL Server 实例中, 则使用 transact-sql `INSERT … SELECT`语句复制数据会更加简单快捷。</span><span class="sxs-lookup"><span data-stu-id="311f5-295">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.NotifyAfter#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.NotifyAfter/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.NotifyAfter#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.NotifyAfter/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/83a7a0d2-8018-4354-97b9-0b1d99f8342b"><span data-ttu-id="311f5-296">执行大容量复制操作</span><span class="sxs-lookup"><span data-stu-id="311f5-296">Performing Bulk Copy Operations</span></span></related>
        <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="311f5-297">ADO.NET 概述</span><span class="sxs-lookup"><span data-stu-id="311f5-297">ADO.NET Overview</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="System.IDisposable.Dispose">
      <MemberSignature Language="C#" Value="void IDisposable.Dispose ();" />
      <MemberSignature Language="ILAsm" Value=".method hidebysig newslot virtual instance void System.IDisposable.Dispose() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.System#IDisposable#Dispose" />
      <MemberSignature Language="VB.NET" Value="Sub Dispose () Implements IDisposable.Dispose" />
      <MemberSignature Language="C++ CLI" Value=" virtual void System.IDisposable.Dispose() = IDisposable::Dispose;" />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.IDisposable.Dispose</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="311f5-298">释放 <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> 类的当前实例所使用的所有资源。</span><span class="sxs-lookup"><span data-stu-id="311f5-298">Releases all resources used by the current instance of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> class.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="311f5-299">在完成使用 `Dispose` 后，应调用 <xref:System.Data.SqlClient.SqlBulkCopy>。</span><span class="sxs-lookup"><span data-stu-id="311f5-299">Call `Dispose` when you are finished using the <xref:System.Data.SqlClient.SqlBulkCopy>.</span></span> <span data-ttu-id="311f5-300">`Dispose` 方法使 <xref:System.Data.SqlClient.SqlBulkCopy> 处于不可用状态。</span><span class="sxs-lookup"><span data-stu-id="311f5-300">The `Dispose` method leaves the <xref:System.Data.SqlClient.SqlBulkCopy> in an unusable state.</span></span> <span data-ttu-id="311f5-301">调用`Dispose`后, 必须释放对的<xref:System.Data.SqlClient.SqlBulkCopy>所有引用, 以便垃圾回收器能够<xref:System.Data.SqlClient.SqlBulkCopy>回收占用的内存。</span><span class="sxs-lookup"><span data-stu-id="311f5-301">After calling `Dispose`, you must release all references to the <xref:System.Data.SqlClient.SqlBulkCopy> so the garbage collector can reclaim the memory that the <xref:System.Data.SqlClient.SqlBulkCopy> was occupying.</span></span>  
  
 <span data-ttu-id="311f5-302">有关详细信息, 请参阅[清理非托管资源](~/docs/standard/garbage-collection/unmanaged.md)和[实现 Dispose 方法](~/docs/standard/garbage-collection/implementing-dispose.md)。</span><span class="sxs-lookup"><span data-stu-id="311f5-302">For more information, see [Cleaning Up Unmanaged Resources](~/docs/standard/garbage-collection/unmanaged.md) and [Implementing a Dispose Method](~/docs/standard/garbage-collection/implementing-dispose.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="311f5-303">每次释放对 `Dispose` 的最后一个引用前，均应调用 <xref:System.Data.SqlClient.SqlBulkCopy>。</span><span class="sxs-lookup"><span data-stu-id="311f5-303">Always call `Dispose` before you release your last reference to the <xref:System.Data.SqlClient.SqlBulkCopy>.</span></span> <span data-ttu-id="311f5-304">否则，在垃圾回收器调用 <xref:System.Data.SqlClient.SqlBulkCopy> 对象的 `Finalize` 方法之前，该对象正在使用的资源不会被释放。</span><span class="sxs-lookup"><span data-stu-id="311f5-304">Otherwise, the resources it is using will not be freed until the garbage collector calls the <xref:System.Data.SqlClient.SqlBulkCopy> object's `Finalize` method.</span></span>  
  
 ]]></format>
        </remarks>
        <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="311f5-305">ADO.NET 概述</span><span class="sxs-lookup"><span data-stu-id="311f5-305">ADO.NET Overview</span></span></related>
      </Docs>
    </Member>
    <MemberGroup MemberName="WriteToServer">
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="311f5-306">将所有行从数据源复制到 <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> 对象的 <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> 属性指定的目标表中。</span><span class="sxs-lookup"><span data-stu-id="311f5-306">Copies all rows from a data source to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="311f5-307">如果禁用多个活动的结果集 (MARS) <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> , 则连接将会变得繁忙。</span><span class="sxs-lookup"><span data-stu-id="311f5-307">If multiple active result sets (MARS) is disabled, <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> makes the connection busy.</span></span> <span data-ttu-id="311f5-308">如果启用了 MARS, 则可以通过同一连接<xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A>中的其他命令将调用交替。</span><span class="sxs-lookup"><span data-stu-id="311f5-308">If MARS is enabled, you can interleave calls to <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> with other commands in the same connection.</span></span>  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/83a7a0d2-8018-4354-97b9-0b1d99f8342b"><span data-ttu-id="311f5-309">执行大容量复制操作</span><span class="sxs-lookup"><span data-stu-id="311f5-309">Performing Bulk Copy Operations</span></span></related>
        <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="311f5-310">ADO.NET 概述</span><span class="sxs-lookup"><span data-stu-id="311f5-310">ADO.NET Overview</span></span></related>
      </Docs>
    </MemberGroup>
    <Member MemberName="WriteToServer">
      <MemberSignature Language="C#" Value="public void WriteToServer (System.Data.Common.DbDataReader reader);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteToServer(class System.Data.Common.DbDataReader reader) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.Common.DbDataReader)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteToServer (reader As DbDataReader)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteToServer(System::Data::Common::DbDataReader ^ reader);" />
      <MemberSignature Language="F#" Value="member this.WriteToServer : System.Data.Common.DbDataReader -&gt; unit" Usage="sqlBulkCopy.WriteToServer reader" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="reader" Type="System.Data.Common.DbDataReader" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-1.0;netcore-1.1;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0" />
      </Parameters>
      <Docs>
        <param name="reader"><span data-ttu-id="311f5-311">一个 <see cref="T:System.Data.Common.DbDataReader" />，它的行将被复制到目标表中。</span><span class="sxs-lookup"><span data-stu-id="311f5-311">A <see cref="T:System.Data.Common.DbDataReader" /> whose rows will be copied to the destination table.</span></span></param>
        <summary><span data-ttu-id="311f5-312">将所提供的 <see cref="T:System.Data.Common.DbDataReader" /> 数组中的所有行复制到 <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> 对象的 <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> 属性指定的目标表中。</span><span class="sxs-lookup"><span data-stu-id="311f5-312">Copies all rows from the supplied <see cref="T:System.Data.Common.DbDataReader" /> array to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span></span></summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="WriteToServer">
      <MemberSignature Language="C#" Value="public void WriteToServer (System.Data.DataRow[] rows);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteToServer(class System.Data.DataRow[] rows) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataRow[])" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteToServer (rows As DataRow())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteToServer(cli::array &lt;System::Data::DataRow ^&gt; ^ rows);" />
      <MemberSignature Language="F#" Value="member this.WriteToServer : System.Data.DataRow[] -&gt; unit" Usage="sqlBulkCopy.WriteToServer rows" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="rows" Type="System.Data.DataRow[]" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0" />
      </Parameters>
      <Docs>
        <param name="rows"><span data-ttu-id="311f5-313">将复制到目标表的 <see cref="T:System.Data.DataRow" /> 对象的数组。</span><span class="sxs-lookup"><span data-stu-id="311f5-313">An array of <see cref="T:System.Data.DataRow" /> objects that will be copied to the destination table.</span></span></param>
        <summary><span data-ttu-id="311f5-314">将所提供的 <see cref="T:System.Data.DataRow" /> 数组中的所有行复制到 <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> 对象的 <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> 属性指定的目标表中。</span><span class="sxs-lookup"><span data-stu-id="311f5-314">Copies all rows from the supplied <see cref="T:System.Data.DataRow" /> array to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="311f5-315">当大容量复制操作正在进行时, 关联的目标<xref:System.Data.SqlClient.SqlConnection>正在忙于为其提供服务, 并且不能对该连接执行任何其他操作。</span><span class="sxs-lookup"><span data-stu-id="311f5-315">While the bulk copy operation is in progress, the associated destination <xref:System.Data.SqlClient.SqlConnection> is busy serving it, and no other operations can be performed on the connection.</span></span>  
  
 <span data-ttu-id="311f5-316"><xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> 集合<xref:System.Data.DataRow>从列映射到目标数据库表。</span><span class="sxs-lookup"><span data-stu-id="311f5-316">The <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> collection maps from the <xref:System.Data.DataRow> columns to the destination database table.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="311f5-317">下面的控制台应用程序演示如何从<xref:System.Data.DataRow>数组大容量加载数据。</span><span class="sxs-lookup"><span data-stu-id="311f5-317">The following console application demonstrates how to bulk load data from a <xref:System.Data.DataRow> array.</span></span> <span data-ttu-id="311f5-318">目标表是**AdventureWorks**数据库中的表。</span><span class="sxs-lookup"><span data-stu-id="311f5-318">The destination table is a table in the **AdventureWorks** database.</span></span>  
  
 <span data-ttu-id="311f5-319">在此示例中, <xref:System.Data.DataTable>将在运行时创建。</span><span class="sxs-lookup"><span data-stu-id="311f5-319">In this example, a <xref:System.Data.DataTable> is created at run time.</span></span> <span data-ttu-id="311f5-320">选择要复制到目标表中<xref:System.Data.DataTable>的单个行。</span><span class="sxs-lookup"><span data-stu-id="311f5-320">A single row is selected from the <xref:System.Data.DataTable> to copy to the destination table.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="311f5-321">除非已按照[大容量复制示例设置](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md)中所述创建了工作表, 否则此示例将不会运行。</span><span class="sxs-lookup"><span data-stu-id="311f5-321">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="311f5-322">提供此代码是为了演示仅使用**SqlBulkCopy**的语法。</span><span class="sxs-lookup"><span data-stu-id="311f5-322">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="311f5-323">如果源表和目标表位于同一个 SQL Server 实例中, 则使用 transact-sql `INSERT … SELECT`语句复制数据会更加简单快捷。</span><span class="sxs-lookup"><span data-stu-id="311f5-323">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.RowArray#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.RowArray/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.RowArray#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.RowArray/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/83a7a0d2-8018-4354-97b9-0b1d99f8342b"><span data-ttu-id="311f5-324">执行大容量复制操作</span><span class="sxs-lookup"><span data-stu-id="311f5-324">Performing Bulk Copy Operations</span></span></related>
        <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="311f5-325">ADO.NET 概述</span><span class="sxs-lookup"><span data-stu-id="311f5-325">ADO.NET Overview</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="WriteToServer">
      <MemberSignature Language="C#" Value="public void WriteToServer (System.Data.DataTable table);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteToServer(class System.Data.DataTable table) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteToServer (table As DataTable)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteToServer(System::Data::DataTable ^ table);" />
      <MemberSignature Language="F#" Value="member this.WriteToServer : System.Data.DataTable -&gt; unit" Usage="sqlBulkCopy.WriteToServer table" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="table" Type="System.Data.DataTable" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0" />
      </Parameters>
      <Docs>
        <param name="table"><span data-ttu-id="311f5-326">一个 <see cref="T:System.Data.DataTable" />，它的行将被复制到目标表中。</span><span class="sxs-lookup"><span data-stu-id="311f5-326">A <see cref="T:System.Data.DataTable" /> whose rows will be copied to the destination table.</span></span></param>
        <summary><span data-ttu-id="311f5-327">将所提供的 <see cref="T:System.Data.DataTable" /> 中的所有行复制到 <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> 对象的 <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> 属性指定的目标表中。</span><span class="sxs-lookup"><span data-stu-id="311f5-327">Copies all rows in the supplied <see cref="T:System.Data.DataTable" /> to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="311f5-328">中的<xref:System.Data.DataTable>所有行都会复制到目标表中, 但已删除的行除外。</span><span class="sxs-lookup"><span data-stu-id="311f5-328">All rows in the <xref:System.Data.DataTable> are copied to the destination table except those that have been deleted.</span></span>  
  
 <span data-ttu-id="311f5-329">当大容量复制操作正在进行时, 关联的目标<xref:System.Data.SqlClient.SqlConnection>正在忙于为其提供服务, 并且不能对该连接执行任何其他操作。</span><span class="sxs-lookup"><span data-stu-id="311f5-329">While the bulk copy operation is in progress, the associated destination <xref:System.Data.SqlClient.SqlConnection> is busy serving it, and no other operations can be performed on the connection.</span></span>  
  
 <span data-ttu-id="311f5-330"><xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> 集合<xref:System.Data.DataTable>从列映射到目标数据库表。</span><span class="sxs-lookup"><span data-stu-id="311f5-330">The <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> collection maps from the <xref:System.Data.DataTable> columns to the destination database table.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="311f5-331">下面的控制台应用程序演示如何从<xref:System.Data.DataTable>大容量加载数据。</span><span class="sxs-lookup"><span data-stu-id="311f5-331">The following Console application demonstrates how to bulk load data from a <xref:System.Data.DataTable>.</span></span> <span data-ttu-id="311f5-332">目标表是**AdventureWorks**数据库中的表。</span><span class="sxs-lookup"><span data-stu-id="311f5-332">The destination table is a table in the **AdventureWorks** database.</span></span>  
  
 <span data-ttu-id="311f5-333">在此示例中, <xref:System.Data.DataTable>在运行时创建, 是`SqlBulkCopy`操作的源。</span><span class="sxs-lookup"><span data-stu-id="311f5-333">In this example, a <xref:System.Data.DataTable> is created at run time and is the source of the `SqlBulkCopy` operation.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="311f5-334">除非已按照[大容量复制示例设置](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md)中所述创建了工作表, 否则此示例将不会运行。</span><span class="sxs-lookup"><span data-stu-id="311f5-334">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="311f5-335">提供此代码是为了演示仅使用**SqlBulkCopy**的语法。</span><span class="sxs-lookup"><span data-stu-id="311f5-335">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="311f5-336">如果源表和目标表位于同一个 SQL Server 实例中, 则使用 transact-sql `INSERT … SELECT`语句复制数据会更加简单快捷。</span><span class="sxs-lookup"><span data-stu-id="311f5-336">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.DataTable#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.DataTable/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.DataTable#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.DataTable/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/83a7a0d2-8018-4354-97b9-0b1d99f8342b"><span data-ttu-id="311f5-337">执行大容量复制操作</span><span class="sxs-lookup"><span data-stu-id="311f5-337">Performing Bulk Copy Operations</span></span></related>
        <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="311f5-338">ADO.NET 概述</span><span class="sxs-lookup"><span data-stu-id="311f5-338">ADO.NET Overview</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="WriteToServer">
      <MemberSignature Language="C#" Value="public void WriteToServer (System.Data.IDataReader reader);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteToServer(class System.Data.IDataReader reader) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.IDataReader)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteToServer (reader As IDataReader)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteToServer(System::Data::IDataReader ^ reader);" />
      <MemberSignature Language="F#" Value="member this.WriteToServer : System.Data.IDataReader -&gt; unit" Usage="sqlBulkCopy.WriteToServer reader" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="reader" Type="System.Data.IDataReader" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0" />
      </Parameters>
      <Docs>
        <param name="reader"><span data-ttu-id="311f5-339">一个 <see cref="T:System.Data.IDataReader" />，它的行将被复制到目标表中。</span><span class="sxs-lookup"><span data-stu-id="311f5-339">A <see cref="T:System.Data.IDataReader" /> whose rows will be copied to the destination table.</span></span></param>
        <summary><span data-ttu-id="311f5-340">将所提供的 <see cref="T:System.Data.IDataReader" /> 中的所有行复制到 <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> 对象的 <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> 属性指定的目标表中。</span><span class="sxs-lookup"><span data-stu-id="311f5-340">Copies all rows in the supplied <see cref="T:System.Data.IDataReader" /> to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="311f5-341">复制操作从读取器中的下一个可用行开始。</span><span class="sxs-lookup"><span data-stu-id="311f5-341">The copy operation starts at the next available row in the reader.</span></span> <span data-ttu-id="311f5-342">大多数情况下, 读取器只是由<xref:System.Data.IDbCommand.ExecuteReader%2A>或类似的调用返回, 因此下一个可用行是第一行。</span><span class="sxs-lookup"><span data-stu-id="311f5-342">Most of the time, the reader was just returned by <xref:System.Data.IDbCommand.ExecuteReader%2A> or a similar call, so the next available row is the first row.</span></span> <span data-ttu-id="311f5-343">若要处理多个结果<xref:System.Data.IDataReader.NextResult%2A> , 请对数据读取器<xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A>调用, 并再次调用。</span><span class="sxs-lookup"><span data-stu-id="311f5-343">To process multiple results, call <xref:System.Data.IDataReader.NextResult%2A> on the data reader and call <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> again.</span></span>  
  
 <span data-ttu-id="311f5-344">请注意, <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A>使用会修改读取器的状态。</span><span class="sxs-lookup"><span data-stu-id="311f5-344">Note that using <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> modifies the state of the reader.</span></span> <span data-ttu-id="311f5-345">方法将调用<xref:System.Data.IDataReader.Read%2A> , 直到它返回 false、操作中止或发生错误。</span><span class="sxs-lookup"><span data-stu-id="311f5-345">The method will call <xref:System.Data.IDataReader.Read%2A> until it returns false, the operation is aborted, or an error occurs.</span></span> <span data-ttu-id="311f5-346">这意味着当<xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A>操作完成时, 数据读取器可能处于不同的状态, 可能在结果集的末尾。</span><span class="sxs-lookup"><span data-stu-id="311f5-346">This means that the data reader will be in a different state, probably at the end of the result set, when the <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> operation is complete.</span></span>  
  
 <span data-ttu-id="311f5-347">当大容量复制操作正在进行时, 关联的目标<xref:System.Data.SqlClient.SqlConnection>正在忙于为其提供服务, 并且不能对该连接执行任何其他操作。</span><span class="sxs-lookup"><span data-stu-id="311f5-347">While the bulk copy operation is in progress, the associated destination <xref:System.Data.SqlClient.SqlConnection> is busy serving it, and no other operations can be performed on the connection.</span></span>  
  
 <span data-ttu-id="311f5-348"><xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A>集合将数据读取器列映射到目标数据库表。</span><span class="sxs-lookup"><span data-stu-id="311f5-348">The <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> collection maps from the data reader columns to the destination database table.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="311f5-349">下面的控制台应用程序演示如何从<xref:System.Data.SqlClient.SqlDataReader>大容量加载数据。</span><span class="sxs-lookup"><span data-stu-id="311f5-349">The following console application demonstrates how to bulk load data from a <xref:System.Data.SqlClient.SqlDataReader>.</span></span> <span data-ttu-id="311f5-350">目标表是**AdventureWorks**数据库中的表。</span><span class="sxs-lookup"><span data-stu-id="311f5-350">The destination table is a table in the **AdventureWorks** database.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="311f5-351">除非已按照[大容量复制示例设置](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md)中所述创建了工作表, 否则此示例将不会运行。</span><span class="sxs-lookup"><span data-stu-id="311f5-351">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="311f5-352">提供此代码是为了演示仅使用**SqlBulkCopy**的语法。</span><span class="sxs-lookup"><span data-stu-id="311f5-352">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="311f5-353">如果源表和目标表位于同一个 SQL Server 实例中, 则使用 transact-sql `INSERT … SELECT`语句复制数据会更加简单快捷。</span><span class="sxs-lookup"><span data-stu-id="311f5-353">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.ConnectionString#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.ConnectionString/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.ConnectionString#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.ConnectionString/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/83a7a0d2-8018-4354-97b9-0b1d99f8342b"><span data-ttu-id="311f5-354">执行大容量复制操作</span><span class="sxs-lookup"><span data-stu-id="311f5-354">Performing Bulk Copy Operations</span></span></related>
        <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="311f5-355">ADO.NET 概述</span><span class="sxs-lookup"><span data-stu-id="311f5-355">ADO.NET Overview</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="WriteToServer">
      <MemberSignature Language="C#" Value="public void WriteToServer (System.Data.DataTable table, System.Data.DataRowState rowState);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteToServer(class System.Data.DataTable table, valuetype System.Data.DataRowState rowState) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable,System.Data.DataRowState)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteToServer (table As DataTable, rowState As DataRowState)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteToServer(System::Data::DataTable ^ table, System::Data::DataRowState rowState);" />
      <MemberSignature Language="F#" Value="member this.WriteToServer : System.Data.DataTable * System.Data.DataRowState -&gt; unit" Usage="sqlBulkCopy.WriteToServer (table, rowState)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="table" Type="System.Data.DataTable" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0" />
        <Parameter Name="rowState" Type="System.Data.DataRowState" Index="1" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0" />
      </Parameters>
      <Docs>
        <param name="table"><span data-ttu-id="311f5-356">一个 <see cref="T:System.Data.DataTable" />，它的行将被复制到目标表中。</span><span class="sxs-lookup"><span data-stu-id="311f5-356">A <see cref="T:System.Data.DataTable" /> whose rows will be copied to the destination table.</span></span></param>
        <param name="rowState"><span data-ttu-id="311f5-357"><see cref="T:System.Data.DataRowState" /> 枚举中的一个值。</span><span class="sxs-lookup"><span data-stu-id="311f5-357">A value from the <see cref="T:System.Data.DataRowState" /> enumeration.</span></span> <span data-ttu-id="311f5-358">只有与行状态匹配的行才会被复制到目标表中。</span><span class="sxs-lookup"><span data-stu-id="311f5-358">Only rows matching the row state are copied to the destination.</span></span></param>
        <summary><span data-ttu-id="311f5-359">只将与所提供 <see cref="T:System.Data.DataTable" /> 中所提供行状态匹配的行复制到 <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> 对象的 <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> 属性指定的目标表中。</span><span class="sxs-lookup"><span data-stu-id="311f5-359">Copies only rows that match the supplied row state in the supplied <see cref="T:System.Data.DataTable" /> to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="311f5-360">只有中处于`rowState`参数<xref:System.Data.DataTable>中指示的状态的行才会复制到目标表中。</span><span class="sxs-lookup"><span data-stu-id="311f5-360">Only rows in the <xref:System.Data.DataTable> that are in the states indicated in the `rowState` argument and have not been deleted are copied to the destination table.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="311f5-361">如果<xref:System.Data.DataRowState.Deleted>指定了, 则<xref:System.Data.DataRowState.Unchanged>还会将<xref:System.Data.DataRowState.Modified>任何、 <xref:System.Data.DataRowState.Added>和行复制到服务器。</span><span class="sxs-lookup"><span data-stu-id="311f5-361">If <xref:System.Data.DataRowState.Deleted> is specified, any <xref:System.Data.DataRowState.Unchanged>, <xref:System.Data.DataRowState.Added>, and <xref:System.Data.DataRowState.Modified> rows will also be copied to the server.</span></span> <span data-ttu-id="311f5-362">不会引发异常。</span><span class="sxs-lookup"><span data-stu-id="311f5-362">No exception will be raised.</span></span>  
  
 <span data-ttu-id="311f5-363">当大容量复制操作正在进行时, 关联的目标<xref:System.Data.SqlClient.SqlConnection>正在忙于为其提供服务, 并且不能对该连接执行任何其他操作。</span><span class="sxs-lookup"><span data-stu-id="311f5-363">While the bulk copy operation is in progress, the associated destination <xref:System.Data.SqlClient.SqlConnection> is busy serving it, and no other operations can be performed on the connection.</span></span>  
  
 <span data-ttu-id="311f5-364"><xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> 集合<xref:System.Data.DataTable>从列映射到目标数据库表。</span><span class="sxs-lookup"><span data-stu-id="311f5-364">The <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> collection maps from the <xref:System.Data.DataTable> columns to the destination database table.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="311f5-365">下面的控制台应用程序演示如何在中<xref:System.Data.DataTable>仅大容量加载与指定状态匹配的行。</span><span class="sxs-lookup"><span data-stu-id="311f5-365">The following Console application demonstrates how to bulk load only the rows in a <xref:System.Data.DataTable> that match a specified state.</span></span> <span data-ttu-id="311f5-366">在这种情况下, 只会添加未更改的行。</span><span class="sxs-lookup"><span data-stu-id="311f5-366">In this case, only unchanged rows are added.</span></span> <span data-ttu-id="311f5-367">目标表是**AdventureWorks**数据库中的表。</span><span class="sxs-lookup"><span data-stu-id="311f5-367">The destination table is a table in the **AdventureWorks** database.</span></span>  
  
 <span data-ttu-id="311f5-368">在此示例中, <xref:System.Data.DataTable>将在运行时创建, 并向其添加三行。</span><span class="sxs-lookup"><span data-stu-id="311f5-368">In this example, a <xref:System.Data.DataTable> is created at run time and three rows are added to it.</span></span> <span data-ttu-id="311f5-369">在执行<xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A>方法之前, 会对其中一行进行编辑。</span><span class="sxs-lookup"><span data-stu-id="311f5-369">Before the <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> method is executed, one of the rows is edited.</span></span> <span data-ttu-id="311f5-370">使用参数调用<xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A>方法, 因此仅将两个未更改的行大容量复制到目标。 `DataRowState.Unchanged` `rowState`</span><span class="sxs-lookup"><span data-stu-id="311f5-370">The <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> method is called with a `DataRowState.Unchanged` `rowState` argument, so only the two unchanged rows are bulk copied to the destination.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="311f5-371">除非已按照[大容量复制示例设置](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md)中所述创建了工作表, 否则此示例将不会运行。</span><span class="sxs-lookup"><span data-stu-id="311f5-371">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="311f5-372">提供此代码是为了演示仅使用**SqlBulkCopy**的语法。</span><span class="sxs-lookup"><span data-stu-id="311f5-372">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="311f5-373">如果源表和目标表位于同一个 SQL Server 实例中, 则使用 transact-sql `INSERT … SELECT`语句复制数据会更加简单快捷。</span><span class="sxs-lookup"><span data-stu-id="311f5-373">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.DataRowState#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.DataRowState/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.DataRowState#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.DataRowState/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Data.DataRowState" />
        <related type="Article" href="https://msdn.microsoft.com/library/83a7a0d2-8018-4354-97b9-0b1d99f8342b"><span data-ttu-id="311f5-374">执行大容量复制操作</span><span class="sxs-lookup"><span data-stu-id="311f5-374">Performing Bulk Copy Operations</span></span></related>
        <related type="Article" href="~/docs/framework/data/adonet/ado-net-overview.md"><span data-ttu-id="311f5-375">ADO.NET 概述</span><span class="sxs-lookup"><span data-stu-id="311f5-375">ADO.NET Overview</span></span></related>
      </Docs>
    </Member>
    <MemberGroup MemberName="WriteToServerAsync">
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="311f5-376"><see cref="Overload:System.Data.SqlClient.SqlBulkCopy.WriteToServer" /> 的异步版本，将数据源中的所有行都复制到目标表中。该目标表由 <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> 对象的 <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> 指定。</span><span class="sxs-lookup"><span data-stu-id="311f5-376">An asynchronous version of <see cref="Overload:System.Data.SqlClient.SqlBulkCopy.WriteToServer" />, which copies all rows from a data source to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="311f5-377">如果禁用多个活动的结果集 (MARS) <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> , 则连接将会变得繁忙。</span><span class="sxs-lookup"><span data-stu-id="311f5-377">If multiple active result sets (MARS) is disabled, <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> makes the connection busy.</span></span> <span data-ttu-id="311f5-378">如果启用了 MARS, 则可以通过同一连接<xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A>中的其他命令将调用交替。</span><span class="sxs-lookup"><span data-stu-id="311f5-378">If MARS is enabled, you can interleave calls to <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> with other commands in the same connection.</span></span>  
  
 <span data-ttu-id="311f5-379">失败时回滚的行数取决于以下几项:</span><span class="sxs-lookup"><span data-stu-id="311f5-379">The number of rows that are rolled back when one fails depends on several things:</span></span>  
  
-   <span data-ttu-id="311f5-380">如果<xref:System.Data.SqlClient.SqlBulkCopyOptions.UseInternalTransaction>指定了, 则为。</span><span class="sxs-lookup"><span data-stu-id="311f5-380">If <xref:System.Data.SqlClient.SqlBulkCopyOptions.UseInternalTransaction> is specified.</span></span>  
  
-   <span data-ttu-id="311f5-381">如果有您自己的事务。</span><span class="sxs-lookup"><span data-stu-id="311f5-381">If you have your own transaction.</span></span>  
  
-   <span data-ttu-id="311f5-382"><xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> 的值。</span><span class="sxs-lookup"><span data-stu-id="311f5-382">The value of <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A>.</span></span>  
  
 <span data-ttu-id="311f5-383">如果在向服务器发送数据时出现错误, 则将回滚当前批处理 (由<xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A>指定)。</span><span class="sxs-lookup"><span data-stu-id="311f5-383">When there is an error while sending data to the server, the current batch (as specified by <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A>) will be rolled back.</span></span> <span data-ttu-id="311f5-384">如果<xref:System.Data.SqlClient.SqlBulkCopyOptions.UseInternalTransaction>未指定, 并且您有自己的事务, 则整个事务都将回滚 (也包括前面的所有批处理)。</span><span class="sxs-lookup"><span data-stu-id="311f5-384">If <xref:System.Data.SqlClient.SqlBulkCopyOptions.UseInternalTransaction> is not specified and you have your own transaction, the entire transaction will be rolled back (which includes all previous batches as well).</span></span>  
  
 <span data-ttu-id="311f5-385">用于<xref:System.Data.SqlClient.SqlBulkCopy.SqlRowsCopied>了解已将多少行复制到服务器。</span><span class="sxs-lookup"><span data-stu-id="311f5-385">Use <xref:System.Data.SqlClient.SqlBulkCopy.SqlRowsCopied> to know how many rows were copied to the server.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </MemberGroup>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.Common.DbDataReader reader);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.Common.DbDataReader reader) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.Common.DbDataReader)" />
      <MemberSignature Language="VB.NET" Value="Public Function WriteToServerAsync (reader As DbDataReader) As Task" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(System::Data::Common::DbDataReader ^ reader);" />
      <MemberSignature Language="F#" Value="member this.WriteToServerAsync : System.Data.Common.DbDataReader -&gt; System.Threading.Tasks.Task" Usage="sqlBulkCopy.WriteToServerAsync reader" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="reader" Type="System.Data.Common.DbDataReader" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-1.0;netcore-1.1;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0" />
      </Parameters>
      <Docs>
        <param name="reader"><span data-ttu-id="311f5-386">一个 <see cref="T:System.Data.Common.DbDataReader" />，它的行将被复制到目标表中。</span><span class="sxs-lookup"><span data-stu-id="311f5-386">A <see cref="T:System.Data.Common.DbDataReader" /> whose rows will be copied to the destination table.</span></span></param>
        <summary><span data-ttu-id="311f5-387"><see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.Common.DbDataReader)" /> 的异步版本，将 <see cref="T:System.Data.Common.DbDataReader" /> 数组中提供的所有行都复制到由 <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> 对象的 <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> 属性指定的目标表中。</span><span class="sxs-lookup"><span data-stu-id="311f5-387">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.Common.DbDataReader)" />, which copies all rows from the supplied <see cref="T:System.Data.Common.DbDataReader" /> array to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span></span></summary>
        <returns><span data-ttu-id="311f5-388">表示异步操作的任务。</span><span class="sxs-lookup"><span data-stu-id="311f5-388">A task representing the asynchronous operation.</span></span></returns>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.DataRow[] rows);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.DataRow[] rows) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" />
      <MemberSignature Language="VB.NET" Value="Public Function WriteToServerAsync (rows As DataRow()) As Task" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(cli::array &lt;System::Data::DataRow ^&gt; ^ rows);" />
      <MemberSignature Language="F#" Value="member this.WriteToServerAsync : System.Data.DataRow[] -&gt; System.Threading.Tasks.Task" Usage="sqlBulkCopy.WriteToServerAsync rows" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="rows" Type="System.Data.DataRow[]" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="rows"><span data-ttu-id="311f5-389">将复制到目标表的 <see cref="T:System.Data.DataRow" /> 对象的数组。</span><span class="sxs-lookup"><span data-stu-id="311f5-389">An array of <see cref="T:System.Data.DataRow" /> objects that will be copied to the destination table.</span></span></param>
        <summary><span data-ttu-id="311f5-390"><see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataRow[])" /> 的异步版本，将 <see cref="T:System.Data.DataRow" /> 数组中提供的所有行都复制到由 <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> 对象的 <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> 属性指定的目标表中。</span><span class="sxs-lookup"><span data-stu-id="311f5-390">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataRow[])" />, which copies all rows from the supplied <see cref="T:System.Data.DataRow" /> array to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span></span></summary>
        <returns><span data-ttu-id="311f5-391">表示异步操作的任务。</span><span class="sxs-lookup"><span data-stu-id="311f5-391">A task representing the asynchronous operation.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="311f5-392">有关 SQL Server 的 .NET Framework 数据提供程序中的异步编程的详细信息, 请参阅[异步编程](~/docs/framework/data/adonet/asynchronous-programming.md)。</span><span class="sxs-lookup"><span data-stu-id="311f5-392">For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="311f5-393">在任务完成之前为同一个实例多次调用 <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" />。</span><span class="sxs-lookup"><span data-stu-id="311f5-393">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> multiple times for the same instance before task completion.</span></span>  
  
<span data-ttu-id="311f5-394">在任务完成之前为同一个实例调用 <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> 和 <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataRow[])" />。</span><span class="sxs-lookup"><span data-stu-id="311f5-394">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> and <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataRow[])" /> for the same instance before task completion.</span></span>  
  
<span data-ttu-id="311f5-395">在 <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> 执行期间，连接中断或在数据检索期间已关闭。</span><span class="sxs-lookup"><span data-stu-id="311f5-395">The connection drops or is closed during <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> execution.</span></span>  
  
<span data-ttu-id="311f5-396">在任务对象中返回，方法执行期间，<see cref="T:System.Data.SqlClient.SqlBulkCopy" /> 对象处于关闭状态。</span><span class="sxs-lookup"><span data-stu-id="311f5-396">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object was closed during the method execution.</span></span>  
  
<span data-ttu-id="311f5-397">在任务对象中返回，出现连接池超时。</span><span class="sxs-lookup"><span data-stu-id="311f5-397">Returned in the task object, there was a connection pool timeout.</span></span>  
  
<span data-ttu-id="311f5-398">在任务对象中返回，方法执行前，<see cref="T:System.Data.SqlClient.SqlConnection" /> 对象处于关闭状态。</span><span class="sxs-lookup"><span data-stu-id="311f5-398">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlConnection" /> object is closed before method execution.</span></span>  
  
 <span data-ttu-id="311f5-399">在连接字符串中指定 <see langword="Context Connection=true" />。</span><span class="sxs-lookup"><span data-stu-id="311f5-399"><see langword="Context Connection=true" /> is specified in the connection string.</span></span></exception>
        <exception cref="T:System.Data.SqlClient.SqlException"><span data-ttu-id="311f5-400">由 SQL Server 在任务对象中返回的任意错误，这些错误是打开连接时出现的。</span><span class="sxs-lookup"><span data-stu-id="311f5-400">Returned in the task object, any error returned by SQL Server that occurred while opening the connection.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.DataTable table);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.DataTable table) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />
      <MemberSignature Language="VB.NET" Value="Public Function WriteToServerAsync (table As DataTable) As Task" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(System::Data::DataTable ^ table);" />
      <MemberSignature Language="F#" Value="member this.WriteToServerAsync : System.Data.DataTable -&gt; System.Threading.Tasks.Task" Usage="sqlBulkCopy.WriteToServerAsync table" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="table" Type="System.Data.DataTable" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="table"><span data-ttu-id="311f5-401">一个 <see cref="T:System.Data.DataTable" />，它的行将被复制到目标表中。</span><span class="sxs-lookup"><span data-stu-id="311f5-401">A <see cref="T:System.Data.DataTable" /> whose rows will be copied to the destination table.</span></span></param>
        <summary><span data-ttu-id="311f5-402"><see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable)" /> 的异步版本，将 <see cref="T:System.Data.DataTable" /> 中提供的所有行都复制到 <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> 对象的 <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> 属性指定的目标表中。</span><span class="sxs-lookup"><span data-stu-id="311f5-402">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable)" />, which copies all rows in the supplied <see cref="T:System.Data.DataTable" /> to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span></span></summary>
        <returns><span data-ttu-id="311f5-403">表示异步操作的任务。</span><span class="sxs-lookup"><span data-stu-id="311f5-403">A task representing the asynchronous operation.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="311f5-404">有关 SQL Server 的 .NET Framework 数据提供程序中的异步编程的详细信息, 请参阅[异步编程](~/docs/framework/data/adonet/asynchronous-programming.md)。</span><span class="sxs-lookup"><span data-stu-id="311f5-404">For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="311f5-405">在任务完成之前为同一个实例多次调用 <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />。</span><span class="sxs-lookup"><span data-stu-id="311f5-405">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> multiple times for the same instance before task completion.</span></span>  
  
<span data-ttu-id="311f5-406">在任务完成之前为同一个实例调用 <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> 和 <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable)" />。</span><span class="sxs-lookup"><span data-stu-id="311f5-406">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> and <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable)" /> for the same instance before task completion.</span></span>  
  
<span data-ttu-id="311f5-407">在 <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> 执行期间，连接中断或在数据检索期间已关闭。</span><span class="sxs-lookup"><span data-stu-id="311f5-407">The connection drops or is closed during <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> execution.</span></span>  
  
<span data-ttu-id="311f5-408">在任务对象中返回，方法执行期间，<see cref="T:System.Data.SqlClient.SqlBulkCopy" /> 对象处于关闭状态。</span><span class="sxs-lookup"><span data-stu-id="311f5-408">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object was closed during the method execution.</span></span>  
  
<span data-ttu-id="311f5-409">在任务对象中返回，出现连接池超时。</span><span class="sxs-lookup"><span data-stu-id="311f5-409">Returned in the task object, there was a connection pool timeout.</span></span>  
  
<span data-ttu-id="311f5-410">在任务对象中返回，方法执行前，<see cref="T:System.Data.SqlClient.SqlConnection" /> 对象处于关闭状态。</span><span class="sxs-lookup"><span data-stu-id="311f5-410">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlConnection" /> object is closed before method execution.</span></span>  
  
 <span data-ttu-id="311f5-411">在连接字符串中指定 <see langword="Context Connection=true" />。</span><span class="sxs-lookup"><span data-stu-id="311f5-411"><see langword="Context Connection=true" /> is specified in the connection string.</span></span></exception>
        <exception cref="T:System.Data.SqlClient.SqlException"><span data-ttu-id="311f5-412">由 SQL Server 在任务对象中返回的任意错误，这些错误是打开连接时出现的。</span><span class="sxs-lookup"><span data-stu-id="311f5-412">Returned in the task object, any error returned by SQL Server that occurred while opening the connection.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.IDataReader reader);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.IDataReader reader) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" />
      <MemberSignature Language="VB.NET" Value="Public Function WriteToServerAsync (reader As IDataReader) As Task" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(System::Data::IDataReader ^ reader);" />
      <MemberSignature Language="F#" Value="member this.WriteToServerAsync : System.Data.IDataReader -&gt; System.Threading.Tasks.Task" Usage="sqlBulkCopy.WriteToServerAsync reader" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="reader" Type="System.Data.IDataReader" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="reader"><span data-ttu-id="311f5-413">一个 <see cref="T:System.Data.IDataReader" />，它的行将被复制到目标表中。</span><span class="sxs-lookup"><span data-stu-id="311f5-413">A <see cref="T:System.Data.IDataReader" /> whose rows will be copied to the destination table.</span></span></param>
        <summary><span data-ttu-id="311f5-414"><see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.IDataReader)" /> 的异步版本，将 <see cref="T:System.Data.IDataReader" /> 中提供的所有行都复制到 <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> 对象的 <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> 属性指定的目标表中。</span><span class="sxs-lookup"><span data-stu-id="311f5-414">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.IDataReader)" />, which copies all rows in the supplied <see cref="T:System.Data.IDataReader" /> to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span></span></summary>
        <returns><span data-ttu-id="311f5-415">表示异步操作的任务。</span><span class="sxs-lookup"><span data-stu-id="311f5-415">A task representing the asynchronous operation.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="311f5-416">有关 SQL Server 的 .NET Framework 数据提供程序中的异步编程的详细信息, 请参阅[异步编程](~/docs/framework/data/adonet/asynchronous-programming.md)。</span><span class="sxs-lookup"><span data-stu-id="311f5-416">For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="311f5-417">在任务完成之前为同一个实例多次调用 <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" />。</span><span class="sxs-lookup"><span data-stu-id="311f5-417">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> multiple times for the same instance before task completion.</span></span>  
  
<span data-ttu-id="311f5-418">在任务完成之前为同一个实例调用 <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> 和 <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.IDataReader)" />。</span><span class="sxs-lookup"><span data-stu-id="311f5-418">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> and <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.IDataReader)" /> for the same instance before task completion.</span></span>  
  
<span data-ttu-id="311f5-419">在 <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> 执行期间，连接中断或在数据检索期间已关闭。</span><span class="sxs-lookup"><span data-stu-id="311f5-419">The connection drops or is closed during <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> execution.</span></span>  
  
<span data-ttu-id="311f5-420">在任务对象中返回，方法执行期间，<see cref="T:System.Data.SqlClient.SqlBulkCopy" /> 对象处于关闭状态。</span><span class="sxs-lookup"><span data-stu-id="311f5-420">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object was closed during the method execution.</span></span>  
  
<span data-ttu-id="311f5-421">在任务对象中返回，出现连接池超时。</span><span class="sxs-lookup"><span data-stu-id="311f5-421">Returned in the task object, there was a connection pool timeout.</span></span>  
  
<span data-ttu-id="311f5-422">在任务对象中返回，方法执行前，<see cref="T:System.Data.SqlClient.SqlConnection" /> 对象处于关闭状态。</span><span class="sxs-lookup"><span data-stu-id="311f5-422">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlConnection" /> object is closed before method execution.</span></span>  
  
<span data-ttu-id="311f5-423">在 <see cref="T:System.Data.IDataReader" /> 返回之前， <see cref="T:System.Threading.Tasks.Task" /> 已关闭。</span><span class="sxs-lookup"><span data-stu-id="311f5-423">The <see cref="T:System.Data.IDataReader" /> was closed before the completed <see cref="T:System.Threading.Tasks.Task" /> returned.</span></span>  
  
<span data-ttu-id="311f5-424">在 <see cref="T:System.Data.IDataReader" /> 返回之前，与 <see cref="T:System.Threading.Tasks.Task" /> 相关的连接已关闭。</span><span class="sxs-lookup"><span data-stu-id="311f5-424">The <see cref="T:System.Data.IDataReader" />'s associated connection was closed before the completed <see cref="T:System.Threading.Tasks.Task" /> returned.</span></span>  
  
 <span data-ttu-id="311f5-425">在连接字符串中指定 <see langword="Context Connection=true" />。</span><span class="sxs-lookup"><span data-stu-id="311f5-425"><see langword="Context Connection=true" /> is specified in the connection string.</span></span></exception>
        <exception cref="T:System.Data.SqlClient.SqlException"><span data-ttu-id="311f5-426">由 SQL Server 在任务对象中返回的任意错误，这些错误是打开连接时出现的。</span><span class="sxs-lookup"><span data-stu-id="311f5-426">Returned in the task object, any error returned by SQL Server that occurred while opening the connection.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.Common.DbDataReader reader, System.Threading.CancellationToken cancellationToken);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.Common.DbDataReader reader, valuetype System.Threading.CancellationToken cancellationToken) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.Common.DbDataReader,System.Threading.CancellationToken)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(System::Data::Common::DbDataReader ^ reader, System::Threading::CancellationToken cancellationToken);" />
      <MemberSignature Language="F#" Value="member this.WriteToServerAsync : System.Data.Common.DbDataReader * System.Threading.CancellationToken -&gt; System.Threading.Tasks.Task" Usage="sqlBulkCopy.WriteToServerAsync (reader, cancellationToken)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="reader" Type="System.Data.Common.DbDataReader" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-1.0;netcore-1.1;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0" />
        <Parameter Name="cancellationToken" Type="System.Threading.CancellationToken" Index="1" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-1.0;netcore-1.1;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0" />
      </Parameters>
      <Docs>
        <param name="reader"><span data-ttu-id="311f5-427">一个 <see cref="T:System.Data.Common.DbDataReader" />，它的行将被复制到目标表中。</span><span class="sxs-lookup"><span data-stu-id="311f5-427">A <see cref="T:System.Data.Common.DbDataReader" /> whose rows will be copied to the destination table.</span></span></param>
        <param name="cancellationToken"><span data-ttu-id="311f5-428">取消指令。</span><span class="sxs-lookup"><span data-stu-id="311f5-428">The cancellation instruction.</span></span> <span data-ttu-id="311f5-429">此参数中的 <see cref="P:System.Threading.CancellationToken.None" /> 值让方法等效于 <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.Common.DbDataReader)" />。</span><span class="sxs-lookup"><span data-stu-id="311f5-429">A <see cref="P:System.Threading.CancellationToken.None" /> value in this parameter makes this method equivalent to <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.Common.DbDataReader)" />.</span></span></param>
        <summary><span data-ttu-id="311f5-430"><see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.Common.DbDataReader)" /> 的异步版本，将 <see cref="T:System.Data.Common.DbDataReader" /> 数组中提供的所有行都复制到由 <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> 对象的 <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> 属性指定的目标表中。</span><span class="sxs-lookup"><span data-stu-id="311f5-430">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.Common.DbDataReader)" />, which copies all rows from the supplied <see cref="T:System.Data.Common.DbDataReader" /> array to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span></span></summary>
        <returns><span data-ttu-id="311f5-431">返回 <see cref="T:System.Threading.Tasks.Task" />。</span><span class="sxs-lookup"><span data-stu-id="311f5-431">Returns <see cref="T:System.Threading.Tasks.Task" />.</span></span></returns>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.DataRow[] rows, System.Threading.CancellationToken cancellationToken);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.DataRow[] rows, valuetype System.Threading.CancellationToken cancellationToken) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[],System.Threading.CancellationToken)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(cli::array &lt;System::Data::DataRow ^&gt; ^ rows, System::Threading::CancellationToken cancellationToken);" />
      <MemberSignature Language="F#" Value="member this.WriteToServerAsync : System.Data.DataRow[] * System.Threading.CancellationToken -&gt; System.Threading.Tasks.Task" Usage="sqlBulkCopy.WriteToServerAsync (rows, cancellationToken)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="rows" Type="System.Data.DataRow[]" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="cancellationToken" Type="System.Threading.CancellationToken" Index="1" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="rows"><span data-ttu-id="311f5-432">将复制到目标表的 <see cref="T:System.Data.DataRow" /> 对象的数组。</span><span class="sxs-lookup"><span data-stu-id="311f5-432">An array of <see cref="T:System.Data.DataRow" /> objects that will be copied to the destination table.</span></span></param>
        <param name="cancellationToken"><span data-ttu-id="311f5-433">取消指令。</span><span class="sxs-lookup"><span data-stu-id="311f5-433">The cancellation instruction.</span></span> <span data-ttu-id="311f5-434">此参数中的 <see cref="P:System.Threading.CancellationToken.None" /> 值让方法等效于 <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />。</span><span class="sxs-lookup"><span data-stu-id="311f5-434">A <see cref="P:System.Threading.CancellationToken.None" /> value in this parameter makes this method equivalent to <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />.</span></span></param>
        <summary><span data-ttu-id="311f5-435"><see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataRow[])" /> 的异步版本，将 <see cref="T:System.Data.DataRow" /> 数组中提供的所有行都复制到由 <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> 对象的 <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> 属性指定的目标表中。</span><span class="sxs-lookup"><span data-stu-id="311f5-435">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataRow[])" />, which copies all rows from the supplied <see cref="T:System.Data.DataRow" /> array to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span></span>  
  
<span data-ttu-id="311f5-436">取消标记可用于请求在命令超时超过前放弃操作。</span><span class="sxs-lookup"><span data-stu-id="311f5-436">The cancellation token can be used to request that the operation be abandoned before the command timeout elapses.</span></span>  <span data-ttu-id="311f5-437">将通过返回的任务对象报告异常。</span><span class="sxs-lookup"><span data-stu-id="311f5-437">Exceptions will be reported via the returned Task object.</span></span></summary>
        <returns><span data-ttu-id="311f5-438">表示异步操作的任务。</span><span class="sxs-lookup"><span data-stu-id="311f5-438">A task representing the asynchronous operation.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="311f5-439">有关 SQL Server 的 .NET Framework 数据提供程序中的异步编程的详细信息, 请参阅[异步编程](~/docs/framework/data/adonet/asynchronous-programming.md)。</span><span class="sxs-lookup"><span data-stu-id="311f5-439">For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="311f5-440">在任务完成之前为同一个实例多次调用 <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" />。</span><span class="sxs-lookup"><span data-stu-id="311f5-440">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> multiple times for the same instance before task completion.</span></span>  
  
<span data-ttu-id="311f5-441">在任务完成之前为同一个实例调用 <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> 和 <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataRow[])" />。</span><span class="sxs-lookup"><span data-stu-id="311f5-441">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> and <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataRow[])" /> for the same instance before task completion.</span></span>  
  
<span data-ttu-id="311f5-442">在 <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> 执行期间，连接中断或在数据检索期间已关闭。</span><span class="sxs-lookup"><span data-stu-id="311f5-442">The connection drops or is closed during <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> execution.</span></span>  
  
<span data-ttu-id="311f5-443">在任务对象中返回，方法执行期间，<see cref="T:System.Data.SqlClient.SqlBulkCopy" /> 对象处于关闭状态。</span><span class="sxs-lookup"><span data-stu-id="311f5-443">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object was closed during the method execution.</span></span>  
  
<span data-ttu-id="311f5-444">在任务对象中返回，出现连接池超时。</span><span class="sxs-lookup"><span data-stu-id="311f5-444">Returned in the task object, there was a connection pool timeout.</span></span>  
  
<span data-ttu-id="311f5-445">在任务对象中返回，方法执行前，<see cref="T:System.Data.SqlClient.SqlConnection" /> 对象处于关闭状态。</span><span class="sxs-lookup"><span data-stu-id="311f5-445">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlConnection" /> object is closed before method execution.</span></span>  
  
 <span data-ttu-id="311f5-446">在连接字符串中指定 <see langword="Context Connection=true" />。</span><span class="sxs-lookup"><span data-stu-id="311f5-446"><see langword="Context Connection=true" /> is specified in the connection string.</span></span></exception>
        <exception cref="T:System.Data.SqlClient.SqlException"><span data-ttu-id="311f5-447">由 SQL Server 在任务对象中返回的任意错误，这些错误是打开连接时出现的。</span><span class="sxs-lookup"><span data-stu-id="311f5-447">Returned in the task object, any error returned by SQL Server that occurred while opening the connection.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.DataTable table, System.Data.DataRowState rowState);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.DataTable table, valuetype System.Data.DataRowState rowState) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" />
      <MemberSignature Language="VB.NET" Value="Public Function WriteToServerAsync (table As DataTable, rowState As DataRowState) As Task" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(System::Data::DataTable ^ table, System::Data::DataRowState rowState);" />
      <MemberSignature Language="F#" Value="member this.WriteToServerAsync : System.Data.DataTable * System.Data.DataRowState -&gt; System.Threading.Tasks.Task" Usage="sqlBulkCopy.WriteToServerAsync (table, rowState)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="table" Type="System.Data.DataTable" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="rowState" Type="System.Data.DataRowState" Index="1" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="table"><span data-ttu-id="311f5-448">一个 <see cref="T:System.Data.DataTable" />，它的行将被复制到目标表中。</span><span class="sxs-lookup"><span data-stu-id="311f5-448">A <see cref="T:System.Data.DataTable" /> whose rows will be copied to the destination table.</span></span></param>
        <param name="rowState"><span data-ttu-id="311f5-449"><see cref="T:System.Data.DataRowState" /> 枚举中的一个值。</span><span class="sxs-lookup"><span data-stu-id="311f5-449">A value from the <see cref="T:System.Data.DataRowState" /> enumeration.</span></span> <span data-ttu-id="311f5-450">只有与行状态匹配的行才会被复制到目标表中。</span><span class="sxs-lookup"><span data-stu-id="311f5-450">Only rows matching the row state are copied to the destination.</span></span></param>
        <summary><span data-ttu-id="311f5-451"><see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable,System.Data.DataRowState)" /> 的异步版本，之间与 <see cref="T:System.Data.DataTable" /> 中所提供行状态匹配的行复制到 <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> 对象的 <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> 属性中指定的目标表中。</span><span class="sxs-lookup"><span data-stu-id="311f5-451">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable,System.Data.DataRowState)" />, which copies only rows that match the supplied row state in the supplied <see cref="T:System.Data.DataTable" /> to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span></span></summary>
        <returns><span data-ttu-id="311f5-452">表示异步操作的任务。</span><span class="sxs-lookup"><span data-stu-id="311f5-452">A task representing the asynchronous operation.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="311f5-453">有关 SQL Server 的 .NET Framework 数据提供程序中的异步编程的详细信息, 请参阅[异步编程](~/docs/framework/data/adonet/asynchronous-programming.md)。</span><span class="sxs-lookup"><span data-stu-id="311f5-453">For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="311f5-454">在任务完成之前为同一个实例多次调用 <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" />。</span><span class="sxs-lookup"><span data-stu-id="311f5-454">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> multiple times for the same instance before task completion.</span></span>  
  
<span data-ttu-id="311f5-455">在任务完成之前为同一个实例调用 <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> 和 <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable,System.Data.DataRowState)" />。</span><span class="sxs-lookup"><span data-stu-id="311f5-455">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> and <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable,System.Data.DataRowState)" /> for the same instance before task completion.</span></span>  
  
<span data-ttu-id="311f5-456">在 <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> 执行期间，连接中断或在数据检索期间已关闭。</span><span class="sxs-lookup"><span data-stu-id="311f5-456">The connection drops or is closed during <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> execution.</span></span>  
  
<span data-ttu-id="311f5-457">在任务对象中返回，方法执行期间，<see cref="T:System.Data.SqlClient.SqlBulkCopy" /> 对象处于关闭状态。</span><span class="sxs-lookup"><span data-stu-id="311f5-457">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object was closed during the method execution.</span></span>  
  
<span data-ttu-id="311f5-458">在任务对象中返回，出现连接池超时。</span><span class="sxs-lookup"><span data-stu-id="311f5-458">Returned in the task object, there was a connection pool timeout.</span></span>  
  
<span data-ttu-id="311f5-459">在任务对象中返回，方法执行前，<see cref="T:System.Data.SqlClient.SqlConnection" /> 对象处于关闭状态。</span><span class="sxs-lookup"><span data-stu-id="311f5-459">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlConnection" /> object is closed before method execution.</span></span>  
  
 <span data-ttu-id="311f5-460">在连接字符串中指定 <see langword="Context Connection=true" />。</span><span class="sxs-lookup"><span data-stu-id="311f5-460"><see langword="Context Connection=true" /> is specified in the connection string.</span></span></exception>
        <exception cref="T:System.Data.SqlClient.SqlException"><span data-ttu-id="311f5-461">由 SQL Server 在任务对象中返回的任意错误，这些错误是打开连接时出现的。</span><span class="sxs-lookup"><span data-stu-id="311f5-461">Returned in the task object, any error returned by SQL Server that occurred while opening the connection.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.DataTable table, System.Threading.CancellationToken cancellationToken);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.DataTable table, valuetype System.Threading.CancellationToken cancellationToken) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Threading.CancellationToken)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(System::Data::DataTable ^ table, System::Threading::CancellationToken cancellationToken);" />
      <MemberSignature Language="F#" Value="member this.WriteToServerAsync : System.Data.DataTable * System.Threading.CancellationToken -&gt; System.Threading.Tasks.Task" Usage="sqlBulkCopy.WriteToServerAsync (table, cancellationToken)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="table" Type="System.Data.DataTable" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="cancellationToken" Type="System.Threading.CancellationToken" Index="1" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="table"><span data-ttu-id="311f5-462">一个 <see cref="T:System.Data.DataTable" />，它的行将被复制到目标表中。</span><span class="sxs-lookup"><span data-stu-id="311f5-462">A <see cref="T:System.Data.DataTable" /> whose rows will be copied to the destination table.</span></span></param>
        <param name="cancellationToken"><span data-ttu-id="311f5-463">取消指令。</span><span class="sxs-lookup"><span data-stu-id="311f5-463">The cancellation instruction.</span></span> <span data-ttu-id="311f5-464">此参数中的 <see cref="P:System.Threading.CancellationToken.None" /> 值让方法等效于 <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />。</span><span class="sxs-lookup"><span data-stu-id="311f5-464">A <see cref="P:System.Threading.CancellationToken.None" /> value in this parameter makes this method equivalent to <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />.</span></span></param>
        <summary><span data-ttu-id="311f5-465"><see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable)" /> 的异步版本，将 <see cref="T:System.Data.DataTable" /> 中提供的所有行都复制到 <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> 对象的 <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> 属性指定的目标表中。</span><span class="sxs-lookup"><span data-stu-id="311f5-465">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable)" />, which copies all rows in the supplied <see cref="T:System.Data.DataTable" /> to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span></span>  
  
<span data-ttu-id="311f5-466">取消标记可用于在命令超时超过前请求放弃操作。</span><span class="sxs-lookup"><span data-stu-id="311f5-466">The cancellation token can be used to request that the operation be abandoned before the command timeout elapses.</span></span>  <span data-ttu-id="311f5-467">将通过返回的任务对象报告异常。</span><span class="sxs-lookup"><span data-stu-id="311f5-467">Exceptions will be reported via the returned Task object.</span></span></summary>
        <returns><span data-ttu-id="311f5-468">表示异步操作的任务。</span><span class="sxs-lookup"><span data-stu-id="311f5-468">A task representing the asynchronous operation.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="311f5-469">有关 SQL Server 的 .NET Framework 数据提供程序中的异步编程的详细信息, 请参阅[异步编程](~/docs/framework/data/adonet/asynchronous-programming.md)。</span><span class="sxs-lookup"><span data-stu-id="311f5-469">For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="311f5-470">在任务完成之前为同一个实例多次调用 <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />。</span><span class="sxs-lookup"><span data-stu-id="311f5-470">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> multiple times for the same instance before task completion.</span></span>  
  
<span data-ttu-id="311f5-471">在任务完成之前为同一个实例调用 <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> 和 <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable)" />。</span><span class="sxs-lookup"><span data-stu-id="311f5-471">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> and <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable)" /> for the same instance before task completion.</span></span>  
  
<span data-ttu-id="311f5-472">在 <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> 执行期间，连接中断或在数据检索期间已关闭。</span><span class="sxs-lookup"><span data-stu-id="311f5-472">The connection drops or is closed during <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> execution.</span></span>  
  
<span data-ttu-id="311f5-473">在任务对象中返回，方法执行期间，<see cref="T:System.Data.SqlClient.SqlBulkCopy" /> 对象处于关闭状态。</span><span class="sxs-lookup"><span data-stu-id="311f5-473">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object was closed during the method execution.</span></span>  
  
<span data-ttu-id="311f5-474">在任务对象中返回，出现连接池超时。</span><span class="sxs-lookup"><span data-stu-id="311f5-474">Returned in the task object, there was a connection pool timeout.</span></span>  
  
<span data-ttu-id="311f5-475">在任务对象中返回，方法执行前，<see cref="T:System.Data.SqlClient.SqlConnection" /> 对象处于关闭状态。</span><span class="sxs-lookup"><span data-stu-id="311f5-475">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlConnection" /> object is closed before method execution.</span></span>  
  
 <span data-ttu-id="311f5-476">在连接字符串中指定 <see langword="Context Connection=true" />。</span><span class="sxs-lookup"><span data-stu-id="311f5-476"><see langword="Context Connection=true" /> is specified in the connection string.</span></span></exception>
        <exception cref="T:System.Data.SqlClient.SqlException"><span data-ttu-id="311f5-477">由 SQL Server 在任务对象中返回的任意错误，这些错误是打开连接时出现的。</span><span class="sxs-lookup"><span data-stu-id="311f5-477">Returned in the task object, any error returned by SQL Server that occurred while opening the connection.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.IDataReader reader, System.Threading.CancellationToken cancellationToken);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.IDataReader reader, valuetype System.Threading.CancellationToken cancellationToken) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader,System.Threading.CancellationToken)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(System::Data::IDataReader ^ reader, System::Threading::CancellationToken cancellationToken);" />
      <MemberSignature Language="F#" Value="member this.WriteToServerAsync : System.Data.IDataReader * System.Threading.CancellationToken -&gt; System.Threading.Tasks.Task" Usage="sqlBulkCopy.WriteToServerAsync (reader, cancellationToken)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="reader" Type="System.Data.IDataReader" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="cancellationToken" Type="System.Threading.CancellationToken" Index="1" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="reader"><span data-ttu-id="311f5-478">一个 <see cref="T:System.Data.IDataReader" />，它的行将被复制到目标表中。</span><span class="sxs-lookup"><span data-stu-id="311f5-478">A <see cref="T:System.Data.IDataReader" /> whose rows will be copied to the destination table.</span></span></param>
        <param name="cancellationToken"><span data-ttu-id="311f5-479">取消指令。</span><span class="sxs-lookup"><span data-stu-id="311f5-479">The cancellation instruction.</span></span> <span data-ttu-id="311f5-480">此参数中的 <see cref="P:System.Threading.CancellationToken.None" /> 值让方法等效于 <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />。</span><span class="sxs-lookup"><span data-stu-id="311f5-480">A <see cref="P:System.Threading.CancellationToken.None" /> value in this parameter makes this method equivalent to <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />.</span></span></param>
        <summary><span data-ttu-id="311f5-481"><see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.IDataReader)" /> 的异步版本，将 <see cref="T:System.Data.IDataReader" /> 中提供的所有行都复制到 <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> 对象的 <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> 属性指定的目标表中。</span><span class="sxs-lookup"><span data-stu-id="311f5-481">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.IDataReader)" />, which copies all rows in the supplied <see cref="T:System.Data.IDataReader" /> to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span></span>  
  
<span data-ttu-id="311f5-482">取消标记可用于在命令超时超过前请求放弃操作。</span><span class="sxs-lookup"><span data-stu-id="311f5-482">The cancellation token can be used to request that the operation be abandoned before the command timeout elapses.</span></span>  <span data-ttu-id="311f5-483">将通过返回的任务对象报告异常。</span><span class="sxs-lookup"><span data-stu-id="311f5-483">Exceptions will be reported via the returned Task object.</span></span></summary>
        <returns><span data-ttu-id="311f5-484">表示异步操作的任务。</span><span class="sxs-lookup"><span data-stu-id="311f5-484">A task representing the asynchronous operation.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="311f5-485">有关 SQL Server 的 .NET Framework 数据提供程序中的异步编程的详细信息, 请参阅[异步编程](~/docs/framework/data/adonet/asynchronous-programming.md)。</span><span class="sxs-lookup"><span data-stu-id="311f5-485">For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="311f5-486">在任务完成之前为同一个实例多次调用 <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" />。</span><span class="sxs-lookup"><span data-stu-id="311f5-486">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> multiple times for the same instance before task completion.</span></span>  
  
<span data-ttu-id="311f5-487">在任务完成之前为同一个实例调用 <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> 和 <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.IDataReader)" />。</span><span class="sxs-lookup"><span data-stu-id="311f5-487">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> and <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.IDataReader)" /> for the same instance before task completion.</span></span>  
  
<span data-ttu-id="311f5-488">在 <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> 执行期间，连接中断或在数据检索期间已关闭。</span><span class="sxs-lookup"><span data-stu-id="311f5-488">The connection drops or is closed during <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> execution.</span></span>  
  
<span data-ttu-id="311f5-489">在任务对象中返回，方法执行期间，<see cref="T:System.Data.SqlClient.SqlBulkCopy" /> 对象处于关闭状态。</span><span class="sxs-lookup"><span data-stu-id="311f5-489">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object was closed during the method execution.</span></span>  
  
<span data-ttu-id="311f5-490">在任务对象中返回，出现连接池超时。</span><span class="sxs-lookup"><span data-stu-id="311f5-490">Returned in the task object, there was a connection pool timeout.</span></span>  
  
<span data-ttu-id="311f5-491">在任务对象中返回，方法执行前，<see cref="T:System.Data.SqlClient.SqlConnection" /> 对象处于关闭状态。</span><span class="sxs-lookup"><span data-stu-id="311f5-491">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlConnection" /> object is closed before method execution.</span></span>  
  
<span data-ttu-id="311f5-492">在 <see cref="T:System.Data.IDataReader" /> 返回之前， <see cref="T:System.Threading.Tasks.Task" /> 已关闭。</span><span class="sxs-lookup"><span data-stu-id="311f5-492">The <see cref="T:System.Data.IDataReader" /> was closed before the completed <see cref="T:System.Threading.Tasks.Task" /> returned.</span></span>  
  
<span data-ttu-id="311f5-493">在 <see cref="T:System.Data.IDataReader" /> 返回之前，与 <see cref="T:System.Threading.Tasks.Task" /> 相关的连接已关闭。</span><span class="sxs-lookup"><span data-stu-id="311f5-493">The <see cref="T:System.Data.IDataReader" />'s associated connection was closed before the completed <see cref="T:System.Threading.Tasks.Task" /> returned.</span></span>  
  
 <span data-ttu-id="311f5-494">在连接字符串中指定 <see langword="Context Connection=true" />。</span><span class="sxs-lookup"><span data-stu-id="311f5-494"><see langword="Context Connection=true" /> is specified in the connection string.</span></span></exception>
        <exception cref="T:System.Data.SqlClient.SqlException"><span data-ttu-id="311f5-495">由 SQL Server 在任务对象中返回的任意错误，这些错误是打开连接时出现的。</span><span class="sxs-lookup"><span data-stu-id="311f5-495">Returned in the task object, any error returned by SQL Server that occurred while opening the connection.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.DataTable table, System.Data.DataRowState rowState, System.Threading.CancellationToken cancellationToken);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.DataTable table, valuetype System.Data.DataRowState rowState, valuetype System.Threading.CancellationToken cancellationToken) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState,System.Threading.CancellationToken)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(System::Data::DataTable ^ table, System::Data::DataRowState rowState, System::Threading::CancellationToken cancellationToken);" />
      <MemberSignature Language="F#" Value="member this.WriteToServerAsync : System.Data.DataTable * System.Data.DataRowState * System.Threading.CancellationToken -&gt; System.Threading.Tasks.Task" Usage="sqlBulkCopy.WriteToServerAsync (table, rowState, cancellationToken)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.4.0.0</AssemblyVersion>
        <AssemblyVersion>4.5.0.0</AssemblyVersion>
        <AssemblyVersion>4.6.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="table" Type="System.Data.DataTable" Index="0" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="rowState" Type="System.Data.DataRowState" Index="1" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="cancellationToken" Type="System.Threading.CancellationToken" Index="2" FrameworkAlternate="dotnet-plat-ext-2.1;dotnet-plat-ext-2.2;dotnet-plat-ext-3.0;netcore-2.0;netcore-2.1;netcore-2.2;netcore-3.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="table"><span data-ttu-id="311f5-496">一个 <see cref="T:System.Data.DataTable" />，它的行将被复制到目标表中。</span><span class="sxs-lookup"><span data-stu-id="311f5-496">A <see cref="T:System.Data.DataTable" /> whose rows will be copied to the destination table.</span></span></param>
        <param name="rowState"><span data-ttu-id="311f5-497"><see cref="T:System.Data.DataRowState" /> 枚举中的一个值。</span><span class="sxs-lookup"><span data-stu-id="311f5-497">A value from the <see cref="T:System.Data.DataRowState" /> enumeration.</span></span> <span data-ttu-id="311f5-498">只有与行状态匹配的行才会被复制到目标表中。</span><span class="sxs-lookup"><span data-stu-id="311f5-498">Only rows matching the row state are copied to the destination.</span></span></param>
        <param name="cancellationToken"><span data-ttu-id="311f5-499">取消指示。</span><span class="sxs-lookup"><span data-stu-id="311f5-499">The cancellation instruction.</span></span> <span data-ttu-id="311f5-500">此参数中的 <see cref="P:System.Threading.CancellationToken.None" /> 值让方法等效于 <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />。</span><span class="sxs-lookup"><span data-stu-id="311f5-500">A <see cref="P:System.Threading.CancellationToken.None" /> value in this parameter makes this method equivalent to <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />.</span></span></param>
        <summary><span data-ttu-id="311f5-501"><see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable,System.Data.DataRowState)" /> 的异步版本，之间与 <see cref="T:System.Data.DataTable" /> 中所提供行状态匹配的行复制到 <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> 对象的 <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> 属性中指定的目标表中。</span><span class="sxs-lookup"><span data-stu-id="311f5-501">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable,System.Data.DataRowState)" />, which copies only rows that match the supplied row state in the supplied <see cref="T:System.Data.DataTable" /> to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span></span>  
  
<span data-ttu-id="311f5-502">取消标记可用于请求在命令超时超过前放弃操作。</span><span class="sxs-lookup"><span data-stu-id="311f5-502">The cancellation token can be used to request that the operation be abandoned before the command timeout elapses.</span></span>  <span data-ttu-id="311f5-503">将通过返回的任务对象报告异常。</span><span class="sxs-lookup"><span data-stu-id="311f5-503">Exceptions will be reported via the returned Task object.</span></span></summary>
        <returns><span data-ttu-id="311f5-504">表示异步操作的任务。</span><span class="sxs-lookup"><span data-stu-id="311f5-504">A task representing the asynchronous operation.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="311f5-505">有关 SQL Server 的 .NET Framework 数据提供程序中的异步编程的详细信息, 请参阅[异步编程](~/docs/framework/data/adonet/asynchronous-programming.md)。</span><span class="sxs-lookup"><span data-stu-id="311f5-505">For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="311f5-506">在任务完成之前为同一个实例多次调用 <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" />。</span><span class="sxs-lookup"><span data-stu-id="311f5-506">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> multiple times for the same instance before task completion.</span></span>  
  
<span data-ttu-id="311f5-507">在任务完成之前为同一个实例调用 <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> 和 <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable,System.Data.DataRowState)" />。</span><span class="sxs-lookup"><span data-stu-id="311f5-507">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> and <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable,System.Data.DataRowState)" /> for the same instance before task completion.</span></span>  
  
<span data-ttu-id="311f5-508">在 <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> 执行期间，连接中断或在数据检索期间已关闭。</span><span class="sxs-lookup"><span data-stu-id="311f5-508">The connection drops or is closed during <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> execution.</span></span>  
  
<span data-ttu-id="311f5-509">在任务对象中返回，方法执行期间，<see cref="T:System.Data.SqlClient.SqlBulkCopy" /> 对象处于关闭状态。</span><span class="sxs-lookup"><span data-stu-id="311f5-509">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object was closed during the method execution.</span></span>  
  
<span data-ttu-id="311f5-510">在任务对象中返回，出现连接池超时。</span><span class="sxs-lookup"><span data-stu-id="311f5-510">Returned in the task object, there was a connection pool timeout.</span></span>  
  
<span data-ttu-id="311f5-511">在任务对象中返回，方法执行前，<see cref="T:System.Data.SqlClient.SqlConnection" /> 对象处于关闭状态。</span><span class="sxs-lookup"><span data-stu-id="311f5-511">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlConnection" /> object is closed before method execution.</span></span>  
  
 <span data-ttu-id="311f5-512">在连接字符串中指定 <see langword="Context Connection=true" />。</span><span class="sxs-lookup"><span data-stu-id="311f5-512"><see langword="Context Connection=true" /> is specified in the connection string.</span></span></exception>
        <exception cref="T:System.Data.SqlClient.SqlException"><span data-ttu-id="311f5-513">由 SQL Server 在任务对象中返回的任意错误，这些错误是打开连接时出现的。</span><span class="sxs-lookup"><span data-stu-id="311f5-513">Returned in the task object, any error returned by SQL Server that occurred while opening the connection.</span></span></exception>
      </Docs>
    </Member>
  </Members>
</Type>
